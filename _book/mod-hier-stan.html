<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 8 Modello gerarchico | Data Science per psicologi</title>
  <meta name="description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="generator" content="bookdown 0.26.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 8 Modello gerarchico | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 8 Modello gerarchico | Data Science per psicologi" />
  
  <meta name="twitter:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2022-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-anova.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefazione</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#la-psicologia-e-la-data-science"><i class="fa fa-check"></i>La psicologia e la Data science</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#come-studiare"><i class="fa fa-check"></i>Come studiare</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sviluppare-un-metodo-di-studio-efficace"><i class="fa fa-check"></i>Sviluppare un metodo di studio efficace</a></li>
</ul></li>
<li class="part"><span><b>I Il modello lineare</b></span></li>
<li class="chapter" data-level="1" data-path="regr-models-intro.html"><a href="regr-models-intro.html"><i class="fa fa-check"></i><b>1</b> Introduzione</a>
<ul>
<li class="chapter" data-level="1.1" data-path="regr-models-intro.html"><a href="regr-models-intro.html#la-funzione-lineare"><i class="fa fa-check"></i><b>1.1</b> La funzione lineare</a></li>
<li class="chapter" data-level="1.2" data-path="regr-models-intro.html"><a href="regr-models-intro.html#una-media-per-ciascuna-osservazione"><i class="fa fa-check"></i><b>1.2</b> Una media per ciascuna osservazione</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="regr-models-intro.html"><a href="regr-models-intro.html#relazione-lineare-tra-la-media-y-mid-x-e-il-predittore"><i class="fa fa-check"></i><b>1.2.1</b> Relazione lineare tra la media <span class="math inline">\(y \mid x\)</span> e il predittore</a></li>
<li class="chapter" data-level="1.2.2" data-path="regr-models-intro.html"><a href="regr-models-intro.html#il-modello-lineare"><i class="fa fa-check"></i><b>1.2.2</b> Il modello lineare</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regr-models-intro.html"><a href="regr-models-intro.html#commenti-e-considerazioni-finali"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regr-model-lm.html"><a href="regr-model-lm.html"><i class="fa fa-check"></i><b>2</b> Il modello lineare visto da vicino</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regr-model-lm.html"><a href="regr-model-lm.html#stima-dei-coefficienti-di-regressione"><i class="fa fa-check"></i><b>2.1</b> Stima dei coefficienti di regressione</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="regr-model-lm.html"><a href="regr-model-lm.html#trasformazione-dei-dati"><i class="fa fa-check"></i><b>2.1.1</b> Trasformazione dei dati</a></li>
<li class="chapter" data-level="2.1.2" data-path="regr-model-lm.html"><a href="regr-model-lm.html#il-metodo-dei-minimi-quadrati"><i class="fa fa-check"></i><b>2.1.2</b> Il metodo dei minimi quadrati</a></li>
<li class="chapter" data-level="2.1.3" data-path="regr-model-lm.html"><a href="regr-model-lm.html#il-coefficiente-di-determinazione"><i class="fa fa-check"></i><b>2.1.3</b> Il coefficiente di determinazione</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="regr-model-lm.html"><a href="regr-model-lm.html#indice-di-determinazione"><i class="fa fa-check"></i><b>2.2</b> Indice di determinazione</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="regr-model-lm.html"><a href="regr-model-lm.html#inferenza-sul-modello-di-regressione"><i class="fa fa-check"></i><b>2.2.1</b> Inferenza sul modello di regressione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regr-model-lm.html"><a href="regr-model-lm.html#commenti-e-considerazioni-finali-1"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html"><i class="fa fa-check"></i><b>3</b> Modello lineare in Stan</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html#una-distribuzione-a-priori-debolmente-informativa"><i class="fa fa-check"></i><b>3.1</b> Una distribuzione a priori debolmente informativa</a></li>
<li class="chapter" data-level="3.2" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html#linguaggio-stan"><i class="fa fa-check"></i><b>3.2</b> Linguaggio Stan</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html#standardizzare-i-dati"><i class="fa fa-check"></i><b>3.2.1</b> Standardizzare i dati</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html#interpretazione-dei-parametri"><i class="fa fa-check"></i><b>3.3</b> Interpretazione dei parametri</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html#centrare-i-predittori"><i class="fa fa-check"></i><b>3.3.1</b> Centrare i predittori</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reg-lin-stan.html"><a href="reg-lin-stan.html#commenti-e-considerazioni-finali-2"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html"><i class="fa fa-check"></i><b>4</b> Inferenza sul modello lineare</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html#rappresentazione-grafica-dellincertezza-della-stima"><i class="fa fa-check"></i><b>4.1</b> Rappresentazione grafica dell’incertezza della stima</a></li>
<li class="chapter" data-level="4.2" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html#intervalli-di-credibilità"><i class="fa fa-check"></i><b>4.2</b> Intervalli di credibilità</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html#quale-soglia-usare"><i class="fa fa-check"></i><b>4.2.1</b> Quale soglia usare?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html#test-di-ipotesi"><i class="fa fa-check"></i><b>4.3</b> Test di ipotesi</a></li>
<li class="chapter" data-level="4.4" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html#modello-lineare-robusto"><i class="fa fa-check"></i><b>4.4</b> Modello lineare robusto</a></li>
<li class="chapter" data-level="" data-path="inference-reg-lin-stan.html"><a href="inference-reg-lin-stan.html#commenti-e-considerazioni-finali-3"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comp-two-means-stan.html"><a href="comp-two-means-stan.html"><i class="fa fa-check"></i><b>5</b> Confronto tra due gruppi indipendenti</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comp-two-means-stan.html"><a href="comp-two-means-stan.html#modello-lineare-con-una-variabile-dicotomica"><i class="fa fa-check"></i><b>5.1</b> Modello lineare con una variabile dicotomica</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="comp-two-means-stan.html"><a href="comp-two-means-stan.html#confronti-non-effetti"><i class="fa fa-check"></i><b>5.1.1</b> Confronti, non effetti</a></li>
<li class="chapter" data-level="5.1.2" data-path="comp-two-means-stan.html"><a href="comp-two-means-stan.html#un-esempio-concreto"><i class="fa fa-check"></i><b>5.1.2</b> Un esempio concreto</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="comp-two-means-stan.html"><a href="comp-two-means-stan.html#la-dimensione-delleffetto"><i class="fa fa-check"></i><b>5.2</b> La dimensione dell’effetto</a></li>
<li class="chapter" data-level="" data-path="comp-two-means-stan.html"><a href="comp-two-means-stan.html#commenti-e-considerazioni-finali-4"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html"><i class="fa fa-check"></i><b>6</b> Predictive checks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#campionamento-dalla-distribuzione-predittiva-a-posteriori"><i class="fa fa-check"></i><b>6.1</b> Campionamento dalla distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="6.2" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#campionamento-dalla-distribuzione-predittiva-a-priori"><i class="fa fa-check"></i><b>6.2</b> Campionamento dalla distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#commenti-e-considerazioni-finali-5"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-anova.html"><a href="ch-anova.html"><i class="fa fa-check"></i><b>7</b> Confronto di <span class="math inline">\(k\)</span> gruppi</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-anova.html"><a href="ch-anova.html#le-abilità-sociali-di-un-robot"><i class="fa fa-check"></i><b>7.1</b> Le abilità sociali di un robot</a></li>
<li class="chapter" data-level="7.2" data-path="ch-anova.html"><a href="ch-anova.html#anova-stan"><i class="fa fa-check"></i><b>7.2</b> I test statistici dell’Analisi della Varianza</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch-anova.html"><a href="ch-anova.html#test-sullinterazione"><i class="fa fa-check"></i><b>7.2.1</b> Test sull’interazione</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-anova.html"><a href="ch-anova.html#test-sugli-effetti-principali"><i class="fa fa-check"></i><b>7.2.2</b> Test sugli effetti principali</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-anova.html"><a href="ch-anova.html#codice-stan-versione-2"><i class="fa fa-check"></i><b>7.3</b> Codice Stan (versione 2)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-hier-stan.html"><a href="mod-hier-stan.html"><i class="fa fa-check"></i><b>8</b> Modello gerarchico</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-hier-stan.html"><a href="mod-hier-stan.html#modello-gerarchico"><i class="fa fa-check"></i><b>8.1</b> Modello gerarchico</a></li>
<li class="chapter" data-level="8.2" data-path="mod-hier-stan.html"><a href="mod-hier-stan.html#modello-ad-effetti-fissi"><i class="fa fa-check"></i><b>8.2</b> Modello ad effetti fissi</a></li>
<li class="chapter" data-level="8.3" data-path="mod-hier-stan.html"><a href="mod-hier-stan.html#modello-gerarchico-1"><i class="fa fa-check"></i><b>8.3</b> Modello gerarchico</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-hier-stan" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Capitolo 8</span> Modello gerarchico<a href="mod-hier-stan.html#mod-hier-stan" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="modello-gerarchico" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Modello gerarchico<a href="mod-hier-stan.html#modello-gerarchico" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I modelli lineari misti, o modelli lineari gerarchici/multilivello, sono diventati uno strumento fondamentale della ricerca sperimentale in psicologia, linguistica e scienze cognitive, dove i progetti di ricerca a misure ripetute sono la norma. Il presente Capitolo fornisce un’introduzione a tali modelli considerando soltanto il caso più semplice, conosciuto anche col nome di <em>Random Intercept Model</em>.</p>
<p>Per fare un esempio concreto useremo il set di dati a misure ripetute con due condizioni di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>; si veda <a href="#ref-sorensen2015bayesian" role="doc-biblioref">Sorensen and Vasishth 2015</a>)</span>. La variabile dipendente <code>rt</code> dell’esperimento di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>)</span> è il tempo di lettura in millisecondi del soggetto di una proposizione relativa in un testo. I tempi di reazione sono stati registrati in due condizioni (ovvero, in presenza di un sostantivo riferito al soggetto oppure riferito all’oggetto della proposizione). I dati di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>)</span> provengono da un esperimento con 37 soggetti e 15 item. Gli item erano presentati in un disegno a quadrato latino, il che produce 37 <span class="math inline">\(\times\)</span> 15 = 555 dati. Risultano mancanti otto dati di un soggetto (id 27), il che ci porta ad un totale di 555 − 8 = 547 dati. Le prime righe del data.frame sono mostrate di seguito:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="mod-hier-stan.html#cb129-1" aria-hidden="true" tabindex="-1"></a>rdat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;gibsonwu2012data.txt&quot;</span>))</span>
<span id="cb129-2"><a href="mod-hier-stan.html#cb129-2" aria-hidden="true" tabindex="-1"></a>rdat<span class="sc">$</span>so <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rdat<span class="sc">$</span>type <span class="sc">==</span> <span class="st">&quot;subj-ext&quot;</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb129-3"><a href="mod-hier-stan.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rdat)</span>
<span id="cb129-4"><a href="mod-hier-stan.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    subj item     type pos word correct   rt region            type2   so</span></span>
<span id="cb129-5"><a href="mod-hier-stan.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7     1   13  obj-ext   6 抓住       - 1140    de1  object relative  0.5</span></span>
<span id="cb129-6"><a href="mod-hier-stan.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20    1    6 subj-ext   6 男孩       - 1197    de1 subject relative -0.5</span></span>
<span id="cb129-7"><a href="mod-hier-stan.html#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32    1    5  obj-ext   6   撞       -  756    de1  object relative  0.5</span></span>
<span id="cb129-8"><a href="mod-hier-stan.html#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44    1    9  obj-ext   6 監視       -  643    de1  object relative  0.5</span></span>
<span id="cb129-9"><a href="mod-hier-stan.html#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 60    1   14 subj-ext   6 機師       -  860    de1 subject relative -0.5</span></span>
<span id="cb129-10"><a href="mod-hier-stan.html#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 73    1    4 subj-ext   6 男孩       -  868    de1 subject relative -0.5</span></span></code></pre></div>
<p>La variabile di interesse che corrisponde alla manipolazione sperimentale è chiamata <code>so</code> ed è stata codificata con -0.5 se il sostantivo era riferito al soggetto e con +0.5 se il sostantivo era riferito all’oggetto della frase.</p>
<p>Calcoliamo la media dei tempi di reazione su scala logaritmica e per poi ritrasformare il risultato sulla scala originale:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="mod-hier-stan.html#cb130-1" aria-hidden="true" tabindex="-1"></a>rdat <span class="sc">%&gt;%</span> </span>
<span id="cb130-2"><a href="mod-hier-stan.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type2) <span class="sc">%&gt;%</span> </span>
<span id="cb130-3"><a href="mod-hier-stan.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb130-4"><a href="mod-hier-stan.html#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(rt), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb130-5"><a href="mod-hier-stan.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-6"><a href="mod-hier-stan.html#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb130-7"><a href="mod-hier-stan.html#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   type2              avg</span></span>
<span id="cb130-8"><a href="mod-hier-stan.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;</span></span>
<span id="cb130-9"><a href="mod-hier-stan.html#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 object relative   551.</span></span>
<span id="cb130-10"><a href="mod-hier-stan.html#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 subject relative  589.</span></span></code></pre></div>
<p>Quando il sostantivo si riferisce al soggetto, i tempi di reazione sono più lenti di circa 30 ms. Questa descrizione dei dati, però non tiene conto né delle differenze tra i soggetti né delle differenze tra gli item. Per tenere in considerazioni queste diverse fonti della variabilità dei dati è necessario utilizzare un modello detto gerarchico.</p>
</div>
<div id="modello-ad-effetti-fissi" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Modello ad effetti fissi<a href="mod-hier-stan.html#modello-ad-effetti-fissi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Iniziamo con il modello “ad effetti fissi” che non tiene conto della struttura gerarchica dei dati, ovvero del fatto che c’è una covariazione all’interno dei cluster di dati definiti dalle variabili “soggetto” e “item”.</p>
<p>Assumiamo che la variabile dipendente <code>rt</code> (del tempo di lettura) sia approssimativamente distribuita in modo logaritmico <span class="citation">(<a href="#ref-rouder2005unshifted" role="doc-biblioref">Rouder 2005</a>)</span>. Ciò presuppone che il logaritmo di <code>rt</code> sia distribuito approssimativamente in maniera normale. Il modello per il logaritmo dei tempi di lettura, <span class="math inline">\(\log\)</span> <code>rt</code>, diventa</p>
<p><span class="math display">\[\begin{equation}
\log rt_i = \beta_0 + \beta_1 so_i + \varepsilon_i,
\end{equation}\]</span></p>
<p>ovvero</p>
<p><span class="math display">\[\begin{equation}
rt \sim LogNormal(\beta_0 + \beta_1 so,\sigma)
\end{equation}\]</span></p>
<p>dove <span class="math inline">\(\beta_0\)</span> è la media generale di <span class="math inline">\(\log\)</span> <code>rt</code> e <span class="math inline">\(\beta_1 so\)</span> codifica la differenza <span class="math inline">\(\E(\log rt_{o}) - \E(\log rt_{s})\)</span> quando si passa dalla condizione nella quale il sostantivo è riferito all’oggetto alla condizione nella quale il sostantivo è riferito all’soggetto – valori negativi significano che i tempi di reazioni sono maggiori nella condizione <code>s</code> che nella condizione <code>o</code>.</p>
<p>Nel modello useremo le seguenti distribuzioni a priori:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\beta[1] &amp;\sim Normal(6, 1.5) \\
\beta[2] &amp;\sim Normal(0, 1.0) \\
\sigma &amp;\sim Cauchy(0, 1)\\
\end{aligned}
\end{equation}\]</span></p>
<!-- https://bayesball.github.io/BOOK/bayesian-hierarchical-modeling.html#hierarchical-normal-modeling -->
<!-- https://vasishth.github.io/bayescogsci/book/sec-trial.html -->
<p>In Stan, il modello diventa</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="mod-hier-stan.html#cb131-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb131-2"><a href="mod-hier-stan.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb131-3"><a href="mod-hier-stan.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N; //number of data points</span></span>
<span id="cb131-4"><a href="mod-hier-stan.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="st">  real rt[N]; //reading time</span></span>
<span id="cb131-5"><a href="mod-hier-stan.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=-0.5, upper=0.5&gt; so[N]; //predictor</span></span>
<span id="cb131-6"><a href="mod-hier-stan.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb131-7"><a href="mod-hier-stan.html#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb131-8"><a href="mod-hier-stan.html#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[2] beta; //fixed intercept and slope</span></span>
<span id="cb131-9"><a href="mod-hier-stan.html#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_e; //error sd</span></span>
<span id="cb131-10"><a href="mod-hier-stan.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb131-11"><a href="mod-hier-stan.html#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb131-12"><a href="mod-hier-stan.html#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb131-13"><a href="mod-hier-stan.html#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="st">  // likelihood</span></span>
<span id="cb131-14"><a href="mod-hier-stan.html#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="st">  beta[1] ~ normal(6, 1.5);</span></span>
<span id="cb131-15"><a href="mod-hier-stan.html#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="st">  beta[2] ~ normal(0, 1);</span></span>
<span id="cb131-16"><a href="mod-hier-stan.html#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma_e ~ cauchy(0, 1);</span></span>
<span id="cb131-17"><a href="mod-hier-stan.html#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:N){</span></span>
<span id="cb131-18"><a href="mod-hier-stan.html#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="st">    mu = beta[1] + beta[2] * so[i];</span></span>
<span id="cb131-19"><a href="mod-hier-stan.html#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="st">    rt[i] ~ lognormal(mu, sigma_e);</span></span>
<span id="cb131-20"><a href="mod-hier-stan.html#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb131-21"><a href="mod-hier-stan.html#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb131-22"><a href="mod-hier-stan.html#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb131-23"><a href="mod-hier-stan.html#cb131-23" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/fixeff_model.stan&quot;</span>)</span>
<span id="cb131-24"><a href="mod-hier-stan.html#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="mod-hier-stan.html#cb131-25" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;fixeff_model.stan&quot;</span>)</span>
<span id="cb131-26"><a href="mod-hier-stan.html#cb131-26" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>I dati sono contenuti nella lista <code>stan_dat</code>:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="mod-hier-stan.html#cb132-1" aria-hidden="true" tabindex="-1"></a>stan_dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb132-2"><a href="mod-hier-stan.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt =</span> rdat<span class="sc">$</span>rt,</span>
<span id="cb132-3"><a href="mod-hier-stan.html#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">so =</span> rdat<span class="sc">$</span>so,</span>
<span id="cb132-4"><a href="mod-hier-stan.html#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(rdat)</span>
<span id="cb132-5"><a href="mod-hier-stan.html#cb132-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Eseguiamo il campionamento MCMC:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="mod-hier-stan.html#cb133-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb133-2"><a href="mod-hier-stan.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> stan_dat,</span>
<span id="cb133-3"><a href="mod-hier-stan.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb133-4"><a href="mod-hier-stan.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb133-5"><a href="mod-hier-stan.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb133-6"><a href="mod-hier-stan.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb133-7"><a href="mod-hier-stan.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> 2L,</span>
<span id="cb133-8"><a href="mod-hier-stan.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb133-9"><a href="mod-hier-stan.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span></span>
<span id="cb133-10"><a href="mod-hier-stan.html#cb133-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Otteniamo un oggetto di classe <code>stanfit</code>:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="mod-hier-stan.html#cb134-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit3<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>Calcoliamo gli intervalli di credibilità al 95%:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="mod-hier-stan.html#cb135-1" aria-hidden="true" tabindex="-1"></a>ci95 <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">posterior_interval</span>(</span>
<span id="cb135-2"><a href="mod-hier-stan.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(stanfit),</span>
<span id="cb135-3"><a href="mod-hier-stan.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.95</span></span>
<span id="cb135-4"><a href="mod-hier-stan.html#cb135-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-5"><a href="mod-hier-stan.html#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ci95, <span class="dv">3</span>)</span>
<span id="cb135-6"><a href="mod-hier-stan.html#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              2.5%     97.5%</span></span>
<span id="cb135-7"><a href="mod-hier-stan.html#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[1]     6.321     6.369</span></span>
<span id="cb135-8"><a href="mod-hier-stan.html#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[2]    -0.113    -0.017</span></span>
<span id="cb135-9"><a href="mod-hier-stan.html#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_e     0.613     0.646</span></span>
<span id="cb135-10"><a href="mod-hier-stan.html#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__    -2617.020 -2612.420</span></span></code></pre></div>
<p>L’effetto medio, sulla scala in millisecondi, si trova nel modo seguente:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="mod-hier-stan.html#cb136-1" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">extract</span>(stanfit, <span class="at">permuted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-2"><a href="mod-hier-stan.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(posterior<span class="sc">$</span>beta[, <span class="dv">1</span>] <span class="sc">+</span> posterior<span class="sc">$</span>beta[, <span class="dv">2</span>])) <span class="sc">-</span> </span>
<span id="cb136-3"><a href="mod-hier-stan.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">mean</span>(posterior<span class="sc">$</span>beta[, <span class="dv">1</span>]))</span>
<span id="cb136-4"><a href="mod-hier-stan.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -35.99588</span></span></code></pre></div>
</div>
<div id="modello-gerarchico-1" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Modello gerarchico<a href="mod-hier-stan.html#modello-gerarchico-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il modello a effetti fissi è inappropriato per i dati di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>)</span> perché non tiene conto del fatto che abbiamo più misure per ogni soggetto e per ogni item. In altre parole, il modello ad effetti fissi viola l’assunzione di indipendenza degli errori. Inoltre, i coefficienti di effetti fissi <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> rappresentano le medie calcolate su tutti i soggetti e tutti gli item, ignorando il fatto che alcuni soggetti sono più veloci e altri più lenti della media, e il fatto che alcuni item sono stati letti più velocemente della media e altri più lentamente.</p>
<p>Nei modelli lineari misti, teniamo in considerazione la variabilità dovuta alle differenze tra soggetti e tra item aggiungendo al modello i termini <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> che aggiustano <span class="math inline">\(\beta_0\)</span> stimando una componente specifica al soggetto <span class="math inline">\(j\)</span> e all’item <span class="math inline">\(k\)</span>. Questa formulazione del modello scompone parzialmente <span class="math inline">\(\varepsilon_i\)</span> in una somma di termini <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> che, geometricamente, corrispondono a degli aggiustamenti dell’intercetta <span class="math inline">\(\beta_0\)</span> specifici per il soggetto <span class="math inline">\(j\)</span> e per l’item <span class="math inline">\(k\)</span>. Se il soggetto <span class="math inline">\(j\)</span> è più lento della media di tutti i soggetti, <span class="math inline">\(u_j\)</span> sarà un numero positivo; se l’item <span class="math inline">\(k\)</span> viene letto più velocemente del tempo di lettura medio di tutti gli item, allora <span class="math inline">\(w_k\)</span> sarà un numero negativo. Viene stimato un aggiustamento <span class="math inline">\(u_{0j}\)</span> per ogni soggetto <span class="math inline">\(j\)</span> e un aggiustamento <span class="math inline">\(w_{0k}\)</span> per ogni item. Gli aggiustamenti <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> sono chiamati <em>random intercepts</em> o <em>varying intercepts</em> <span class="citation">(<a href="#ref-gelman2020regression" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>)</span>. La modifica di <span class="math inline">\(\beta_0\)</span> mediante <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> consente dunque di tenere in considerazione la variabilità dovuta ai soggetti e agli item.</p>
<p>Il random intercept model assume che gli aggiustamenti <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> siano distribuiti normalmente attorno allo zero con una deviazione standard sconosciuta: <span class="math inline">\(u_0 ∼ \mathcal{N}(0, \sigma_u)\)</span> e <span class="math inline">\(w_0 ∼ \mathcal{N}(0, \sigma_w)\)</span>. Il modello include dunque tre fonti di varianza: la deviazione standard degli errori <span class="math inline">\(\sigma_e\)</span>, la deviazione standard delle <em>random intercepts</em> per i soggetti, <span class="math inline">\(\sigma_u\)</span>, e la deviazione standard delle <em>random intercepts</em> per gli item, <span class="math inline">\(\sigma_w\)</span>. Queste tre fonti di variabilità sono dette <em>componenti della varianza</em>. Possiamo dunque scrivere:</p>
<p><span class="math display">\[\begin{equation}
\log rt_{ijk} = \beta_0 + \beta_1 so_i + u_{0j} + w_{0k} + \varepsilon_{ijk}.
\end{equation}\]</span></p>
<p>Il coefficiente <span class="math inline">\(\beta_1\)</span> è quello di interesse primario. Come conseguenza della codifica usata, avrà il valore <span class="math inline">\(-\beta_1\)</span> nella condizione in cui il sostantivo è riferito al soggetto e <span class="math inline">\(+\beta_1\)</span> nella condizione in cui il sostantivo è riferito all’oggetto della frase.</p>
<p>In Stan il modello diventa:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="mod-hier-stan.html#cb137-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb137-2"><a href="mod-hier-stan.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb137-3"><a href="mod-hier-stan.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; N; //number of data points</span></span>
<span id="cb137-4"><a href="mod-hier-stan.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="st">  real rt[N]; //reading time</span></span>
<span id="cb137-5"><a href="mod-hier-stan.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=-0.5, upper=0.5&gt; so[N]; //predictor</span></span>
<span id="cb137-6"><a href="mod-hier-stan.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; J; //number of subjects</span></span>
<span id="cb137-7"><a href="mod-hier-stan.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1&gt; K; //number of items</span></span>
<span id="cb137-8"><a href="mod-hier-stan.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1, upper=J&gt; subj[N]; //subject id</span></span>
<span id="cb137-9"><a href="mod-hier-stan.html#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=1, upper=K&gt; item[N]; //item id</span></span>
<span id="cb137-10"><a href="mod-hier-stan.html#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb137-11"><a href="mod-hier-stan.html#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb137-12"><a href="mod-hier-stan.html#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[2] beta; //fixed intercept and slope</span></span>
<span id="cb137-13"><a href="mod-hier-stan.html#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[J] u; //subject intercepts</span></span>
<span id="cb137-14"><a href="mod-hier-stan.html#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[K] w; //item intercepts</span></span>
<span id="cb137-15"><a href="mod-hier-stan.html#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_e; //error sd</span></span>
<span id="cb137-16"><a href="mod-hier-stan.html#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_u; //subj sd</span></span>
<span id="cb137-17"><a href="mod-hier-stan.html#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma_w; //item sd</span></span>
<span id="cb137-18"><a href="mod-hier-stan.html#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb137-19"><a href="mod-hier-stan.html#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb137-20"><a href="mod-hier-stan.html#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb137-21"><a href="mod-hier-stan.html#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="st">  //priors</span></span>
<span id="cb137-22"><a href="mod-hier-stan.html#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="st">  u ~ normal(0, sigma_u); //subj random effects</span></span>
<span id="cb137-23"><a href="mod-hier-stan.html#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="st">  w ~ normal(0, sigma_w); //item random effects</span></span>
<span id="cb137-24"><a href="mod-hier-stan.html#cb137-24" aria-hidden="true" tabindex="-1"></a><span class="st">  // likelihood</span></span>
<span id="cb137-25"><a href="mod-hier-stan.html#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="st">  for (i in 1:N){</span></span>
<span id="cb137-26"><a href="mod-hier-stan.html#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="st">    mu = beta[1] + u[subj[i]] + w[item[i]] + beta[2] * so[i];</span></span>
<span id="cb137-27"><a href="mod-hier-stan.html#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="st">    rt[i] ~ lognormal(mu, sigma_e);</span></span>
<span id="cb137-28"><a href="mod-hier-stan.html#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb137-29"><a href="mod-hier-stan.html#cb137-29" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb137-30"><a href="mod-hier-stan.html#cb137-30" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb137-31"><a href="mod-hier-stan.html#cb137-31" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/random_intercepts_model.stan&quot;</span>)</span>
<span id="cb137-32"><a href="mod-hier-stan.html#cb137-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-33"><a href="mod-hier-stan.html#cb137-33" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;random_intercepts_model.stan&quot;</span>)</span>
<span id="cb137-34"><a href="mod-hier-stan.html#cb137-34" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>I dati sono</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="mod-hier-stan.html#cb138-1" aria-hidden="true" tabindex="-1"></a>stan_dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb138-2"><a href="mod-hier-stan.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">subj =</span> <span class="fu">as.integer</span>(<span class="fu">as.factor</span>(rdat<span class="sc">$</span>subj)),</span>
<span id="cb138-3"><a href="mod-hier-stan.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">item =</span> <span class="fu">as.integer</span>(<span class="fu">as.factor</span>(rdat<span class="sc">$</span>item)),</span>
<span id="cb138-4"><a href="mod-hier-stan.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt =</span> rdat<span class="sc">$</span>rt,</span>
<span id="cb138-5"><a href="mod-hier-stan.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">so =</span> rdat<span class="sc">$</span>so,</span>
<span id="cb138-6"><a href="mod-hier-stan.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(rdat),</span>
<span id="cb138-7"><a href="mod-hier-stan.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">J =</span> <span class="fu">length</span>(<span class="fu">unique</span>(rdat<span class="sc">$</span>subj)),</span>
<span id="cb138-8"><a href="mod-hier-stan.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> <span class="fu">length</span>(<span class="fu">unique</span>(rdat<span class="sc">$</span>item))</span>
<span id="cb138-9"><a href="mod-hier-stan.html#cb138-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Eseguiamo il campionamento MCMC:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="mod-hier-stan.html#cb139-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb139-2"><a href="mod-hier-stan.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> stan_dat,</span>
<span id="cb139-3"><a href="mod-hier-stan.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb139-4"><a href="mod-hier-stan.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb139-5"><a href="mod-hier-stan.html#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb139-6"><a href="mod-hier-stan.html#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb139-7"><a href="mod-hier-stan.html#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> 2L,</span>
<span id="cb139-8"><a href="mod-hier-stan.html#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb139-9"><a href="mod-hier-stan.html#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span></span>
<span id="cb139-10"><a href="mod-hier-stan.html#cb139-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Otteniamo un oggetto di classe <code>stanfit</code>:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="mod-hier-stan.html#cb140-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit4<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>Le medie a posteriori si ottengono con</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="mod-hier-stan.html#cb141-1" aria-hidden="true" tabindex="-1"></a>fit4<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma_e&quot;</span>, <span class="st">&quot;sigma_w&quot;</span>, <span class="st">&quot;sigma_u&quot;</span>))</span>
<span id="cb141-2"><a href="mod-hier-stan.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 10</span></span>
<span id="cb141-3"><a href="mod-hier-stan.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable    mean  median      sd     mad      q5     q95  rhat ess_bulk</span></span>
<span id="cb141-4"><a href="mod-hier-stan.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb141-5"><a href="mod-hier-stan.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 beta[1]   6.35    6.35   0.0512  0.0511   6.26    6.43    1.00    1413.</span></span>
<span id="cb141-6"><a href="mod-hier-stan.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 beta[2]  -0.0604 -0.0604 0.0220  0.0218  -0.0974 -0.0243  1.00   17390.</span></span>
<span id="cb141-7"><a href="mod-hier-stan.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 sigma_e   0.577   0.577  0.00792 0.00784  0.564   0.590   1.00   17746.</span></span>
<span id="cb141-8"><a href="mod-hier-stan.html#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 sigma_w   0.120   0.115  0.0291  0.0263   0.0806  0.173   1.00    8584.</span></span>
<span id="cb141-9"><a href="mod-hier-stan.html#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 sigma_u   0.238   0.235  0.0319  0.0304   0.191   0.293   1.00   11445.</span></span>
<span id="cb141-10"><a href="mod-hier-stan.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1 more variable: ess_tail &lt;dbl&gt;</span></span></code></pre></div>
<p>Gli intervalli di credibilità sono:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="mod-hier-stan.html#cb142-1" aria-hidden="true" tabindex="-1"></a>ci95 <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">posterior_interval</span>(</span>
<span id="cb142-2"><a href="mod-hier-stan.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(stanfit),</span>
<span id="cb142-3"><a href="mod-hier-stan.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.95</span></span>
<span id="cb142-4"><a href="mod-hier-stan.html#cb142-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb142-5"><a href="mod-hier-stan.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ci95, <span class="dv">3</span>)</span>
<span id="cb142-6"><a href="mod-hier-stan.html#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              2.5%     97.5%</span></span>
<span id="cb142-7"><a href="mod-hier-stan.html#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[1]     6.247     6.447</span></span>
<span id="cb142-8"><a href="mod-hier-stan.html#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[2]    -0.104    -0.017</span></span>
<span id="cb142-9"><a href="mod-hier-stan.html#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[1]       -0.208     0.081</span></span>
<span id="cb142-10"><a href="mod-hier-stan.html#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[2]       -0.304    -0.012</span></span>
<span id="cb142-11"><a href="mod-hier-stan.html#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[3]       -0.127     0.163</span></span>
<span id="cb142-12"><a href="mod-hier-stan.html#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[4]       -0.212     0.079</span></span>
<span id="cb142-13"><a href="mod-hier-stan.html#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[5]       -0.079     0.216</span></span>
<span id="cb142-14"><a href="mod-hier-stan.html#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[6]       -0.049     0.239</span></span>
<span id="cb142-15"><a href="mod-hier-stan.html#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[7]       -0.162     0.131</span></span>
<span id="cb142-16"><a href="mod-hier-stan.html#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[8]       -0.124     0.168</span></span>
<span id="cb142-17"><a href="mod-hier-stan.html#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[9]       -0.097     0.196</span></span>
<span id="cb142-18"><a href="mod-hier-stan.html#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[10]      -0.009     0.283</span></span>
<span id="cb142-19"><a href="mod-hier-stan.html#cb142-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[11]       0.450     0.745</span></span>
<span id="cb142-20"><a href="mod-hier-stan.html#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[12]       0.149     0.443</span></span>
<span id="cb142-21"><a href="mod-hier-stan.html#cb142-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[13]      -0.169     0.123</span></span>
<span id="cb142-22"><a href="mod-hier-stan.html#cb142-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[14]      -0.151     0.140</span></span>
<span id="cb142-23"><a href="mod-hier-stan.html#cb142-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[15]       0.035     0.324</span></span>
<span id="cb142-24"><a href="mod-hier-stan.html#cb142-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[16]      -0.199     0.089</span></span>
<span id="cb142-25"><a href="mod-hier-stan.html#cb142-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[17]      -0.716    -0.418</span></span>
<span id="cb142-26"><a href="mod-hier-stan.html#cb142-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[18]      -0.417    -0.127</span></span>
<span id="cb142-27"><a href="mod-hier-stan.html#cb142-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[19]      -0.295     0.003</span></span>
<span id="cb142-28"><a href="mod-hier-stan.html#cb142-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[20]       0.162     0.452</span></span>
<span id="cb142-29"><a href="mod-hier-stan.html#cb142-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[21]       0.050     0.341</span></span>
<span id="cb142-30"><a href="mod-hier-stan.html#cb142-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[22]       0.123     0.418</span></span>
<span id="cb142-31"><a href="mod-hier-stan.html#cb142-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[23]      -0.197     0.096</span></span>
<span id="cb142-32"><a href="mod-hier-stan.html#cb142-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[24]      -0.084     0.293</span></span>
<span id="cb142-33"><a href="mod-hier-stan.html#cb142-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[25]       0.000     0.292</span></span>
<span id="cb142-34"><a href="mod-hier-stan.html#cb142-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[26]      -0.494    -0.203</span></span>
<span id="cb142-35"><a href="mod-hier-stan.html#cb142-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[27]      -0.233     0.059</span></span>
<span id="cb142-36"><a href="mod-hier-stan.html#cb142-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[28]      -0.332    -0.038</span></span>
<span id="cb142-37"><a href="mod-hier-stan.html#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[29]      -0.423    -0.127</span></span>
<span id="cb142-38"><a href="mod-hier-stan.html#cb142-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[30]      -0.406    -0.113</span></span>
<span id="cb142-39"><a href="mod-hier-stan.html#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[31]      -0.100     0.188</span></span>
<span id="cb142-40"><a href="mod-hier-stan.html#cb142-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[32]      -0.178     0.113</span></span>
<span id="cb142-41"><a href="mod-hier-stan.html#cb142-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[33]      -0.239     0.056</span></span>
<span id="cb142-42"><a href="mod-hier-stan.html#cb142-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[34]       0.257     0.554</span></span>
<span id="cb142-43"><a href="mod-hier-stan.html#cb142-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[35]      -0.396    -0.104</span></span>
<span id="cb142-44"><a href="mod-hier-stan.html#cb142-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[36]      -0.144     0.145</span></span>
<span id="cb142-45"><a href="mod-hier-stan.html#cb142-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[37]      -0.171     0.118</span></span>
<span id="cb142-46"><a href="mod-hier-stan.html#cb142-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[1]       -0.133     0.061</span></span>
<span id="cb142-47"><a href="mod-hier-stan.html#cb142-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[2]       -0.118     0.075</span></span>
<span id="cb142-48"><a href="mod-hier-stan.html#cb142-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[3]       -0.101     0.093</span></span>
<span id="cb142-49"><a href="mod-hier-stan.html#cb142-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[4]       -0.213    -0.015</span></span>
<span id="cb142-50"><a href="mod-hier-stan.html#cb142-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[5]       -0.006     0.190</span></span>
<span id="cb142-51"><a href="mod-hier-stan.html#cb142-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[6]       -0.141     0.056</span></span>
<span id="cb142-52"><a href="mod-hier-stan.html#cb142-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[7]       -0.281    -0.082</span></span>
<span id="cb142-53"><a href="mod-hier-stan.html#cb142-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[8]        0.115     0.315</span></span>
<span id="cb142-54"><a href="mod-hier-stan.html#cb142-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[9]       -0.185     0.009</span></span>
<span id="cb142-55"><a href="mod-hier-stan.html#cb142-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[10]      -0.041     0.153</span></span>
<span id="cb142-56"><a href="mod-hier-stan.html#cb142-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[11]      -0.136     0.058</span></span>
<span id="cb142-57"><a href="mod-hier-stan.html#cb142-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[12]      -0.030     0.165</span></span>
<span id="cb142-58"><a href="mod-hier-stan.html#cb142-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[13]      -0.176     0.018</span></span>
<span id="cb142-59"><a href="mod-hier-stan.html#cb142-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[14]       0.036     0.235</span></span>
<span id="cb142-60"><a href="mod-hier-stan.html#cb142-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[15]      -0.041     0.155</span></span>
<span id="cb142-61"><a href="mod-hier-stan.html#cb142-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_e     0.562     0.593</span></span>
<span id="cb142-62"><a href="mod-hier-stan.html#cb142-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_u     0.183     0.309</span></span>
<span id="cb142-63"><a href="mod-hier-stan.html#cb142-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_w     0.076     0.188</span></span>
<span id="cb142-64"><a href="mod-hier-stan.html#cb142-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__    -2332.580 -2311.210</span></span></code></pre></div>
<!-- Questi risultati replicano i risultati che si ottengono con la funzione `brms::brm`: -->
<!-- ```{r, warning=FALSE, message=FALSE, error=FALSE, results='hide'} -->
<!-- M1 <- brm( -->
<!--   rt ~ so + (1 | subj) + (1 | item), -->
<!--   family = lognormal(), -->
<!--   prior = c( -->
<!--     prior(normal(6, 1.5), class = Intercept), -->
<!--     prior(normal(0, 1), class = sigma), -->
<!--     prior(normal(0, 1), class = b) -->
<!--     ), -->
<!--   data = rdat -->
<!-- ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- summary(M1) -->
<!-- ``` -->

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Bergh, Don van den, Johnny Van Doorn, Maarten Marsman, Tim Draws, Erik-Jan Van Kesteren, Koen Derks, Fabian Dablander, et al. 2020. <span>“A Tutorial on Conducting and Interpreting a Bayesian ANOVA in JASP.”</span> <em><span>L’Année</span> Psychologique</em> 120 (1): 73–96.
</div>
<div class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div class="csl-entry">
Gibson, Edward, and H-H Iris Wu. 2013. <span>“Processing Chinese Relative Clauses in Context.”</span> <em>Language and Cognitive Processes</em> 28 (1-2): 125–55.
</div>
<div class="csl-entry">
Horn, Samantha, and George Loewenstein. 2021. <span>“Underestimating Learning by Doing.”</span> <em>Available at SSRN 3941441</em>.
</div>
<div class="csl-entry">
Horstmann, Aike C, Nikolai Bock, Eva Linhuber, Jessica M Szczuka, Carolin Straßmann, and Nicole C Krämer. 2018. <span>“Do a Robot’s Social Skills and Its Objection Discourage Interactants from Switching the Robot Off?”</span> <em>PloS One</em> 13 (7): e0201581.
</div>
<div class="csl-entry">
Rouder, Jeffrey N. 2005. <span>“Are Unshifted Distributional Models Appropriate for Response Time?”</span> <em>Psychometrika</em> 70 (2): 377–81.
</div>
<div class="csl-entry">
Sawilowsky, Shlomo S. 2009. <span>“New Effect Size Rules of Thumb.”</span> <em>Journal of Modern Applied Statistical Methods</em> 8 (2): 26.
</div>
<div class="csl-entry">
Sorensen, Tanner, and Shravan Vasishth. 2015. <span>“Bayesian Linear Mixed Models Using Stan: A Tutorial for Psychologists, Linguists, and Cognitive Scientists.”</span> <em>arXiv Preprint arXiv:1506.06201</em>.
</div>
</div>
</div>
</div>











<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gelman2020regression" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div id="ref-gibson2013processing" class="csl-entry">
Gibson, Edward, and H-H Iris Wu. 2013. <span>“Processing Chinese Relative Clauses in Context.”</span> <em>Language and Cognitive Processes</em> 28 (1-2): 125–55.
</div>
<div id="ref-rouder2005unshifted" class="csl-entry">
Rouder, Jeffrey N. 2005. <span>“Are Unshifted Distributional Models Appropriate for Response Time?”</span> <em>Psychometrika</em> 70 (2): 377–81.
</div>
<div id="ref-sorensen2015bayesian" class="csl-entry">
Sorensen, Tanner, and Shravan Vasishth. 2015. <span>“Bayesian Linear Mixed Models Using Stan: A Tutorial for Psychologists, Linguists, and Cognitive Scientists.”</span> <em>arXiv Preprint arXiv:1506.06201</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-anova.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/070_mod_hier.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ds4psy.pdf", "ds4psy.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
