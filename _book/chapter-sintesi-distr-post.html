<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 9 Sintesi a posteriori | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.26.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 9 Sintesi a posteriori | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 9 Sintesi a posteriori | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie" />


<meta name="date" content="2022-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="diagn-markov-chains.html"/>
<link rel="next" href="ch-prediction.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="part"><span><b>I Inferenza bayesiana</b></span></li>
<li class="chapter" data-level="2" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html"><i class="fa fa-check"></i><b>2</b> Flusso di lavoro bayesiano</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#modellizzazione-bayesiana"><i class="fa fa-check"></i><b>2.1</b> Modellizzazione bayesiana</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#notazione"><i class="fa fa-check"></i><b>2.1.1</b> Notazione</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#distribuzioni-a-priori"><i class="fa fa-check"></i><b>2.2</b> Distribuzioni a priori</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#tipologie-di-distribuzioni-a-priori"><i class="fa fa-check"></i><b>2.2.1</b> Tipologie di distribuzioni a priori</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#selezione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>2.2.2</b> Selezione della distribuzione a priori</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#unapplicazione-empirica"><i class="fa fa-check"></i><b>2.2.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#la-funzione-di-verosimiglianza"><i class="fa fa-check"></i><b>2.3</b> La funzione di verosimiglianza</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#notazione-1"><i class="fa fa-check"></i><b>2.3.1</b> Notazione</a></li>
<li class="chapter" data-level="2.3.2" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#la-log-verosimiglianza"><i class="fa fa-check"></i><b>2.3.2</b> La log-verosimiglianza</a></li>
<li class="chapter" data-level="2.3.3" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#unapplicazione-empirica-1"><i class="fa fa-check"></i><b>2.3.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#sec:const-normaliz-bino23"><i class="fa fa-check"></i><b>2.4</b> La verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#unapplicazione-empirica-2"><i class="fa fa-check"></i><b>2.4.1</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#distribuzione-a-posteriori"><i class="fa fa-check"></i><b>2.5</b> Distribuzione a posteriori</a></li>
<li class="chapter" data-level="2.6" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#distribuzione-predittiva-a-priori"><i class="fa fa-check"></i><b>2.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="2.7" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#distribuzione-predittiva-a-posteriori"><i class="fa fa-check"></i><b>2.7</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="" data-path="ch:intro-bayes-inference.html"><a href="ch:intro-bayes-inference.html#commenti-e-considerazioni-finali"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html"><i class="fa fa-check"></i><b>3</b> Pensare ad una proporzione in termini soggettivi</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#ch-prior-discr-binom"><i class="fa fa-check"></i><b>3.1</b> Inferenza bayesiana con una distribuzione a priori discreta</a></li>
<li class="chapter" data-level="3.2" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#ch-prior-cont-binom"><i class="fa fa-check"></i><b>3.2</b> Inferenza bayesiana con una distribuzione a priori continua</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#quali-parametri-per-la-distribuzione-beta"><i class="fa fa-check"></i><b>3.2.1</b> Quali parametri per la distribuzione Beta?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#commenti-e-considerazioni-finali-1"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html"><i class="fa fa-check"></i><b>4</b> Distribuzioni coniugate</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#lo-schema-beta-binomiale"><i class="fa fa-check"></i><b>4.1</b> Lo schema beta-binomiale</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#la-specificazione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>4.1.1</b> La specificazione della distribuzione a priori</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#la-specificazione-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>4.1.2</b> La specificazione della distribuzione a posteriori</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#inferenza-bayesiana-con-distribuzioni-a-priori-continue"><i class="fa fa-check"></i><b>4.2</b> Inferenza bayesiana con distribuzioni a priori continue</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#approccio-bayesiano-alla-verifica-di-ipotesi"><i class="fa fa-check"></i><b>4.2.1</b> Approccio bayesiano alla verifica di ipotesi</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#intervalli-di-credibilità"><i class="fa fa-check"></i><b>4.2.2</b> Intervalli di credibilità</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#principali-distribuzioni-coniugate"><i class="fa fa-check"></i><b>4.3</b> Principali distribuzioni coniugate</a></li>
<li class="chapter" data-level="" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#commenti-e-considerazioni-finali-2"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-balance.html"><a href="chapter-balance.html"><i class="fa fa-check"></i><b>5</b> L’influenza della distribuzione a priori</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-balance.html"><a href="chapter-balance.html#il-test-di-benchdel"><i class="fa fa-check"></i><b>5.1</b> Il test di Benchdel</a></li>
<li class="chapter" data-level="5.2" data-path="chapter-balance.html"><a href="chapter-balance.html#stessi-dati-ma-diverse-distribuzioni-a-priori"><i class="fa fa-check"></i><b>5.2</b> Stessi dati ma diverse distribuzioni a priori</a></li>
<li class="chapter" data-level="5.3" data-path="chapter-balance.html"><a href="chapter-balance.html#dati-diversi-ma-la-stessa-distribuzione-a-priori"><i class="fa fa-check"></i><b>5.3</b> Dati diversi ma la stessa distribuzione a priori</a></li>
<li class="chapter" data-level="5.4" data-path="chapter-balance.html"><a href="chapter-balance.html#dati-diversi-e-diverse-distribuzioni-a-priori"><i class="fa fa-check"></i><b>5.4</b> Dati diversi e diverse distribuzioni a priori</a></li>
<li class="chapter" data-level="5.5" data-path="chapter-balance.html"><a href="chapter-balance.html#collegare-le-intuizioni-alla-teoria"><i class="fa fa-check"></i><b>5.5</b> Collegare le intuizioni alla teoria</a></li>
<li class="chapter" data-level="" data-path="chapter-balance.html"><a href="chapter-balance.html#commenti-e-considerazioni-finali-3"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch:metropolis.html"><a href="ch:metropolis.html"><i class="fa fa-check"></i><b>6</b> Approssimazione della distribuzione a posteriori</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch:metropolis.html"><a href="ch:metropolis.html#metodo-basato-su-griglia"><i class="fa fa-check"></i><b>6.1</b> Metodo basato su griglia</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch:metropolis.html"><a href="ch:metropolis.html#modello-beta-binomiale"><i class="fa fa-check"></i><b>6.1.1</b> Modello Beta-Binomiale</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch:metropolis.html"><a href="ch:metropolis.html#chapter-simulazioneMC"><i class="fa fa-check"></i><b>6.2</b> Metodo Monte Carlo</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ch:metropolis.html"><a href="ch:metropolis.html#integration-mc"><i class="fa fa-check"></i><b>6.2.1</b> Integrazione di Monte Carlo</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch:metropolis.html"><a href="ch:metropolis.html#descrizione-intuitiva"><i class="fa fa-check"></i><b>6.2.2</b> Descrizione intuitiva</a></li>
<li class="chapter" data-level="6.2.3" data-path="ch:metropolis.html"><a href="ch:metropolis.html#unapplicazione-empirica-3"><i class="fa fa-check"></i><b>6.2.3</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="6.2.4" data-path="ch:metropolis.html"><a href="ch:metropolis.html#una-passeggiata-casuale-sui-numeri-naturali"><i class="fa fa-check"></i><b>6.2.4</b> Una passeggiata casuale sui numeri naturali</a></li>
<li class="chapter" data-level="6.2.5" data-path="ch:metropolis.html"><a href="ch:metropolis.html#lalgoritmo-di-metropolis"><i class="fa fa-check"></i><b>6.2.5</b> L’algoritmo di Metropolis</a></li>
<li class="chapter" data-level="6.2.6" data-path="ch:metropolis.html"><a href="ch:metropolis.html#unapplicazione-empirica-4"><i class="fa fa-check"></i><b>6.2.6</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="6.2.7" data-path="ch:metropolis.html"><a href="ch:metropolis.html#gibbs-sampling"><i class="fa fa-check"></i><b>6.2.7</b> Gibb’s sampling</a></li>
<li class="chapter" data-level="6.2.8" data-path="ch:metropolis.html"><a href="ch:metropolis.html#input"><i class="fa fa-check"></i><b>6.2.8</b> Input</a></li>
<li class="chapter" data-level="6.2.9" data-path="ch:metropolis.html"><a href="ch:metropolis.html#stazionarietà"><i class="fa fa-check"></i><b>6.2.9</b> Stazionarietà</a></li>
<li class="chapter" data-level="6.2.10" data-path="ch:metropolis.html"><a href="ch:metropolis.html#test-di-convergenza"><i class="fa fa-check"></i><b>6.2.10</b> Test di convergenza</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch:metropolis.html"><a href="ch:metropolis.html#commenti-e-considerazioni-finali-4"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html"><i class="fa fa-check"></i><b>7</b> Il modello beta-binomiale in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="7.1" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#il-presidente-trump-e-lidrossiclorochina"><i class="fa fa-check"></i><b>7.1</b> Il presidente Trump e l’idrossiclorochina</a></li>
<li class="chapter" data-level="7.2" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#una-proporzione"><i class="fa fa-check"></i><b>7.2</b> Una proporzione</a></li>
<li class="chapter" data-level="7.3" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#cmdstanr-gautret"><i class="fa fa-check"></i><b>7.3</b> Interfaccia <code>cmdstanr</code></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#fase-1"><i class="fa fa-check"></i><b>7.3.1</b> Fase 1</a></li>
<li class="chapter" data-level="7.3.2" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#fase-2"><i class="fa fa-check"></i><b>7.3.2</b> Fase 2</a></li>
<li class="chapter" data-level="7.3.3" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#burn-in"><i class="fa fa-check"></i><b>7.3.3</b> Burn-in</a></li>
<li class="chapter" data-level="7.3.4" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#inferenza"><i class="fa fa-check"></i><b>7.3.4</b> Inferenza</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#la-critica-di-hulme_2020"><i class="fa fa-check"></i><b>7.4</b> La critica di <span class="citation">Hulme et al. (<span>2020</span>)</span></a></li>
<li class="chapter" data-level="7.5" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#due-proporzioni"><i class="fa fa-check"></i><b>7.5</b> Due proporzioni</a></li>
<li class="chapter" data-level="" data-path="stan-beta-binom.html"><a href="stan-beta-binom.html#commenti-e-considerazioni-finali-5"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html"><i class="fa fa-check"></i><b>8</b> Diagnostica delle catene markoviane</a>
<ul>
<li class="chapter" data-level="8.1" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html#esame-dei-trace-plot"><i class="fa fa-check"></i><b>8.1</b> Esame dei <em>trace plot</em></a></li>
<li class="chapter" data-level="8.2" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html#confronto-delle-catene-parallele"><i class="fa fa-check"></i><b>8.2</b> Confronto delle catene parallele</a></li>
<li class="chapter" data-level="8.3" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html#numerosita-campionaria-effettiva"><i class="fa fa-check"></i><b>8.3</b> Numerosità campionaria effettiva</a></li>
<li class="chapter" data-level="8.4" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html#autocorrelazione"><i class="fa fa-check"></i><b>8.4</b> Autocorrelazione</a></li>
<li class="chapter" data-level="8.5" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html#statistica-hatr"><i class="fa fa-check"></i><b>8.5</b> Statistica <span class="math inline">\(\hat{R}\)</span></a></li>
<li class="chapter" data-level="8.6" data-path="diagn-markov-chains.html"><a href="diagn-markov-chains.html#diagnostica-di-convergenza-di-geweke"><i class="fa fa-check"></i><b>8.6</b> Diagnostica di convergenza di Geweke</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html"><i class="fa fa-check"></i><b>9</b> Sintesi a posteriori</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#stima-puntuale"><i class="fa fa-check"></i><b>9.1</b> Stima puntuale</a></li>
<li class="chapter" data-level="9.2" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità"><i class="fa fa-check"></i><b>9.2</b> Intervallo di credibilità</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità-a-code-uguali"><i class="fa fa-check"></i><b>9.2.1</b> Intervallo di credibilità a code uguali</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità-a-densità-a-posteriori-più-alta"><i class="fa fa-check"></i><b>9.2.2</b> Intervallo di credibilità a densità a posteriori più alta</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#interpretazione"><i class="fa fa-check"></i><b>9.2.3</b> Interpretazione</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#un-esempio-concreto"><i class="fa fa-check"></i><b>9.3</b> Un esempio concreto</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#stime-puntuali-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>9.3.1</b> Stime puntuali della distribuzione a posteriori</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità-1"><i class="fa fa-check"></i><b>9.3.2</b> Intervallo di credibilità</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#probabilità-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>9.3.3</b> Probabilità della distribuzione a posteriori</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#la-funzione-di-perdita-attesa"><i class="fa fa-check"></i><b>9.4</b> La funzione di perdita attesa</a></li>
<li class="chapter" data-level="" data-path="chapter-sintesi-distr-post.html"><a href="chapter-sintesi-distr-post.html#commenti-e-considerazioni-finali-6"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-prediction.html"><a href="ch-prediction.html"><i class="fa fa-check"></i><b>10</b> La predizione bayesiana</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva"><i class="fa fa-check"></i><b>10.1</b> La distribuzione predittiva</a></li>
<li class="chapter" data-level="10.2" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-simulazione"><i class="fa fa-check"></i><b>10.2</b> La distribuzione predittiva a posteriori mediante simulazione</a></li>
<li class="chapter" data-level="10.3" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-mcmc"><i class="fa fa-check"></i><b>10.3</b> La distribuzione predittiva a posteriori mediante MCMC</a></li>
<li class="chapter" data-level="10.4" data-path="ch-prediction.html"><a href="ch-prediction.html#i-metodi-per-la-valutazione-del-modello"><i class="fa fa-check"></i><b>10.4</b> I metodi per la valutazione del modello</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="ch-prediction.html"><a href="ch-prediction.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>10.4.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ch-prediction.html"><a href="ch-prediction.html#distribuzione-predittiva-a-priori-1"><i class="fa fa-check"></i><b>10.5</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="" data-path="ch-prediction.html"><a href="ch-prediction.html#commenti-e-considerazioni-finali-7"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html"><i class="fa fa-check"></i><b>11</b> Inferenza sul parametro <span class="math inline">\(\mu\)</span> (media di una v.c. Normale)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html#caso-normale-normale-con-varianza-nota"><i class="fa fa-check"></i><b>11.1</b> Caso Normale-Normale con varianza nota</a></li>
<li class="chapter" data-level="11.2" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html#derivazione-analitica-della-distribuzione-a-posteriori-pmu-mid-y"><i class="fa fa-check"></i><b>11.2</b> Derivazione analitica della distribuzione a posteriori <span class="math inline">\(p(\mu \mid y)\)</span></a></li>
<li class="chapter" data-level="11.3" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html#il-modello-normale-con-stan"><i class="fa fa-check"></i><b>11.3</b> Il modello Normale con Stan</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html#versione-1-sigma-nota"><i class="fa fa-check"></i><b>11.3.1</b> Versione 1 (<span class="math inline">\(\sigma\)</span> nota)</a></li>
<li class="chapter" data-level="11.3.2" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html#versione-2-sigma-incognita"><i class="fa fa-check"></i><b>11.3.2</b> Versione 2 (<span class="math inline">\(\sigma\)</span> incognita)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="normal-normal-mod-stan.html"><a href="normal-normal-mod-stan.html#commenti-e-considerazioni-finali-8"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-sintesi-distr-post" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Capitolo 9</span> Sintesi a posteriori<a href="chapter-sintesi-distr-post.html#chapter-sintesi-distr-post" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La distribuzione a posteriori è un modo per descrivere il nostro grado di incertezza rispetto al parametro incognito (o rispetto ai parametri incogniti) oggetto dell’inferenza. La distribuzione a posteriori contiene tutte le informazioni disponibili sui possibili valori del parametro. Se il parametro esaminato è monodimensionale (o bidimensionale) è possibile fornire un grafico di tutta la distribuzione a posteriori <span class="math inline">\(p(\theta \mid y)\)</span>. Tuttavia, spesso vogliamo anche giungere ad una sintesi numerica della distribuzione a posteriori, soprattutto se il vettore dei parametri ha più di due dimensioni. A a questo proposito è possibile utilizzare le consuete statistiche descrittive, come media, mediana, moda, varianza, deviazione standard e i quantili. In alcuni casi, queste statistiche descrittive sono più facili da presentare e interpretare rispetto alla rappresentazione grafica della distribuzione a posteriori.</p>
<p>La stima puntuale della tendenza centrale della distribuzione a posteriori fornisce informazioni su quello che può essere considerato come il “valore più plausibile” del parametro. L’intervallo di credibilità fornisce invece un’indicazione dell’ampiezza dell’intervallo che contiene una determinata quota della massa della distribuzione a posteriori del parametro.</p>
<div id="stima-puntuale" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Stima puntuale<a href="chapter-sintesi-distr-post.html#stima-puntuale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Per sintetizzare la distribuzione a posteriori in modo da giungere ad
una stima puntuale di <span class="math inline">\(\theta\)</span> si è soliti scegliere tra moda, mediana o media a seconda del tipo di distribuzione con cui si ha a che fare e
della sua forma. Ogni stima puntuale ha una sua interpretazione.</p>
<ul>
<li>La media è il valore atteso a posteriori del parametro.</li>
<li>La moda può essere interpretata come il singolo valore più credibile (“più plausibile”) del parametro, alla luce dei dati, ovvero il valore per il parametro <span class="math inline">\(\theta\)</span> che massimizza la distribuzione a posteriori. Per questa ragione la moda viene detta <em>massimo a posteriori</em>, MAP. Il limite della moda quale statistica riassuntiva della distribuzione a posteriori è che, talvolta, tale distribuzione è multimodale e il MAP non è necessariamente il valore “più credibile”.</li>
<li>La mediana è il valore del parametro tale per cui, su entrambi i lati di essa, giace il 50% della massa di probabilità a posteriori.</li>
</ul>
<p>La misura di variabilità del parametro è la <em>varianza a posteriori</em>
la quale, nel caso di una distribuzione a posteriori ottenuta per via
numerica, si calcola con la formula della varianza che conosciamo
rispetto alla tendenza centrale data dalla media a posteriori. La radice quadrata della varianza a posteriori è la <em>deviazione standard a posteriori</em> che descrive l’incertezza a posteriori circa il parametro di interesse nella stessa unità di misura dei dati.</p>
<p>Le procedure bayesiane basate sui metodi MCMC utilizzano un numero finito di campioni dalla distribuzione stazionaria, e una tale caratteristica della simulazione introduce un ulteriore livello di incertezza nella stima del parametro. L’<em>errore standard della stima</em> (in inglese <em>Monte Carlo standard error</em>, MCSE) misura l’accuratezza della simulazione. La deviazione standard a posteriori e l’errore standard della stima sono due concetti completamente diversi. La deviazione standard a posteriori descrive l’incertezza circa il parametro (l’ampiezza della distribuzione a posteriori) ed è una funzione della dimensione del campione; il MCSE descrive invece l’incertezza nella stima del parametro dovuta alla simulazione MCMC ed è una funzione del numero di iterazioni nella simulazione.</p>
</div>
<div id="intervallo-di-credibilità" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Intervallo di credibilità<a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Molto spesso la stima puntuale è accompagnata da una stima intervallare (abbiamo già incontrato questo aspetto nel Capitolo <a href="ch-distr-coniugate.html#ch-distr-coniugate">4</a> discutendo lo schema beta-binomiale). Nella statistica bayesiana, se il parametro <span class="math inline">\(\theta \in \Theta\)</span> è monodimensionale, si dice <em>intervallo di credibilità</em> un intervallo di valori <span class="math inline">\(I_{\alpha}\)</span> che contiene la proporzione <span class="math inline">\(1 - \alpha\)</span> della massa di probabilità della funzione a posteriori:</p>
<p><span class="math display" id="eq:credibint">\[\begin{equation}
p(\Theta \in I_{\alpha} \mid y) = 1 - \alpha.
\tag{9.1}
\end{equation}\]</span></p>
<p>L’intervallo di credibilità ha lo scopo di esprimere il nostro grado di incertezza riguardo la stima del parametro. Se il parametro <span class="math inline">\(\theta\)</span> è multidimensionale, si parla invece di “regione di credibilità”.</p>
<p>La condizione <a href="chapter-sintesi-distr-post.html#eq:credibint">(9.1)</a> non determina un unico intervallo di
credibilità al <span class="math inline">\((1 - \alpha) \cdot 100\%\)</span>. In realtà esiste un numero
infinito di tali intervalli. Ciò significa che dobbiamo definire alcune
condizioni aggiuntive per la scelta dell’intervallo di credibilità.
Esaminiamo due delle condizioni aggiuntive più comuni.</p>
<div id="intervallo-di-credibilità-a-code-uguali" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Intervallo di credibilità a code uguali<a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità-a-code-uguali" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un intervallo di credibilità <em>a code uguali</em> a livello <span class="math inline">\(\alpha\)</span> è un intervallo</p>
<p><span class="math display">\[
I_{\alpha} = [q_{\alpha/2}, 1 - q_{\alpha/2}],
\]</span></p>
<p>dove <span class="math inline">\(q_z\)</span> è un quantile <span class="math inline">\(z\)</span> della distribuzione a posteriori. Per esempio, l’intervallo di credibilità a code uguali al 95% è un intervallo</p>
<p><span class="math display">\[
I_{0.05} = [q_{0.025}, q_{0.975}]
\]</span></p>
<p>che lascia il 2.5% della massa di densità a posteriori in ciascuna coda.</p>
</div>
<div id="intervallo-di-credibilità-a-densità-a-posteriori-più-alta" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Intervallo di credibilità a densità a posteriori più alta<a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità-a-densità-a-posteriori-più-alta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nell’intervallo di credibilità a code uguali alcuni valori del parametro che sono inclusi nell’intervallo possono avere una credibilità a posteriori più bassa rispetto a quelli esterni all’intervallo. L’intrevallo di credibilità <em>a densità a posteriori più alta</em> (in inglese <em>High Posterior Density Interval</em>, HPD) è invece costruito in modo tale da assicurare di includere nell’intervallo tutti i valori <span class="math inline">\(\theta\)</span> che sono a posteriori maggiormente credibili. Graficamente questo intervallo può essere ricavato tracciando una linea orizzontale sulla rappresentazione della distribuzione a posteriori e regolando l’altezza della linea in modo tale che l’area sottesa alla curva sia pari a <span class="math inline">\(1 - \alpha\)</span>. Questo tipo di intervallo è il più stretto possibile, tra tutti i possibili intervalli di credibilità allo stesso livello di fiducia. Se la distribuzione a posteriori è simmetrica unimodale, l’intervallo di credibilità a densità a posteriori più alta corrisponde all’intervallo di credibilità a code uguali.</p>
</div>
<div id="interpretazione" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Interpretazione<a href="chapter-sintesi-distr-post.html#interpretazione" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>L’interpretazione dell’intervallo di credibilità è molto intuitiva:
l’intervallo di credibilità è un intervallo di valori all’interno del
quale cade il valore del parametro incognito con un particolare livello
di probabilità soggettiva. Possiamo dire che, dopo aver visto i dati
crediamo, con un determinato livello di probabilità soggettiva, che il
valore del parametro (ad esempio, la dimensione dell’effetto di un
trattamento) abbia un valore compreso all’interno dell’intervallo che è
stato calcolato, laddove per probabilità soggettiva intendiamo “il grado di fiducia che lo sperimentatore ripone nel verificarsi di un evento”. Gli intervalli di credibilità si calcolano con un software.</p>
</div>
</div>
<div id="un-esempio-concreto" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Un esempio concreto<a href="chapter-sintesi-distr-post.html#un-esempio-concreto" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Per fare un esempio pratico, consideriamo nuovamente i valori del BDI-II dei 30 soggetti clinici di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="chapter-sintesi-distr-post.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(<span class="st">&quot;bayesrules&quot;</span>)) </span>
<span id="cb141-2"><a href="chapter-sintesi-distr-post.html#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="chapter-sintesi-distr-post.html#cb141-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb141-4"><a href="chapter-sintesi-distr-post.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">26</span>, <span class="dv">35</span>, <span class="dv">30</span>, <span class="dv">25</span>, <span class="dv">44</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="dv">43</span>, <span class="dv">22</span>, <span class="dv">43</span>, </span>
<span id="cb141-5"><a href="chapter-sintesi-distr-post.html#cb141-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">24</span>, <span class="dv">19</span>, <span class="dv">39</span>, <span class="dv">31</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">31</span>, </span>
<span id="cb141-6"><a href="chapter-sintesi-distr-post.html#cb141-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">41</span>, <span class="dv">36</span>, <span class="dv">26</span>, <span class="dv">35</span>, <span class="dv">33</span>, <span class="dv">28</span>, <span class="dv">27</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">22</span>)</span>
<span id="cb141-7"><a href="chapter-sintesi-distr-post.html#cb141-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Un valore BDI-II <span class="math inline">\(\geq 30\)</span> indica la presenza di un livello “grave” di depressione. Nel campione clinico di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>,</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="chapter-sintesi-distr-post.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(df<span class="sc">$</span>y <span class="sc">&gt;</span> <span class="dv">29</span>)</span>
<span id="cb142-2"><a href="chapter-sintesi-distr-post.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 17</span></span></code></pre></div>
<p>17 pazienti su 30 manifestano un livello grave di depressione.</p>
<p>Supponiamo di volere stimare la distribuzione a posteriori della probabilità <span class="math inline">\(\theta\)</span> di depressione “grave” nei pazienti clinici, così come viene misurata dal test BDI-II, imponendo su <span class="math inline">\(\theta\)</span> una distribuzione a priori <span class="math inline">\(\mbox{Beta}(8, 2)\)</span>.</p>
<p>Sappiamo che il modello Beta-Binomiale può essere espresso nella forma seguente:</p>
<p><span class="math display">\[\begin{align}
Y | \theta &amp; \sim \mbox{Bin}(30, \theta) \notag\\
\theta &amp; \sim \mbox{Beta}(8, 2) \notag
\end{align}\]</span></p>
<p>con una corrispondente distribuzione a posteriori <span class="math inline">\(\mbox{Beta}(25, 15)\)</span>:</p>
<p><span class="math display" id="eq:post-beta-25-15">\[\begin{equation}
f(\theta | y = 17) = \frac{\Gamma(25 + 15)}{\Gamma(25)\Gamma(15)}\theta^{25-1} (1-\theta)^{15-1} \;\; \text{ for } \theta \in [0,1] \; .
\tag{9.2}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="chapter-sintesi-distr-post.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_beta_binomial</span>(<span class="at">alpha =</span> <span class="dv">8</span>, <span class="at">beta =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">17</span>, <span class="at">n =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-139-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="stime-puntuali-della-distribuzione-a-posteriori" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Stime puntuali della distribuzione a posteriori<a href="chapter-sintesi-distr-post.html#stime-puntuali-della-distribuzione-a-posteriori" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una volta trovata l’intera distribuzione a posteriori, quale valore di
sintesi è necessario riportare? Questa sembra una domanda innocente, ma
in realtà è una domanda a cui è difficile rispondere. La stima bayesiana dei parametri è fornita dall’intera distribuzione a posteriori, che non è un singolo numero, ma una funzione che mappa ciascun valore del parametro ad un valore di plausibilità. Quindi non è necessario scegliere una stima puntuale. In linea di principio, una stima puntuale non è quasi mai necessaria ed è spesso dannosa in quanto comporta una perdita di informazioni.</p>
<p>Tuttavia talvolta una tale sintesi è richiesta. Diverse risposte sono allora possibili. La media della distribuzione a posteriori per <span class="math inline">\(\theta\)</span> è</p>
<p><span class="math display">\[
\E(\pi \mid y = 17) = \frac{\alpha}{\alpha + \beta} = \frac{25}{25+15} = 0.625.
\]</span></p>
<p>Una stima del massimo della probabilità a posteriori, o brevemente massimo a posteriori, MAP (da <em>maximum a posteriori probability</em>), è la moda della distribuzione a posteriori. Nel caso presente, una stima del MAP può essere ottenuta nel modo seguente:</p>
<p><span class="math display">\[
\Mo(\pi \mid y = 17) = \frac{\alpha-1}{\alpha + \beta-2} = \frac{25-1}{25+15-2} = 0.6316.
\]</span></p>
<p>Gli stessi risultati si ottiengono usando la chiamata a <code>bayesrules::summarize_beta_binomial()</code>:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="chapter-sintesi-distr-post.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_beta_binomial</span>(<span class="at">alpha =</span> <span class="dv">8</span>, <span class="at">beta =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">17</span>, <span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb144-2"><a href="chapter-sintesi-distr-post.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       model alpha beta  mean      mode         var        sd</span></span>
<span id="cb144-3"><a href="chapter-sintesi-distr-post.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     prior     8    2 0.800 0.8750000 0.014545455 0.1206045</span></span>
<span id="cb144-4"><a href="chapter-sintesi-distr-post.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 posterior    25   15 0.625 0.6315789 0.005716463 0.0756073</span></span></code></pre></div>
<p>La mediana si ottiene con</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="chapter-sintesi-distr-post.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(.<span class="dv">5</span>, <span class="at">shape1 =</span> <span class="dv">25</span>, <span class="at">shape2 =</span> <span class="dv">15</span>)</span>
<span id="cb145-2"><a href="chapter-sintesi-distr-post.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.6271031</span></span></code></pre></div>
</div>
<div id="intervallo-di-credibilità-1" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Intervallo di credibilità<a href="chapter-sintesi-distr-post.html#intervallo-di-credibilità-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>È più comune sintetizzare la distribuzione a posteriori mediante l’intervallo di credibilità. Per esempio, l’intervallo di credibilità a code uguali al 95%</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="chapter-sintesi-distr-post.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_beta_ci</span>(<span class="at">alpha =</span> <span class="dv">25</span>, <span class="at">beta =</span> <span class="dv">15</span>, <span class="at">ci_level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-142-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>è dato dalla chiamata</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="chapter-sintesi-distr-post.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="dv">25</span>, <span class="dv">15</span>)</span>
<span id="cb147-2"><a href="chapter-sintesi-distr-post.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4717951 0.7663607</span></span></code></pre></div>
<p>Il calcolo precedente evidenzia l’interpretazione intuitiva dell’intervallo di credibilità. Tale intervallo, infatti, può essere interpretato come la probabilità che <span class="math inline">\(\theta\)</span> assuma valori compresi tra 0.472 e 0.766:</p>
<p><span class="math display">\[
P(\theta \in (0.472, 0.766) | Y = 17) = \int_{0.472}^{0.766} f(\theta \mid y=17) d\theta = 0.95,
\]</span></p>
<p>ovvero</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="chapter-sintesi-distr-post.html#cb148-1" aria-hidden="true" tabindex="-1"></a>postFun <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb148-2"><a href="chapter-sintesi-distr-post.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gamma</span>(<span class="dv">25</span> <span class="sc">+</span> <span class="dv">15</span>) <span class="sc">/</span> </span>
<span id="cb148-3"><a href="chapter-sintesi-distr-post.html#cb148-3" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">gamma</span>(<span class="dv">25</span>) <span class="sc">*</span> <span class="fu">gamma</span>(<span class="dv">15</span>)) <span class="sc">*</span> theta<span class="sc">^</span><span class="dv">24</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span><span class="dv">14</span></span>
<span id="cb148-4"><a href="chapter-sintesi-distr-post.html#cb148-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-5"><a href="chapter-sintesi-distr-post.html#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(</span>
<span id="cb148-6"><a href="chapter-sintesi-distr-post.html#cb148-6" aria-hidden="true" tabindex="-1"></a>  postFun, </span>
<span id="cb148-7"><a href="chapter-sintesi-distr-post.html#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fl">0.4717951</span>, </span>
<span id="cb148-8"><a href="chapter-sintesi-distr-post.html#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fl">0.7663607</span></span>
<span id="cb148-9"><a href="chapter-sintesi-distr-post.html#cb148-9" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>value</span>
<span id="cb148-10"><a href="chapter-sintesi-distr-post.html#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
<p>Possiamo costruire diversi intervalli di credibilità a code equivalenti. Ad esempio, l’intervallo di credibilità compreso tra il 25-esimo e il 75-esimo percentile è</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="chapter-sintesi-distr-post.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="dv">25</span>, <span class="dv">15</span>)</span>
<span id="cb149-2"><a href="chapter-sintesi-distr-post.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5743878 0.6778673</span></span></code></pre></div>
<p>ovvero, abbiamo una certezza a posteriori del 50% che la probabilità di depressione grave tra i pazienti clinici sia un valore compreso tra 0.57 e 0.68.</p>
<p>Non esiste un livello credibile “corretto”. I ricercatori, utilizzano vari livelli, ad esempio 50%, 80% o 95%, a seconda del contesto dell’analisi. Ciascuno di questi intervalli fornisce un’immagine diversa della nostra comprensione della distribuzione a posteriori del parametro di interesse.</p>
<p>Non è inoltre necessario riportare l’intervallo di credibilità a code uguali. Se la distribuzione a posteriori è fortemente asimmetrica è più sensato riportare l’intervallo di credibilità a densità a posteriori più alta.
L’intervallo HPD risulta più semplice da determinare quando la distribuzione a posteriori viene approssimata con il metodo MCMC.</p>
</div>
<div id="probabilità-della-distribuzione-a-posteriori" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Probabilità della distribuzione a posteriori<a href="chapter-sintesi-distr-post.html#probabilità-della-distribuzione-a-posteriori" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il test di ipotesi è un compito comune dell’analisi della distribuzione a posteriori (si veda anche il Capitolo <a href="ch-distr-coniugate.html#ch-distr-coniugate">4</a>). Supponiamo che si voglia conoscere la probabilità a posteriori che <span class="math inline">\(\theta\)</span> sia superiore a 0.5. Per sapere quanto credibile sia l’evento <span class="math inline">\(\theta &gt; 0.5\)</span> possiamo calcolare il seguente integrale:</p>
<p><span class="math display">\[
P(\theta &gt; 0.5 \; \mid \; y = 17) = \int_{0.5}^{1}f(\theta \mid y=17)d\theta \;,
\]</span></p>
<p>dove <span class="math inline">\(f(\cdot)\)</span> è la distribuzione <span class="math inline">\(\mbox{\Beta}(25, 15)\)</span>:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="chapter-sintesi-distr-post.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">25</span>, <span class="at">shape2 =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb150-2"><a href="chapter-sintesi-distr-post.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9459355</span></span></code></pre></div>
<p>il che è equivalente a:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="chapter-sintesi-distr-post.html#cb151-1" aria-hidden="true" tabindex="-1"></a>postFun <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb151-2"><a href="chapter-sintesi-distr-post.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gamma</span>(<span class="dv">25</span> <span class="sc">+</span> <span class="dv">15</span>) <span class="sc">/</span> (<span class="fu">gamma</span>(<span class="dv">25</span>) <span class="sc">*</span> <span class="fu">gamma</span>(<span class="dv">15</span>)) <span class="sc">*</span> theta<span class="sc">^</span><span class="dv">24</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span><span class="dv">14</span></span>
<span id="cb151-3"><a href="chapter-sintesi-distr-post.html#cb151-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-4"><a href="chapter-sintesi-distr-post.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(</span>
<span id="cb151-5"><a href="chapter-sintesi-distr-post.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  postFun, </span>
<span id="cb151-6"><a href="chapter-sintesi-distr-post.html#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fl">0.5</span>, </span>
<span id="cb151-7"><a href="chapter-sintesi-distr-post.html#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="dv">1</span></span>
<span id="cb151-8"><a href="chapter-sintesi-distr-post.html#cb151-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>value</span>
<span id="cb151-9"><a href="chapter-sintesi-distr-post.html#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9459355</span></span></code></pre></div>
<p>È anche possibile formulare un test di ipotesi contrastando due ipotesi contrapposte. Per esempio, <span class="math inline">\(H_1: \theta \geq 0.5\)</span> e <span class="math inline">\(H_2: \theta &lt; 0.5\)</span>. Ciò consente di calcolare l’<em>odds a posteriori</em> di <span class="math inline">\(\theta &gt; 0.5\)</span>:</p>
<p><span class="math display">\[\begin{equation}
\text{poterior odds} = \frac{H_1 \mid y = 17}{H_2 \mid y = 17}
\end{equation}\]</span></p>
<p>ovvero</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="chapter-sintesi-distr-post.html#cb152-1" aria-hidden="true" tabindex="-1"></a>posterior_odds <span class="ot">&lt;-</span> </span>
<span id="cb152-2"><a href="chapter-sintesi-distr-post.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">25</span>, <span class="at">shape2 =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb152-3"><a href="chapter-sintesi-distr-post.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">25</span>, <span class="at">shape2 =</span> <span class="dv">15</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb152-4"><a href="chapter-sintesi-distr-post.html#cb152-4" aria-hidden="true" tabindex="-1"></a>posterior_odds</span>
<span id="cb152-5"><a href="chapter-sintesi-distr-post.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 17.49642</span></span></code></pre></div>
<p>L’odds a posteriori rappresenta l’aggiornamento delle nostre credenze dopo avere osservato <span class="math inline">\(y = 17\)</span> in <span class="math inline">\(n = 30\)</span>. L’odds a priori di <span class="math inline">\(\theta &gt; 0.5\)</span> era:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="chapter-sintesi-distr-post.html#cb153-1" aria-hidden="true" tabindex="-1"></a>prior_odds <span class="ot">&lt;-</span> </span>
<span id="cb153-2"><a href="chapter-sintesi-distr-post.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb153-3"><a href="chapter-sintesi-distr-post.html#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">8</span>, <span class="at">shape2 =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb153-4"><a href="chapter-sintesi-distr-post.html#cb153-4" aria-hidden="true" tabindex="-1"></a>prior_odds</span>
<span id="cb153-5"><a href="chapter-sintesi-distr-post.html#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 50.2</span></span></code></pre></div>
<p>Il <em>fattore di Bayes</em> (<em>Bayes Factor</em>; BF) confronta gli odds a posteriori con gli odds a priori e quindi fornisce informazioni su quanto sia mutata la nostra comprensione relativa a <span class="math inline">\(\theta\)</span> dopo avere osservato i nostri dati del campione:</p>
<p><span class="math display">\[
\text{BF} = \frac{\text{odds a posteriori}}{\text{odds a priori}}.
\]</span></p>
<p>Nel caso presente abbiamo</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="chapter-sintesi-distr-post.html#cb154-1" aria-hidden="true" tabindex="-1"></a>BF <span class="ot">&lt;-</span> posterior_odds <span class="sc">/</span> prior_odds</span>
<span id="cb154-2"><a href="chapter-sintesi-distr-post.html#cb154-2" aria-hidden="true" tabindex="-1"></a>BF</span>
<span id="cb154-3"><a href="chapter-sintesi-distr-post.html#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3485343</span></span></code></pre></div>
<p>Quindi, dopo avere osservato i dati, gli odds a posteriori della nostra ipotesi a proposito di <span class="math inline">\(\theta\)</span> sono pari a solo il 34% degli odds a priori.</p>
<p>Per fare un altro esempio, consideriamo invece il caso in cui le credenze a priori rivelano una credenza diametralmente opposta rispetto a <span class="math inline">\(\theta\)</span> che nel caso considerato in precedenza, ovvero <span class="math inline">\(\mbox{Beta}(2, 8)\)</span>. In questo secondo caso, la distribuzione a posteriori diventa</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="chapter-sintesi-distr-post.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_beta_binomial</span>(<span class="at">alpha =</span> <span class="dv">2</span>, <span class="at">beta =</span> <span class="dv">8</span>, <span class="at">y =</span> <span class="dv">17</span>, <span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb155-2"><a href="chapter-sintesi-distr-post.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       model alpha beta  mean      mode         var         sd</span></span>
<span id="cb155-3"><a href="chapter-sintesi-distr-post.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     prior     2    8 0.200 0.1250000 0.014545455 0.12060454</span></span>
<span id="cb155-4"><a href="chapter-sintesi-distr-post.html#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 posterior    19   21 0.475 0.4736842 0.006082317 0.07798921</span></span></code></pre></div>
<p>e il BF è</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="chapter-sintesi-distr-post.html#cb156-1" aria-hidden="true" tabindex="-1"></a>posterior_odds <span class="ot">&lt;-</span> </span>
<span id="cb156-2"><a href="chapter-sintesi-distr-post.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">19</span>, <span class="at">shape2 =</span> <span class="dv">21</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb156-3"><a href="chapter-sintesi-distr-post.html#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">19</span>, <span class="at">shape2 =</span> <span class="dv">21</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-4"><a href="chapter-sintesi-distr-post.html#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="chapter-sintesi-distr-post.html#cb156-5" aria-hidden="true" tabindex="-1"></a>prior_odds <span class="ot">&lt;-</span> </span>
<span id="cb156-6"><a href="chapter-sintesi-distr-post.html#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">8</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">/</span></span>
<span id="cb156-7"><a href="chapter-sintesi-distr-post.html#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">8</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-8"><a href="chapter-sintesi-distr-post.html#cb156-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-9"><a href="chapter-sintesi-distr-post.html#cb156-9" aria-hidden="true" tabindex="-1"></a>BF <span class="ot">&lt;-</span> posterior_odds <span class="sc">/</span> prior_odds</span>
<span id="cb156-10"><a href="chapter-sintesi-distr-post.html#cb156-10" aria-hidden="true" tabindex="-1"></a>BF</span>
<span id="cb156-11"><a href="chapter-sintesi-distr-post.html#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 30.07239</span></span></code></pre></div>
<p>In alre parole, in questo secondo esempio gli odds a posteriori della nostra ipotesi a proposito di <span class="math inline">\(\theta\)</span> sono aumentati di 30 volte rispetto agli odds a priori.</p>
<p>In generale, in un test di ipotesi che contrappone un’ipotesi sostantiva <span class="math inline">\(H_a\)</span> ad un’ipotesi nulla <span class="math inline">\(H_0\)</span> il BF è un rapporto di odds per l’ipotesi sostantiva:</p>
<p><span class="math display">\[
\text{Bayes Factor}
= \frac{\text{posterior odds}}{\text{prior odds}}
= \frac{P(H_a \mid Y) / P(H_0 \mid Y)}{P(H_a) / P(H_0)}
\; .
\]</span></p>
<p>Essendo un rapporto, il BF deve esere valutato rispetto al valore di 1. Ci sono tre possibilità:</p>
<ul>
<li>BF = 1: La credibilità di <span class="math inline">\(H_a\)</span> non è cambiata dopo avere osservato i dati.</li>
<li>BF &gt; 1: La credibilità di <span class="math inline">\(H_a\)</span> è aumentata dopo avere osservato i dati. Quindi maggiore è BF, più convincente risulta l’evidenza per <span class="math inline">\(H_a\)</span>.</li>
<li>BF &lt; 1: La credibilità di <span class="math inline">\(H_a\)</span> è diminuita dopo avere osservato i dati.</li>
</ul>
<p>Non ci sono delle soglie universalmente riconosciute per interpretare il BF. Per esempio, <span class="citation">Lee and Wagenmakers (<a href="#ref-lee2014bayesian" role="doc-biblioref">2014</a>)</span> propongono il seguente schema:</p>
<table>
<thead>
<tr class="header">
<th align="right">BF</th>
<th align="left">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">&gt; 100</td>
<td align="left">Extreme evidence for <span class="math inline">\(H_a\)</span></td>
</tr>
<tr class="even">
<td align="right">30 - 100</td>
<td align="left">Very strong evidence for <span class="math inline">\(H_a\)</span></td>
</tr>
<tr class="odd">
<td align="right">10 - 30</td>
<td align="left">Strong evidence for <span class="math inline">\(H_a\)</span></td>
</tr>
<tr class="even">
<td align="right">3 - 10</td>
<td align="left">Moderate evidence for <span class="math inline">\(H_a\)</span></td>
</tr>
<tr class="odd">
<td align="right">1 - 3</td>
<td align="left">Anecdotal evidence for <span class="math inline">\(H_a\)</span></td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">No evidence</td>
</tr>
<tr class="odd">
<td align="right">1/3 - 1</td>
<td align="left">Anecdotal evidence for <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="even">
<td align="right">1/10 - 1/3</td>
<td align="left">Moderate evidence for <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="odd">
<td align="right">1/30 - 1/10</td>
<td align="left">Strong evidence for <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="even">
<td align="right">1/100 - 1/30</td>
<td align="left">Very strong evidence for <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="odd">
<td align="right">&lt; 1/100</td>
<td align="left">Extreme evidence for <span class="math inline">\(H_0\)</span></td>
</tr>
</tbody>
</table>
<p>Tuttavia, è importante notare che l’opinione maggiormente diffusa nella comunità scientifica sia quella che incoraggia a non trarre conclusioni rigide dai dati utilizzando dei criteri fissati una volta per tutte. Pertanto, non esiste una soglia univoca per il BF che consente di classificare le ipotesi dei ricercatori nelle due categorie “vero” o “falso”. Invece, è più utile adottare una pratica più flessibile capace di tenere in considerazione il contesto e le potenziali implicazioni di ogni singolo test di ipotesi. Inoltre, è stato molte volte ripetuto che la distribuzione a posteriori è molto più informativa di una decisione binaria: la rappresentazione di tutta la distribuzione a posteriori fornisce una misura olistica del nostro livello di incertezza riguardo all’affermazione (il parametro, ovvero l’ipotesi) che viene valutata.</p>
</div>
</div>
<div id="la-funzione-di-perdita-attesa" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> La funzione di perdita attesa<a href="chapter-sintesi-distr-post.html#la-funzione-di-perdita-attesa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un modo razionale per giungere ad una decisione statistica utilizzando l’intera distribuzione a posteriori è quello di usare la <em>funzione di perdita</em> (<em>loss function</em>). La funzione di perdita è concetto nella teoria delle decisioni statistiche che consente di quantificare il costo derivante dalla decisione di scegliere quale stima del parametro il valore <span class="math inline">\(\theta_0\)</span> quando esso in realtà ha il valore <span class="math inline">\(\theta\)</span>.</p>
<p>Per chiarire che cosa si intende per funzione di perdita, esaminiamo qui un semplice esempio nel quale vengono considerati due soli valori di probabilità per l’evento target, anziché l’intera distribuzione a posteriori <span class="citation">(il codice è ricavato da <a href="#ref-schmettow2021new" role="doc-biblioref">Schmettow 2021</a>)</span>.</p>
<p>Si consideri la scelta di prendere o meno l’ombrello nell’uscire di casa. Le previsioni del tempo sono le seguenti:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="chapter-sintesi-distr-post.html#cb157-1" aria-hidden="true" tabindex="-1"></a>Risultato <span class="ot">&lt;-</span></span>
<span id="cb157-2"><a href="chapter-sintesi-distr-post.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb157-3"><a href="chapter-sintesi-distr-post.html#cb157-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">risultato =</span> <span class="fu">c</span>(<span class="st">&quot;piove&quot;</span>, <span class="st">&quot;non piove&quot;</span>),</span>
<span id="cb157-4"><a href="chapter-sintesi-distr-post.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)</span>
<span id="cb157-5"><a href="chapter-sintesi-distr-post.html#cb157-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb157-6"><a href="chapter-sintesi-distr-post.html#cb157-6" aria-hidden="true" tabindex="-1"></a>Risultato</span>
<span id="cb157-7"><a href="chapter-sintesi-distr-post.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb157-8"><a href="chapter-sintesi-distr-post.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   risultato  prob</span></span>
<span id="cb157-9"><a href="chapter-sintesi-distr-post.html#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span id="cb157-10"><a href="chapter-sintesi-distr-post.html#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 piove       0.6</span></span>
<span id="cb157-11"><a href="chapter-sintesi-distr-post.html#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 non piove   0.4</span></span></code></pre></div>
<p>Le azioni possibili sono: prendo / non prendo l’ombrello:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="chapter-sintesi-distr-post.html#cb158-1" aria-hidden="true" tabindex="-1"></a>Azione <span class="ot">&lt;-</span></span>
<span id="cb158-2"><a href="chapter-sintesi-distr-post.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">azione =</span> <span class="fu">c</span>(<span class="st">&quot;prendo l&#39;ombrello&quot;</span>, <span class="st">&quot;non prendo l&#39;ombrello&quot;</span>))</span>
<span id="cb158-3"><a href="chapter-sintesi-distr-post.html#cb158-3" aria-hidden="true" tabindex="-1"></a>Azione</span>
<span id="cb158-4"><a href="chapter-sintesi-distr-post.html#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 1</span></span>
<span id="cb158-5"><a href="chapter-sintesi-distr-post.html#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   azione               </span></span>
<span id="cb158-6"><a href="chapter-sintesi-distr-post.html#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                </span></span>
<span id="cb158-7"><a href="chapter-sintesi-distr-post.html#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 prendo l&#39;ombrello    </span></span>
<span id="cb158-8"><a href="chapter-sintesi-distr-post.html#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 non prendo l&#39;ombrello</span></span></code></pre></div>
<p>Assegniamo un costo massimo (4) alla conseguenza peggiore (“non prendo l’ombrello e piove”) e uno minimo (0) alla conseguenza migliore (“non prendo l’ombrello e non piove”):</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="chapter-sintesi-distr-post.html#cb159-1" aria-hidden="true" tabindex="-1"></a>Costi <span class="ot">&lt;-</span></span>
<span id="cb159-2"><a href="chapter-sintesi-distr-post.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(</span>
<span id="cb159-3"><a href="chapter-sintesi-distr-post.html#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">azione =</span> Azione<span class="sc">$</span>azione,</span>
<span id="cb159-4"><a href="chapter-sintesi-distr-post.html#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">risultato =</span> Risultato<span class="sc">$</span>risultato</span>
<span id="cb159-5"><a href="chapter-sintesi-distr-post.html#cb159-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb159-6"><a href="chapter-sintesi-distr-post.html#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(Risultato) <span class="sc">%&gt;%</span></span>
<span id="cb159-7"><a href="chapter-sintesi-distr-post.html#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">costo =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb159-8"><a href="chapter-sintesi-distr-post.html#cb159-8" aria-hidden="true" tabindex="-1"></a>Costi</span>
<span id="cb159-9"><a href="chapter-sintesi-distr-post.html#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  azione risultato prob costo</span></span>
<span id="cb159-10"><a href="chapter-sintesi-distr-post.html#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     prendo l&#39;ombrello     piove  0.6     2</span></span>
<span id="cb159-11"><a href="chapter-sintesi-distr-post.html#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 non prendo l&#39;ombrello     piove  0.6     4</span></span>
<span id="cb159-12"><a href="chapter-sintesi-distr-post.html#cb159-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     prendo l&#39;ombrello non piove  0.4     2</span></span>
<span id="cb159-13"><a href="chapter-sintesi-distr-post.html#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 non prendo l&#39;ombrello non piove  0.4     0</span></span></code></pre></div>
<p>Calcoliamo ora il costo atteso delle due azioni tenuto conto delle probabilità che si verifichi l’uno o l’altro stato del mondo (ricordiamo che piove/non piove hanno una probabilità rispettivamente del 40% e del 60%), ovvero ponderiamo il costo di ogni azione con la probabilità che si verifichi l’evento corrispondente:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="chapter-sintesi-distr-post.html#cb160-1" aria-hidden="true" tabindex="-1"></a>Util <span class="ot">&lt;-</span></span>
<span id="cb160-2"><a href="chapter-sintesi-distr-post.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  Costi <span class="sc">%&gt;%</span></span>
<span id="cb160-3"><a href="chapter-sintesi-distr-post.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">costo_condizionato =</span> prob <span class="sc">*</span> costo) <span class="sc">%&gt;%</span></span>
<span id="cb160-4"><a href="chapter-sintesi-distr-post.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(azione) <span class="sc">%&gt;%</span></span>
<span id="cb160-5"><a href="chapter-sintesi-distr-post.html#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">costo_atteso =</span> <span class="fu">sum</span>(costo_condizionato))</span>
<span id="cb160-6"><a href="chapter-sintesi-distr-post.html#cb160-6" aria-hidden="true" tabindex="-1"></a>Util</span>
<span id="cb160-7"><a href="chapter-sintesi-distr-post.html#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb160-8"><a href="chapter-sintesi-distr-post.html#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   azione                costo_atteso</span></span>
<span id="cb160-9"><a href="chapter-sintesi-distr-post.html#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;                        &lt;dbl&gt;</span></span>
<span id="cb160-10"><a href="chapter-sintesi-distr-post.html#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 prendo l&#39;ombrello              2  </span></span>
<span id="cb160-11"><a href="chapter-sintesi-distr-post.html#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 non prendo l&#39;ombrello          2.4</span></span></code></pre></div>
<p>La regola di minimizzazione dei costi induce a scegliere l’alternativa che comporta il valore più basso: nel nostro esempio “prendere l’ombrello”.</p>
<p>La stessa logica dell’esempio può essere usata anche nel momento in cui, anziché avere solo due valori per la probabilità dello stato del mondo in questione (per esempio, pioverà / non pioverà), utilizziamo l’intera distribuzione a posteriori (per esempio, quella relativa alla previsione di pioggia). Concludiamo questi brevi accenni relativi alla funzione di perdita con una considerazione di <span class="citation">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span> il quale nota che, anche se gli statistici e i teorici dei giochi sono da tempo interessati alle funzioni di perdita e alle relazioni che intercorrono tra esse e l’inferenza bayesiana, i ricercatori non le usano quasi mai in modo esplicito.</p>
</div>
<div id="commenti-e-considerazioni-finali-6" class="section level2 unnumbered hasAnchor">
<h2>Commenti e considerazioni finali<a href="chapter-sintesi-distr-post.html#commenti-e-considerazioni-finali-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Questo capitolo introduce le procedure di base per la manipolazione
della distribuzione a posteriori. Lo strumento fondamentale che è stato
utilizzato è quello fornito dai campioni di valori del parametro che vengono estratti dalla distribuzione a posteriori. Lavorare con campioni di valori del parametro estratti dalla distribuzione a posteriori trasforma un problema di calcolo integrale in un problema di riepilogo dei dati. Abbiamo visto le procedure maggiormente usate che consentono di utilizzare i campioni a
posteriori per produrre indici di sintesi della distribuzione a
posteriori: gli intervalli di credibilità e le stime puntuali.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lee2014bayesian" class="csl-entry">
Lee, Michael D, and Eric-Jan Wagenmakers. 2014. <em>Bayesian Cognitive Modeling: A Practical Course</em>. Cambridge university press.
</div>
<div id="ref-McElreath_rethinking" class="csl-entry">
McElreath, Richard. 2020. <em>Statistical Rethinking: <span>A</span> <span>Bayesian</span> Course with Examples in <span>R</span> and <span>Stan</span></em>. 2nd Edition. Boca Raton, Florida: CRC Press.
</div>
<div id="ref-schmettow2021new" class="csl-entry">
Schmettow, Martin. 2021. <em>New Statistics for Design Researchers</em>. Springer.
</div>
<div id="ref-zetschefuture2019" class="csl-entry">
Zetsche, Ulrike, Paul-Christian Bürkner, and Babette Renneberg. 2019. <span>“Future Expectations in Clinical Depression: <span>Biased</span> or Realistic?”</span> <em>Journal of Abnormal Psychology</em> 128 (7): 678–88.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="diagn-markov-chains.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-prediction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/045_summarize_posterior.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
