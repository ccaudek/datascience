<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 31 Modello gerarchico | Data Science per psicologi</title>
  <meta name="description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 31 Modello gerarchico | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="github-repo" content="ccaudek/datascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 31 Modello gerarchico | Data Science per psicologi" />
  
  <meta name="twitter:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2022-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-anova.html"/>
<link rel="next" href="ch-hier-sim.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Benvenuti</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#la-psicologia-e-la-data-science"><i class="fa fa-check"></i>La psicologia e la Data Science</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#come-studiare"><i class="fa fa-check"></i>Come studiare</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Nozioni preliminari</b></span></li>
<li class="chapter" data-level="1" data-path="ch-key-notions.html"><a href="ch-key-notions.html"><i class="fa fa-check"></i><b>1</b> Concetti chiave</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-key-notions.html"><a href="ch-key-notions.html#popolazioni-e-campioni"><i class="fa fa-check"></i><b>1.1</b> Popolazioni e campioni</a></li>
<li class="chapter" data-level="1.2" data-path="ch-key-notions.html"><a href="ch-key-notions.html#variabili-e-costanti"><i class="fa fa-check"></i><b>1.2</b> Variabili e costanti</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ch-key-notions.html"><a href="ch-key-notions.html#variabili-casuali"><i class="fa fa-check"></i><b>1.2.1</b> Variabili casuali</a></li>
<li class="chapter" data-level="1.2.2" data-path="ch-key-notions.html"><a href="ch-key-notions.html#variabili-indipendenti-e-variabili-dipendenti"><i class="fa fa-check"></i><b>1.2.2</b> Variabili indipendenti e variabili dipendenti</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch-key-notions.html"><a href="ch-key-notions.html#la-matrice-dei-dati"><i class="fa fa-check"></i><b>1.2.3</b> La matrice dei dati</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch-key-notions.html"><a href="ch-key-notions.html#parametri-e-modelli"><i class="fa fa-check"></i><b>1.3</b> Parametri e modelli</a></li>
<li class="chapter" data-level="1.4" data-path="ch-key-notions.html"><a href="ch-key-notions.html#effetto"><i class="fa fa-check"></i><b>1.4</b> Effetto</a></li>
<li class="chapter" data-level="1.5" data-path="ch-key-notions.html"><a href="ch-key-notions.html#stima-e-inferenza"><i class="fa fa-check"></i><b>1.5</b> Stima e inferenza</a></li>
<li class="chapter" data-level="1.6" data-path="ch-key-notions.html"><a href="ch-key-notions.html#metodi-e-procedure-della-psicologia"><i class="fa fa-check"></i><b>1.6</b> Metodi e procedure della psicologia</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html"><i class="fa fa-check"></i><b>2</b> La misurazione in psicologia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#le-scale-di-misura"><i class="fa fa-check"></i><b>2.1</b> Le scale di misura</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-nominale"><i class="fa fa-check"></i><b>2.1.1</b> Scala nominale</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-ordinale"><i class="fa fa-check"></i><b>2.1.2</b> Scala ordinale</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-ad-intervalli"><i class="fa fa-check"></i><b>2.1.3</b> Scala ad intervalli</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-di-rapporti"><i class="fa fa-check"></i><b>2.1.4</b> Scala di rapporti</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#gerarchia-dei-livelli-di-scala-di-misura"><i class="fa fa-check"></i><b>2.2</b> Gerarchia dei livelli di scala di misura</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#variabili-discrete-o-continue"><i class="fa fa-check"></i><b>2.3</b> Variabili discrete o continue</a></li>
<li class="chapter" data-level="2.4" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#alcune-misure-sono-migliori-di-altre"><i class="fa fa-check"></i><b>2.4</b> Alcune misure sono migliori di altre</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#tipologie-di-errori"><i class="fa fa-check"></i><b>2.4.1</b> Tipologie di errori</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#commenti-e-considerazioni-finali"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>II Analisi esplorativa dei dati</b></span></li>
<li class="chapter" data-level="3" data-path="ch-eda.html"><a href="ch-eda.html"><i class="fa fa-check"></i><b>3</b> Variabili e distribuzioni di frequenza</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-eda.html"><a href="ch-eda.html#chapter-descript"><i class="fa fa-check"></i><b>3.1</b> Introduzione all’esplorazione dei dati</a></li>
<li class="chapter" data-level="3.2" data-path="ch-eda.html"><a href="ch-eda.html#un-excursus-storico"><i class="fa fa-check"></i><b>3.2</b> Un excursus storico</a></li>
<li class="chapter" data-level="3.3" data-path="ch-eda.html"><a href="ch-eda.html#riassumere-i-dati"><i class="fa fa-check"></i><b>3.3</b> Riassumere i dati</a></li>
<li class="chapter" data-level="3.4" data-path="ch-eda.html"><a href="ch-eda.html#i-dati-grezzi"><i class="fa fa-check"></i><b>3.4</b> I dati grezzi</a></li>
<li class="chapter" data-level="3.5" data-path="ch-eda.html"><a href="ch-eda.html#distribuzioni-di-frequenze"><i class="fa fa-check"></i><b>3.5</b> Distribuzioni di frequenze</a></li>
<li class="chapter" data-level="3.6" data-path="ch-eda.html"><a href="ch-eda.html#istogramma"><i class="fa fa-check"></i><b>3.6</b> Istogramma</a></li>
<li class="chapter" data-level="3.7" data-path="ch-eda.html"><a href="ch-eda.html#kernel-density-plot"><i class="fa fa-check"></i><b>3.7</b> Kernel density plot</a></li>
<li class="chapter" data-level="3.8" data-path="ch-eda.html"><a href="ch-eda.html#forma-di-una-distribuzione"><i class="fa fa-check"></i><b>3.8</b> Forma di una distribuzione</a></li>
<li class="chapter" data-level="3.9" data-path="ch-eda.html"><a href="ch-eda.html#indici-di-posizione"><i class="fa fa-check"></i><b>3.9</b> Indici di posizione</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="ch-eda.html"><a href="ch-eda.html#quantili"><i class="fa fa-check"></i><b>3.9.1</b> Quantili</a></li>
<li class="chapter" data-level="3.9.2" data-path="ch-eda.html"><a href="ch-eda.html#diagramma-a-scatola"><i class="fa fa-check"></i><b>3.9.2</b> Diagramma a scatola</a></li>
<li class="chapter" data-level="3.9.3" data-path="ch-eda.html"><a href="ch-eda.html#sina-plot"><i class="fa fa-check"></i><b>3.9.3</b> Sina plot</a></li>
<li class="chapter" data-level="3.9.4" data-path="ch-eda.html"><a href="ch-eda.html#leccellenza-grafica"><i class="fa fa-check"></i><b>3.9.4</b> L’eccellenza grafica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-eda.html"><a href="ch-eda.html#commenti-e-considerazioni-finali-1"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html"><i class="fa fa-check"></i><b>4</b> Indici di posizione e di scala</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-di-tendenza-centrale"><i class="fa fa-check"></i><b>4.1</b> Indici di tendenza centrale</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#media"><i class="fa fa-check"></i><b>4.1.1</b> Media</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#media-spuntata"><i class="fa fa-check"></i><b>4.1.2</b> Media spuntata</a></li>
<li class="chapter" data-level="4.1.3" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#moda-e-mediana"><i class="fa fa-check"></i><b>4.1.3</b> Moda e mediana</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-di-dispersione"><i class="fa fa-check"></i><b>4.2</b> Indici di dispersione</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-basati-sullordinamento-dei-dati"><i class="fa fa-check"></i><b>4.2.1</b> Indici basati sull’ordinamento dei dati</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#varianza"><i class="fa fa-check"></i><b>4.2.2</b> Varianza</a></li>
<li class="chapter" data-level="4.2.3" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#precisione"><i class="fa fa-check"></i><b>4.2.3</b> Precisione</a></li>
<li class="chapter" data-level="4.2.4" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#scarto-tipo"><i class="fa fa-check"></i><b>4.2.4</b> Scarto tipo</a></li>
<li class="chapter" data-level="4.2.5" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#deviazione-mediana-assoluta"><i class="fa fa-check"></i><b>4.2.5</b> Deviazione mediana assoluta</a></li>
<li class="chapter" data-level="4.2.6" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-di-variabilità-relativi"><i class="fa fa-check"></i><b>4.2.6</b> Indici di variabilità relativi</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#commenti-e-considerazioni-finali-2"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-corr.html"><a href="ch-corr.html"><i class="fa fa-check"></i><b>5</b> Le relazioni tra variabili</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-corr.html"><a href="ch-corr.html#diagramma-a-dispersione"><i class="fa fa-check"></i><b>5.1</b> Diagramma a dispersione</a></li>
<li class="chapter" data-level="5.2" data-path="ch-corr.html"><a href="ch-corr.html#covarianza"><i class="fa fa-check"></i><b>5.2</b> Covarianza</a></li>
<li class="chapter" data-level="5.3" data-path="ch-corr.html"><a href="ch-corr.html#correlazione"><i class="fa fa-check"></i><b>5.3</b> Correlazione</a></li>
<li class="chapter" data-level="5.4" data-path="ch-corr.html"><a href="ch-corr.html#correlazione-e-causazione"><i class="fa fa-check"></i><b>5.4</b> Correlazione e causazione</a></li>
<li class="chapter" data-level="5.5" data-path="ch-corr.html"><a href="ch-corr.html#usi-della-correlazione"><i class="fa fa-check"></i><b>5.5</b> Usi della correlazione</a></li>
<li class="chapter" data-level="5.6" data-path="ch-corr.html"><a href="ch-corr.html#correlazione-di-spearman"><i class="fa fa-check"></i><b>5.6</b> Correlazione di Spearman</a></li>
<li class="chapter" data-level="5.7" data-path="ch-corr.html"><a href="ch-corr.html#correlazione-nulla"><i class="fa fa-check"></i><b>5.7</b> Correlazione nulla</a></li>
<li class="chapter" data-level="" data-path="ch-corr.html"><a href="ch-corr.html#commenti-e-considerazioni-finali-3"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>III Il calcolo delle probabilità</b></span></li>
<li class="chapter" data-level="6" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html"><i class="fa fa-check"></i><b>6</b> La logica dell’incerto</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#che-cosè-la-probabilità"><i class="fa fa-check"></i><b>6.1</b> Che cos’è la probabilità?</a></li>
<li class="chapter" data-level="6.2" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#variabili-casuali-e-probabilità-di-un-evento"><i class="fa fa-check"></i><b>6.2</b> Variabili casuali e probabilità di un evento</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#eventi-e-probabilità"><i class="fa fa-check"></i><b>6.2.1</b> Eventi e probabilità</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#spazio-campione-e-risultati-possibili"><i class="fa fa-check"></i><b>6.2.2</b> Spazio campione e risultati possibili</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#variabili-casuali-1"><i class="fa fa-check"></i><b>6.3</b> Variabili casuali</a></li>
<li class="chapter" data-level="6.4" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#usare-la-simulazione-per-stimare-le-probabilità"><i class="fa fa-check"></i><b>6.4</b> Usare la simulazione per stimare le probabilità</a></li>
<li class="chapter" data-level="6.5" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#la-legge-dei-grandi-numeri"><i class="fa fa-check"></i><b>6.5</b> La legge dei grandi numeri</a></li>
<li class="chapter" data-level="6.6" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#variabili-casuali-multiple"><i class="fa fa-check"></i><b>6.6</b> Variabili casuali multiple</a></li>
<li class="chapter" data-level="6.7" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#sec:fun-mass-prob"><i class="fa fa-check"></i><b>6.7</b> Funzione di massa di probabilità</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#funzione-di-ripartizione"><i class="fa fa-check"></i><b>6.7.1</b> Funzione di ripartizione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#commenti-e-considerazioni-finali-4"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html"><i class="fa fa-check"></i><b>7</b> Probabilità condizionata</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#sec:bayes-cancer"><i class="fa fa-check"></i><b>7.1</b> Probabilità condizionata su altri eventi</a></li>
<li class="chapter" data-level="7.2" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#la-regola-moltiplicativa"><i class="fa fa-check"></i><b>7.2</b> La regola moltiplicativa</a></li>
<li class="chapter" data-level="7.3" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#lindipendendenza-stocastica"><i class="fa fa-check"></i><b>7.3</b> L’indipendendenza stocastica</a></li>
<li class="chapter" data-level="7.4" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#il-teorema-della-probabilità-totale"><i class="fa fa-check"></i><b>7.4</b> Il teorema della probabilità totale</a></li>
<li class="chapter" data-level="7.5" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#il-teorema-della-probabilità-assoluta"><i class="fa fa-check"></i><b>7.5</b> Il teorema della probabilità assoluta</a></li>
<li class="chapter" data-level="7.6" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#indipendenza-condizionale"><i class="fa fa-check"></i><b>7.6</b> Indipendenza condizionale</a></li>
<li class="chapter" data-level="" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#commenti-e-considerazioni-finali-5"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-theorem-bayes.html"><a href="ch-theorem-bayes.html"><i class="fa fa-check"></i><b>8</b> Il teorema di Bayes</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch-theorem-bayes.html"><a href="ch-theorem-bayes.html#il-teorema-di-bayes"><i class="fa fa-check"></i><b>8.1</b> Il teorema di Bayes</a></li>
<li class="chapter" data-level="" data-path="ch-theorem-bayes.html"><a href="ch-theorem-bayes.html#commenti-e-considerazioni-finali-6"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html"><i class="fa fa-check"></i><b>9</b> Probabilità congiunta</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#funzione-di-probabilità-congiunta"><i class="fa fa-check"></i><b>9.1</b> Funzione di probabilità congiunta</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#proprietà"><i class="fa fa-check"></i><b>9.1.1</b> Proprietà</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#eventi"><i class="fa fa-check"></i><b>9.1.2</b> Eventi</a></li>
<li class="chapter" data-level="9.1.3" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#sec:marg-distr-discr"><i class="fa fa-check"></i><b>9.1.3</b> Funzioni di probabilità marginali</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#sec:margin-vc-cont"><i class="fa fa-check"></i><b>9.2</b> Marginalizzazione di variabili casuali continue</a></li>
<li class="chapter" data-level="" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#commenti-e-considerazioni-finali-7"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html"><i class="fa fa-check"></i><b>10</b> La densità di probabilità</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#spinner-e-variabili-casuali-continue-uniformi"><i class="fa fa-check"></i><b>10.1</b> Spinner e variabili casuali continue uniformi</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#il-paradosso-delle-variabili-casuali-continue"><i class="fa fa-check"></i><b>10.1.1</b> Il paradosso delle variabili casuali continue</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#la-funzione-di-ripartizione-per-una-variabile-casuale-continua"><i class="fa fa-check"></i><b>10.2</b> La funzione di ripartizione per una variabile casuale continua</a></li>
<li class="chapter" data-level="10.3" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#la-distribuzione-uniforme"><i class="fa fa-check"></i><b>10.3</b> La distribuzione uniforme</a></li>
<li class="chapter" data-level="10.4" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#dagli-istogrammi-alle-densità"><i class="fa fa-check"></i><b>10.4</b> Dagli istogrammi alle densità</a></li>
<li class="chapter" data-level="10.5" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#funzione-di-densità-di-probabilità"><i class="fa fa-check"></i><b>10.5</b> Funzione di densità di probabilità</a></li>
<li class="chapter" data-level="10.6" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#la-funzione-di-ripartizione"><i class="fa fa-check"></i><b>10.6</b> La funzione di ripartizione</a></li>
<li class="chapter" data-level="10.7" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#media-e-mediana"><i class="fa fa-check"></i><b>10.7</b> Media e mediana</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html"><i class="fa fa-check"></i><b>11</b> Valore atteso e varianza</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#valore-atteso"><i class="fa fa-check"></i><b>11.1</b> Valore atteso</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#interpretazione"><i class="fa fa-check"></i><b>11.1.1</b> Interpretazione</a></li>
<li class="chapter" data-level="11.1.2" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#proprietà-del-valore-atteso"><i class="fa fa-check"></i><b>11.1.2</b> Proprietà del valore atteso</a></li>
<li class="chapter" data-level="11.1.3" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#variabili-casuali-continue"><i class="fa fa-check"></i><b>11.1.3</b> Variabili casuali continue</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#varianza-1"><i class="fa fa-check"></i><b>11.2</b> Varianza</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#formula-alternativa-per-la-varianza"><i class="fa fa-check"></i><b>11.2.1</b> Formula alternativa per la varianza</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#variabili-casuali-continue-1"><i class="fa fa-check"></i><b>11.2.2</b> Variabili casuali continue</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#deviazione-standard"><i class="fa fa-check"></i><b>11.3</b> Deviazione standard</a></li>
<li class="chapter" data-level="11.4" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#standardizzazione"><i class="fa fa-check"></i><b>11.4</b> Standardizzazione</a></li>
<li class="chapter" data-level="11.5" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#momenti-di-variabili-casuali"><i class="fa fa-check"></i><b>11.5</b> Momenti di variabili casuali</a></li>
<li class="chapter" data-level="11.6" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#covarianza-1"><i class="fa fa-check"></i><b>11.6</b> Covarianza</a></li>
<li class="chapter" data-level="11.7" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#correlazione-1"><i class="fa fa-check"></i><b>11.7</b> Correlazione</a></li>
<li class="chapter" data-level="11.8" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#proprietà-1"><i class="fa fa-check"></i><b>11.8</b> Proprietà</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#incorrelazione"><i class="fa fa-check"></i><b>11.8.1</b> Incorrelazione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#conclusioni"><i class="fa fa-check"></i>Conclusioni</a></li>
</ul></li>
<li class="part"><span><b>IV Distribuzioni teoriche di probabilità</b></span></li>
<li class="chapter" data-level="12" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html"><i class="fa fa-check"></i><b>12</b> Distribuzioni di v.c. discrete</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#una-prova-bernoulliana"><i class="fa fa-check"></i><b>12.1</b> Una prova Bernoulliana</a></li>
<li class="chapter" data-level="12.2" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#una-sequenza-di-prove-bernoulliane"><i class="fa fa-check"></i><b>12.2</b> Una sequenza di prove Bernoulliane</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#valore-atteso-e-deviazione-standard"><i class="fa fa-check"></i><b>12.2.1</b> Valore atteso e deviazione standard</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#distribuzione-di-poisson"><i class="fa fa-check"></i><b>12.3</b> Distribuzione di Poisson</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#alcune-proprietà-della-variabile-di-poisson"><i class="fa fa-check"></i><b>12.3.1</b> Alcune proprietà della variabile di Poisson</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#distribuzione-discreta-uniforme"><i class="fa fa-check"></i><b>12.4</b> Distribuzione discreta uniforme</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#usiamo-textsfr"><i class="fa fa-check"></i><b>12.4.1</b> Usiamo <span class="math inline">\(\textsf{R}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#distribuzione-beta-binomiale"><i class="fa fa-check"></i><b>12.5</b> Distribuzione beta-binomiale</a></li>
<li class="chapter" data-level="" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#commenti-e-considerazioni-finali-8"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html"><i class="fa fa-check"></i><b>13</b> Distribuzioni di v.c. continue</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-normale"><i class="fa fa-check"></i><b>13.1</b> Distribuzione Normale</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#limite-delle-distribuzioni-binomiali"><i class="fa fa-check"></i><b>13.1.1</b> Limite delle distribuzioni binomiali</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#normal-random-walk"><i class="fa fa-check"></i><b>13.2</b> La Normale prodotta con una simulazione</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#concentrazione"><i class="fa fa-check"></i><b>13.2.1</b> Concentrazione</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#funzione-di-ripartizione-1"><i class="fa fa-check"></i><b>13.2.2</b> Funzione di ripartizione</a></li>
<li class="chapter" data-level="13.2.3" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-normale-standard"><i class="fa fa-check"></i><b>13.2.3</b> Distribuzione Normale standard</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#teorema-del-limite-centrale"><i class="fa fa-check"></i><b>13.3</b> Teorema del limite centrale</a></li>
<li class="chapter" data-level="13.4" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-chi-quadrato"><i class="fa fa-check"></i><b>13.4</b> Distribuzione Chi-quadrato</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#proprietà-2"><i class="fa fa-check"></i><b>13.4.1</b> Proprietà</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-t-di-student"><i class="fa fa-check"></i><b>13.5</b> Distribuzione <span class="math inline">\(t\)</span> di Student</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#proprietà-3"><i class="fa fa-check"></i><b>13.5.1</b> Proprietà</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#funzione-beta"><i class="fa fa-check"></i><b>13.6</b> Funzione beta</a></li>
<li class="chapter" data-level="13.7" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-beta"><i class="fa fa-check"></i><b>13.7</b> Distribuzione Beta</a></li>
<li class="chapter" data-level="13.8" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-di-cauchy"><i class="fa fa-check"></i><b>13.8</b> Distribuzione di Cauchy</a></li>
<li class="chapter" data-level="13.9" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-log-normale"><i class="fa fa-check"></i><b>13.9</b> Distribuzione log-normale</a></li>
<li class="chapter" data-level="13.10" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-di-pareto"><i class="fa fa-check"></i><b>13.10</b> Distribuzione di Pareto</a></li>
<li class="chapter" data-level="" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#commenti-e-considerazioni-finali-9"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>V Inferenza bayesiana</b></span></li>
<li class="chapter" data-level="14" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html"><i class="fa fa-check"></i><b>14</b> Flusso di lavoro bayesiano</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#modellizzazione-bayesiana"><i class="fa fa-check"></i><b>14.1</b> Modellizzazione bayesiana</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#notazione"><i class="fa fa-check"></i><b>14.1.1</b> Notazione</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzioni-a-priori"><i class="fa fa-check"></i><b>14.2</b> Distribuzioni a priori</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#tipologie-di-distribuzioni-a-priori"><i class="fa fa-check"></i><b>14.2.1</b> Tipologie di distribuzioni a priori</a></li>
<li class="chapter" data-level="14.2.2" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#selezione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>14.2.2</b> Selezione della distribuzione a priori</a></li>
<li class="chapter" data-level="14.2.3" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#unapplicazione-empirica"><i class="fa fa-check"></i><b>14.2.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#la-funzione-di-verosimiglianza"><i class="fa fa-check"></i><b>14.3</b> La funzione di verosimiglianza</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#notazione-1"><i class="fa fa-check"></i><b>14.3.1</b> Notazione</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#la-log-verosimiglianza"><i class="fa fa-check"></i><b>14.3.2</b> La log-verosimiglianza</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#unapplicazione-empirica-1"><i class="fa fa-check"></i><b>14.3.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#sec:const-normaliz-bino23"><i class="fa fa-check"></i><b>14.4</b> La verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#unapplicazione-empirica-2"><i class="fa fa-check"></i><b>14.4.1</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzione-a-posteriori"><i class="fa fa-check"></i><b>14.5</b> Distribuzione a posteriori</a></li>
<li class="chapter" data-level="14.6" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzione-predittiva-a-priori"><i class="fa fa-check"></i><b>14.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="14.7" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzione-predittiva-a-posteriori"><i class="fa fa-check"></i><b>14.7</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#commenti-e-considerazioni-finali-10"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html"><i class="fa fa-check"></i><b>15</b> Pensare ad una proporzione in termini soggettivi</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#ch-prior-discr-binom"><i class="fa fa-check"></i><b>15.1</b> Inferenza bayesiana con una distribuzione a priori discreta</a></li>
<li class="chapter" data-level="15.2" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#ch-prior-cont-binom"><i class="fa fa-check"></i><b>15.2</b> Inferenza bayesiana con una distribuzione a priori continua</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#quali-parametri-per-la-distribuzione-beta"><i class="fa fa-check"></i><b>15.2.1</b> Quali parametri per la distribuzione Beta?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#commenti-e-considerazioni-finali-11"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html"><i class="fa fa-check"></i><b>16</b> Distribuzioni coniugate</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#lo-schema-beta-binomiale"><i class="fa fa-check"></i><b>16.1</b> Lo schema beta-binomiale</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#la-specificazione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>16.1.1</b> La specificazione della distribuzione a priori</a></li>
<li class="chapter" data-level="16.1.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#la-specificazione-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>16.1.2</b> La specificazione della distribuzione a posteriori</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#inferenza-bayesiana-con-distribuzioni-a-priori-continue"><i class="fa fa-check"></i><b>16.2</b> Inferenza bayesiana con distribuzioni a priori continue</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#approccio-bayesiano-alla-verifica-di-ipotesi"><i class="fa fa-check"></i><b>16.2.1</b> Approccio bayesiano alla verifica di ipotesi</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#intervalli-di-credibilità"><i class="fa fa-check"></i><b>16.2.2</b> Intervalli di credibilità</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#principali-distribuzioni-coniugate"><i class="fa fa-check"></i><b>16.3</b> Principali distribuzioni coniugate</a></li>
<li class="chapter" data-level="" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#commenti-e-considerazioni-finali-12"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html"><i class="fa fa-check"></i><b>17</b> L’influenza della distribuzione a priori</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#il-test-di-benchdel"><i class="fa fa-check"></i><b>17.1</b> Il test di Benchdel</a></li>
<li class="chapter" data-level="17.2" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#stessi-dati-ma-diverse-distribuzioni-a-priori"><i class="fa fa-check"></i><b>17.2</b> Stessi dati ma diverse distribuzioni a priori</a></li>
<li class="chapter" data-level="17.3" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#dati-diversi-ma-la-stessa-distribuzione-a-priori"><i class="fa fa-check"></i><b>17.3</b> Dati diversi ma la stessa distribuzione a priori</a></li>
<li class="chapter" data-level="17.4" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#dati-diversi-e-diverse-distribuzioni-a-priori"><i class="fa fa-check"></i><b>17.4</b> Dati diversi e diverse distribuzioni a priori</a></li>
<li class="chapter" data-level="17.5" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#collegare-le-intuizioni-alla-teoria"><i class="fa fa-check"></i><b>17.5</b> Collegare le intuizioni alla teoria</a></li>
<li class="chapter" data-level="" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#commenti-e-considerazioni-finali-13"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ch-post-approx.html"><a href="ch-post-approx.html"><i class="fa fa-check"></i><b>18</b> Approssimazione della distribuzione a posteriori</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ch-post-approx.html"><a href="ch-post-approx.html#metodo-basato-su-griglia"><i class="fa fa-check"></i><b>18.1</b> Metodo basato su griglia</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="ch-post-approx.html"><a href="ch-post-approx.html#modello-beta-binomiale"><i class="fa fa-check"></i><b>18.1.1</b> Modello Beta-Binomiale</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="ch-post-approx.html"><a href="ch-post-approx.html#chapter-simulazioneMC"><i class="fa fa-check"></i><b>18.2</b> Metodo Monte Carlo</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="ch-post-approx.html"><a href="ch-post-approx.html#integration-mc"><i class="fa fa-check"></i><b>18.2.1</b> Integrazione di Monte Carlo</a></li>
<li class="chapter" data-level="18.2.2" data-path="ch-post-approx.html"><a href="ch-post-approx.html#descrizione-intuitiva"><i class="fa fa-check"></i><b>18.2.2</b> Descrizione intuitiva</a></li>
<li class="chapter" data-level="18.2.3" data-path="ch-post-approx.html"><a href="ch-post-approx.html#unapplicazione-empirica-3"><i class="fa fa-check"></i><b>18.2.3</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="18.2.4" data-path="ch-post-approx.html"><a href="ch-post-approx.html#una-passeggiata-casuale-sui-numeri-naturali"><i class="fa fa-check"></i><b>18.2.4</b> Una passeggiata casuale sui numeri naturali</a></li>
<li class="chapter" data-level="18.2.5" data-path="ch-post-approx.html"><a href="ch-post-approx.html#lalgoritmo-di-metropolis"><i class="fa fa-check"></i><b>18.2.5</b> L’algoritmo di Metropolis</a></li>
<li class="chapter" data-level="18.2.6" data-path="ch-post-approx.html"><a href="ch-post-approx.html#unapplicazione-empirica-4"><i class="fa fa-check"></i><b>18.2.6</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="18.2.7" data-path="ch-post-approx.html"><a href="ch-post-approx.html#gibbs-sampling"><i class="fa fa-check"></i><b>18.2.7</b> Gibb’s sampling</a></li>
<li class="chapter" data-level="18.2.8" data-path="ch-post-approx.html"><a href="ch-post-approx.html#input"><i class="fa fa-check"></i><b>18.2.8</b> Input</a></li>
<li class="chapter" data-level="18.2.9" data-path="ch-post-approx.html"><a href="ch-post-approx.html#stazionarietà"><i class="fa fa-check"></i><b>18.2.9</b> Stazionarietà</a></li>
<li class="chapter" data-level="18.2.10" data-path="ch-post-approx.html"><a href="ch-post-approx.html#test-di-convergenza"><i class="fa fa-check"></i><b>18.2.10</b> Test di convergenza</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-post-approx.html"><a href="ch-post-approx.html#commenti-e-considerazioni-finali-14"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html"><i class="fa fa-check"></i><b>19</b> Il modello beta-binomiale in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="19.1" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#il-presidente-trump-e-lidrossiclorochina"><i class="fa fa-check"></i><b>19.1</b> Il presidente Trump e l’idrossiclorochina</a></li>
<li class="chapter" data-level="19.2" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#una-proporzione"><i class="fa fa-check"></i><b>19.2</b> Una proporzione</a></li>
<li class="chapter" data-level="19.3" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#cmdstanr-gautret"><i class="fa fa-check"></i><b>19.3</b> Interfaccia <code>cmdstanr</code></a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#fase-1"><i class="fa fa-check"></i><b>19.3.1</b> Fase 1</a></li>
<li class="chapter" data-level="19.3.2" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#fase-2"><i class="fa fa-check"></i><b>19.3.2</b> Fase 2</a></li>
<li class="chapter" data-level="19.3.3" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#fase-3"><i class="fa fa-check"></i><b>19.3.3</b> Fase 3</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#la-critica-di-hulme_2020"><i class="fa fa-check"></i><b>19.4</b> La critica di <span class="citation">Hulme et al. (<span>2020</span>)</span></a></li>
<li class="chapter" data-level="19.5" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#due-proporzioni"><i class="fa fa-check"></i><b>19.5</b> Due proporzioni</a></li>
<li class="chapter" data-level="" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#commenti-e-considerazioni-finali-15"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html"><i class="fa fa-check"></i><b>20</b> Diagnostica delle catene markoviane</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#esame-dei-trace-plot"><i class="fa fa-check"></i><b>20.1</b> Esame dei <em>trace plot</em></a></li>
<li class="chapter" data-level="20.2" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#confronto-delle-catene-parallele"><i class="fa fa-check"></i><b>20.2</b> Confronto delle catene parallele</a></li>
<li class="chapter" data-level="20.3" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#numerosita-campionaria-effettiva"><i class="fa fa-check"></i><b>20.3</b> Numerosità campionaria effettiva</a></li>
<li class="chapter" data-level="20.4" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#autocorrelazione"><i class="fa fa-check"></i><b>20.4</b> Autocorrelazione</a></li>
<li class="chapter" data-level="20.5" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#statistica-hatr"><i class="fa fa-check"></i><b>20.5</b> Statistica <span class="math inline">\(\hat{R}\)</span></a></li>
<li class="chapter" data-level="20.6" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#diagnostica-di-convergenza-di-geweke"><i class="fa fa-check"></i><b>20.6</b> Diagnostica di convergenza di Geweke</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html"><i class="fa fa-check"></i><b>21</b> Sintesi a posteriori</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#stima-puntuale"><i class="fa fa-check"></i><b>21.1</b> Stima puntuale</a></li>
<li class="chapter" data-level="21.2" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità"><i class="fa fa-check"></i><b>21.2</b> Intervallo di credibilità</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità-a-code-uguali"><i class="fa fa-check"></i><b>21.2.1</b> Intervallo di credibilità a code uguali</a></li>
<li class="chapter" data-level="21.2.2" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità-a-densità-a-posteriori-più-alta"><i class="fa fa-check"></i><b>21.2.2</b> Intervallo di credibilità a densità a posteriori più alta</a></li>
<li class="chapter" data-level="21.2.3" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#interpretazione-1"><i class="fa fa-check"></i><b>21.2.3</b> Interpretazione</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#un-esempio-concreto"><i class="fa fa-check"></i><b>21.3</b> Un esempio concreto</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#stime-puntuali-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>21.3.1</b> Stime puntuali della distribuzione a posteriori</a></li>
<li class="chapter" data-level="21.3.2" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità-1"><i class="fa fa-check"></i><b>21.3.2</b> Intervallo di credibilità</a></li>
<li class="chapter" data-level="21.3.3" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#probabilità-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>21.3.3</b> Probabilità della distribuzione a posteriori</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#la-funzione-di-perdita-attesa"><i class="fa fa-check"></i><b>21.4</b> La funzione di perdita attesa</a></li>
<li class="chapter" data-level="" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#commenti-e-considerazioni-finali-16"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ch-prediction.html"><a href="ch-prediction.html"><i class="fa fa-check"></i><b>22</b> La predizione bayesiana</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori"><i class="fa fa-check"></i><b>22.1</b> La distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="22.2" data-path="ch-prediction.html"><a href="ch-prediction.html#soluzione-analitica"><i class="fa fa-check"></i><b>22.2</b> Soluzione analitica</a></li>
<li class="chapter" data-level="22.3" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-simulazione"><i class="fa fa-check"></i><b>22.3</b> La distribuzione predittiva a posteriori mediante simulazione</a></li>
<li class="chapter" data-level="22.4" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-mcmc"><i class="fa fa-check"></i><b>22.4</b> La distribuzione predittiva a posteriori mediante MCMC</a></li>
<li class="chapter" data-level="22.5" data-path="ch-prediction.html"><a href="ch-prediction.html#i-metodi-per-la-valutazione-del-modello"><i class="fa fa-check"></i><b>22.5</b> I metodi per la valutazione del modello</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="ch-prediction.html"><a href="ch-prediction.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>22.5.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="ch-prediction.html"><a href="ch-prediction.html#distribuzione-predittiva-a-priori-1"><i class="fa fa-check"></i><b>22.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="" data-path="ch-prediction.html"><a href="ch-prediction.html#commenti-e-considerazioni-finali-17"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html"><i class="fa fa-check"></i><b>23</b> Inferenza sul parametro <span class="math inline">\(\mu\)</span> (media di una v.c. Normale)</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#caso-normale-normale-con-varianza-nota"><i class="fa fa-check"></i><b>23.1</b> Caso Normale-Normale con varianza nota</a></li>
<li class="chapter" data-level="23.2" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#derivazione-analitica-della-distribuzione-a-posteriori-pmu-mid-y"><i class="fa fa-check"></i><b>23.2</b> Derivazione analitica della distribuzione a posteriori <span class="math inline">\(p(\mu \mid y)\)</span></a></li>
<li class="chapter" data-level="23.3" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#il-modello-normale-con-stan"><i class="fa fa-check"></i><b>23.3</b> Il modello Normale con Stan</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#versione-1-sigma-nota"><i class="fa fa-check"></i><b>23.3.1</b> Versione 1 (<span class="math inline">\(\sigma\)</span> nota)</a></li>
<li class="chapter" data-level="23.3.2" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#versione-2-sigma-incognita"><i class="fa fa-check"></i><b>23.3.2</b> Versione 2 (<span class="math inline">\(\sigma\)</span> incognita)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#commenti-e-considerazioni-finali-18"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>VI Il modello lineare</b></span></li>
<li class="chapter" data-level="24" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html"><i class="fa fa-check"></i><b>24</b> Introduzione</a>
<ul>
<li class="chapter" data-level="24.1" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#la-funzione-lineare"><i class="fa fa-check"></i><b>24.1</b> La funzione lineare</a></li>
<li class="chapter" data-level="24.2" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#una-media-per-ciascuna-osservazione"><i class="fa fa-check"></i><b>24.2</b> Una media per ciascuna osservazione</a></li>
<li class="chapter" data-level="24.3" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#relazione-lineare-tra-la-media-y-mid-x-e-il-predittore"><i class="fa fa-check"></i><b>24.3</b> Relazione lineare tra la media <span class="math inline">\(y \mid x\)</span> e il predittore</a></li>
<li class="chapter" data-level="24.4" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#il-modello-lineare"><i class="fa fa-check"></i><b>24.4</b> Il modello lineare</a></li>
<li class="chapter" data-level="" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#commenti-e-considerazioni-finali-19"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html"><i class="fa fa-check"></i><b>25</b> Regressione lineare con un singolo predittore</a>
<ul>
<li class="chapter" data-level="25.1" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#stima-dei-coefficienti-di-regressione"><i class="fa fa-check"></i><b>25.1</b> Stima dei coefficienti di regressione</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#trasformazione-dei-dati"><i class="fa fa-check"></i><b>25.1.1</b> Trasformazione dei dati</a></li>
<li class="chapter" data-level="25.1.2" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#il-metodo-dei-minimi-quadrati"><i class="fa fa-check"></i><b>25.1.2</b> Il metodo dei minimi quadrati</a></li>
<li class="chapter" data-level="25.1.3" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#lerrore-standard-della-regressione"><i class="fa fa-check"></i><b>25.1.3</b> L’errore standard della regressione</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#indice-di-determinazione"><i class="fa fa-check"></i><b>25.2</b> Indice di determinazione</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#inferenza-sul-modello-di-regressione"><i class="fa fa-check"></i><b>25.2.1</b> Inferenza sul modello di regressione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#commenti-e-considerazioni-finali-20"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html"><i class="fa fa-check"></i><b>26</b> Modello di regressione in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="26.1" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#specificazione-del-modello"><i class="fa fa-check"></i><b>26.1</b> Specificazione del modello</a></li>
<li class="chapter" data-level="26.2" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#stima-bayesiana-in-linguaggio-stan"><i class="fa fa-check"></i><b>26.2</b> Stima bayesiana in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#standardizzare-i-dati"><i class="fa fa-check"></i><b>26.2.1</b> Standardizzare i dati</a></li>
<li class="chapter" data-level="26.2.2" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#interpretazione-dei-parametri"><i class="fa fa-check"></i><b>26.2.2</b> Interpretazione dei parametri</a></li>
<li class="chapter" data-level="26.2.3" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#centrare-i-predittori"><i class="fa fa-check"></i><b>26.2.3</b> Centrare i predittori</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#commenti-e-considerazioni-finali-21"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html"><i class="fa fa-check"></i><b>27</b> Inferenza sul modello lineare</a>
<ul>
<li class="chapter" data-level="27.1" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#rappresentazione-grafica-dellincertezza-della-stima"><i class="fa fa-check"></i><b>27.1</b> Rappresentazione grafica dell’incertezza della stima</a></li>
<li class="chapter" data-level="27.2" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#intervalli-di-credibilità-1"><i class="fa fa-check"></i><b>27.2</b> Intervalli di credibilità</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#quale-soglia-usare"><i class="fa fa-check"></i><b>27.2.1</b> Quale soglia usare?</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#test-di-ipotesi"><i class="fa fa-check"></i><b>27.3</b> Test di ipotesi</a></li>
<li class="chapter" data-level="27.4" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#modello-lineare-robusto"><i class="fa fa-check"></i><b>27.4</b> Modello lineare robusto</a></li>
<li class="chapter" data-level="" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#commenti-e-considerazioni-finali-22"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html"><i class="fa fa-check"></i><b>28</b> Confronto tra due gruppi indipendenti</a>
<ul>
<li class="chapter" data-level="28.1" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#modello-lineare-con-una-variabile-dicotomica"><i class="fa fa-check"></i><b>28.1</b> Modello lineare con una variabile dicotomica</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#confronti-non-effetti"><i class="fa fa-check"></i><b>28.1.1</b> Confronti, non effetti</a></li>
<li class="chapter" data-level="28.1.2" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#un-esempio-concreto-1"><i class="fa fa-check"></i><b>28.1.2</b> Un esempio concreto</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#la-dimensione-delleffetto"><i class="fa fa-check"></i><b>28.2</b> La dimensione dell’effetto</a></li>
<li class="chapter" data-level="" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#commenti-e-considerazioni-finali-23"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html"><i class="fa fa-check"></i><b>29</b> Predictive checks</a>
<ul>
<li class="chapter" data-level="29.1" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#distribuzione-predittiva-a-posteriori-1"><i class="fa fa-check"></i><b>29.1</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="29.2" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#distribuzione-predittiva-a-priori-2"><i class="fa fa-check"></i><b>29.2</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#commenti-e-considerazioni-finali-24"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="ch-anova.html"><a href="ch-anova.html"><i class="fa fa-check"></i><b>30</b> Confronto tra le medie di tre o più gruppi</a>
<ul>
<li class="chapter" data-level="30.1" data-path="ch-anova.html"><a href="ch-anova.html#le-abilità-sociali-di-un-robot"><i class="fa fa-check"></i><b>30.1</b> Le abilità sociali di un robot</a></li>
<li class="chapter" data-level="30.2" data-path="ch-anova.html"><a href="ch-anova.html#anova-ad-una-via"><i class="fa fa-check"></i><b>30.2</b> ANOVA ad una via</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="ch-anova.html"><a href="ch-anova.html#interpretazione-2"><i class="fa fa-check"></i><b>30.2.1</b> Interpretazione</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="ch-anova.html"><a href="ch-anova.html#anova-ad-due-vie"><i class="fa fa-check"></i><b>30.3</b> ANOVA ad due vie</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="ch-anova.html"><a href="ch-anova.html#test-sullinterazione"><i class="fa fa-check"></i><b>30.3.1</b> Test sull’interazione</a></li>
<li class="chapter" data-level="30.3.2" data-path="ch-anova.html"><a href="ch-anova.html#test-sugli-effetti-principali"><i class="fa fa-check"></i><b>30.3.2</b> Test sugli effetti principali</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="ch-anova.html"><a href="ch-anova.html#codice-stan-versione-2"><i class="fa fa-check"></i><b>30.4</b> Codice Stan (versione 2)</a></li>
<li class="chapter" data-level="" data-path="ch-anova.html"><a href="ch-anova.html#commenti-e-considerazioni-finali-25"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html"><i class="fa fa-check"></i><b>31</b> Modello gerarchico</a>
<ul>
<li class="chapter" data-level="31.1" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#la-struttura-dei-dati"><i class="fa fa-check"></i><b>31.1</b> La struttura dei dati</a></li>
<li class="chapter" data-level="31.2" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#struttura-nested"><i class="fa fa-check"></i><b>31.2</b> Struttura Nested</a></li>
<li class="chapter" data-level="31.3" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#struttura-non-nested"><i class="fa fa-check"></i><b>31.3</b> Struttura Non-Nested</a></li>
<li class="chapter" data-level="31.4" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#ragioni-di-utilizzo-della-struttura-gerarchica"><i class="fa fa-check"></i><b>31.4</b> Ragioni di utilizzo della struttura gerarchica</a></li>
<li class="chapter" data-level="31.5" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#il-problema-delle-8-scuole"><i class="fa fa-check"></i><b>31.5</b> Il problema delle 8 scuole</a>
<ul>
<li class="chapter" data-level="31.5.1" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-di-complete-pooling"><i class="fa fa-check"></i><b>31.5.1</b> Modello di <em>complete pooling</em></a></li>
<li class="chapter" data-level="31.5.2" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-no-pooling"><i class="fa fa-check"></i><b>31.5.2</b> Modello <em>no pooling</em></a></li>
<li class="chapter" data-level="31.5.3" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-partial-pooling"><i class="fa fa-check"></i><b>31.5.3</b> Modello <em>partial pooling</em></a></li>
<li class="chapter" data-level="31.5.4" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-gerarchico"><i class="fa fa-check"></i><b>31.5.4</b> Modello gerarchico</a></li>
<li class="chapter" data-level="31.5.5" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#interpretazione-3"><i class="fa fa-check"></i><b>31.5.5</b> Interpretazione</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modelli-lineari-ad-intercetta-casuale"><i class="fa fa-check"></i><b>31.6</b> Modelli lineari ad intercetta casuale</a>
<ul>
<li class="chapter" data-level="31.6.1" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-ad-effetti-fissi"><i class="fa fa-check"></i><b>31.6.1</b> Modello ad effetti fissi</a></li>
<li class="chapter" data-level="31.6.2" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-gerarchico-1"><i class="fa fa-check"></i><b>31.6.2</b> Modello gerarchico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#commenti-e-considerazioni-finali-26"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="ch-hier-sim.html"><a href="ch-hier-sim.html"><i class="fa fa-check"></i><b>32</b> Modello gerarchico: simulazioni</a>
<ul>
<li class="chapter" data-level="32.1" data-path="ch-hier-sim.html"><a href="ch-hier-sim.html#modello-generativo-dei-dati"><i class="fa fa-check"></i><b>32.1</b> Modello generativo dei dati</a></li>
<li class="chapter" data-level="32.2" data-path="ch-hier-sim.html"><a href="ch-hier-sim.html#modello-gerarchico-2"><i class="fa fa-check"></i><b>32.2</b> Modello gerarchico</a></li>
<li class="chapter" data-level="" data-path="ch-hier-sim.html"><a href="ch-hier-sim.html#commenti-e-considerazioni-finali-27"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>VII Il confronto bayesiano di modelli</b></span></li>
<li class="chapter" data-level="33" data-path="ch-entropy.html"><a href="ch-entropy.html"><i class="fa fa-check"></i><b>33</b> Entropia</a>
<ul>
<li class="chapter" data-level="33.1" data-path="ch-entropy.html"><a href="ch-entropy.html#la-generalizzabilità-dei-modelli"><i class="fa fa-check"></i><b>33.1</b> La generalizzabilità dei modelli</a></li>
<li class="chapter" data-level="33.2" data-path="ch-entropy.html"><a href="ch-entropy.html#capacità-predittiva"><i class="fa fa-check"></i><b>33.2</b> Capacità predittiva</a></li>
<li class="chapter" data-level="33.3" data-path="ch-entropy.html"><a href="ch-entropy.html#il-rasoio-di-ockham"><i class="fa fa-check"></i><b>33.3</b> Il rasoio di Ockham</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="ch-entropy.html"><a href="ch-entropy.html#sovra-adattamento-e-sotto-adattamento"><i class="fa fa-check"></i><b>33.3.1</b> Sovra-adattamento e sotto-adattamento</a></li>
<li class="chapter" data-level="33.3.2" data-path="ch-entropy.html"><a href="ch-entropy.html#stargazing"><i class="fa fa-check"></i><b>33.3.2</b> Stargazing</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="ch-entropy.html"><a href="ch-entropy.html#la-misura-del-disordine"><i class="fa fa-check"></i><b>33.4</b> La misura del disordine</a>
<ul>
<li class="chapter" data-level="33.4.1" data-path="ch-entropy.html"><a href="ch-entropy.html#entropia-di-un-singolo-evento"><i class="fa fa-check"></i><b>33.4.1</b> Entropia di un singolo evento</a></li>
<li class="chapter" data-level="33.4.2" data-path="ch-entropy.html"><a href="ch-entropy.html#entropia-di-una-variabile-casuale"><i class="fa fa-check"></i><b>33.4.2</b> Entropia di una variabile casuale</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-entropy.html"><a href="ch-entropy.html#commenti-e-considerazioni-finali-28"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="ch-kl.html"><a href="ch-kl.html"><i class="fa fa-check"></i><b>34</b> La divergenza di Kullback-Leibler</a>
<ul>
<li class="chapter" data-level="34.1" data-path="ch-kl.html"><a href="ch-kl.html#la-perdita-di-informazione"><i class="fa fa-check"></i><b>34.1</b> La perdita di informazione</a></li>
<li class="chapter" data-level="34.2" data-path="ch-kl.html"><a href="ch-kl.html#la-divergenza-dipende-dalla-direzione"><i class="fa fa-check"></i><b>34.2</b> La divergenza dipende dalla direzione</a></li>
<li class="chapter" data-level="34.3" data-path="ch-kl.html"><a href="ch-kl.html#confronto-tra-modelli"><i class="fa fa-check"></i><b>34.3</b> Confronto tra modelli</a></li>
<li class="chapter" data-level="34.4" data-path="ch-kl.html"><a href="ch-kl.html#expected-log-predictive-density"><i class="fa fa-check"></i><b>34.4</b> Expected log predictive density</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="ch-kl.html"><a href="ch-kl.html#log-pointwise-predictive-density"><i class="fa fa-check"></i><b>34.4.1</b> Log pointwise predictive density</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-kl.html"><a href="ch-kl.html#commenti-e-considerazioni-finali-29"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="ch-info-crit.html"><a href="ch-info-crit.html"><i class="fa fa-check"></i><b>35</b> Criterio di informazione e convalida incrociata</a>
<ul>
<li class="chapter" data-level="35.1" data-path="ch-info-crit.html"><a href="ch-info-crit.html#aic-dic-e-waic"><i class="fa fa-check"></i><b>35.1</b> AIC, DIC e WAIC</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="ch-info-crit.html"><a href="ch-info-crit.html#criterio-dinformazione-di-akaike"><i class="fa fa-check"></i><b>35.1.1</b> Criterio d’informazione di Akaike</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="ch-info-crit.html"><a href="ch-info-crit.html#convalida-incrociata-k-fold"><i class="fa fa-check"></i><b>35.2</b> Convalida incrociata K-fold</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="ch-info-crit.html"><a href="ch-info-crit.html#importance-sampling"><i class="fa fa-check"></i><b>35.2.1</b> Importance sampling</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="ch-info-crit.html"><a href="ch-info-crit.html#confronto-tra-aic-e-loo-cv"><i class="fa fa-check"></i><b>35.3</b> Confronto tra AIC e LOO-CV</a></li>
<li class="chapter" data-level="35.4" data-path="ch-info-crit.html"><a href="ch-info-crit.html#confronto-tra-modelli-mediante-loo-cv"><i class="fa fa-check"></i><b>35.4</b> Confronto tra modelli mediante LOO-CV</a></li>
<li class="chapter" data-level="35.5" data-path="ch-info-crit.html"><a href="ch-info-crit.html#outlier"><i class="fa fa-check"></i><b>35.5</b> Outlier</a></li>
<li class="chapter" data-level="35.6" data-path="ch-info-crit.html"><a href="ch-info-crit.html#regolarizzazione"><i class="fa fa-check"></i><b>35.6</b> Regolarizzazione</a></li>
<li class="chapter" data-level="" data-path="ch-info-crit.html"><a href="ch-info-crit.html#commenti-e-considerazioni-finali-30"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>VIII Approccio frequentista all’inferenza statistica</b></span></li>
<li class="chapter" data-level="36" data-path="ch-ttest.html"><a href="ch-ttest.html"><i class="fa fa-check"></i><b>36</b> Inferenza sulla media</a>
<ul>
<li class="chapter" data-level="36.1" data-path="ch-ttest.html"><a href="ch-ttest.html#la-ripetizione-dellesperimento-casuale"><i class="fa fa-check"></i><b>36.1</b> La ripetizione dell’esperimento casuale</a></li>
<li class="chapter" data-level="36.2" data-path="ch-ttest.html"><a href="ch-ttest.html#la-distribuzione-campionaria-della-media"><i class="fa fa-check"></i><b>36.2</b> La distribuzione campionaria della media</a></li>
<li class="chapter" data-level="36.3" data-path="ch-ttest.html"><a href="ch-ttest.html#inferenza-frequentista"><i class="fa fa-check"></i><b>36.3</b> Inferenza frequentista</a>
<ul>
<li class="chapter" data-level="36.3.1" data-path="ch-ttest.html"><a href="ch-ttest.html#il-test-dellipotesi-nulla"><i class="fa fa-check"></i><b>36.3.1</b> Il test dell’ipotesi nulla</a></li>
<li class="chapter" data-level="36.3.2" data-path="ch-ttest.html"><a href="ch-ttest.html#lintervallo-di-fiducia"><i class="fa fa-check"></i><b>36.3.2</b> L’Intervallo di fiducia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-ttest.html"><a href="ch-ttest.html#commenti-e-considerazioni-finali-31"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><i class="fa fa-check"></i><b>37</b> La crisi della replicabilità dei risultati della ricerca</a>
<ul>
<li class="chapter" data-level="37.1" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#che-cosè-un-valore-p"><i class="fa fa-check"></i><b>37.1</b> Che cos’è un valore-<span class="math inline">\(p\)</span>?</a></li>
<li class="chapter" data-level="37.2" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#luso-del-valore-p-nel-mondo-della-ricerca"><i class="fa fa-check"></i><b>37.2</b> L’uso del valore-<span class="math inline">\(p\)</span> nel mondo della ricerca</a></li>
<li class="chapter" data-level="37.3" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#p-hacking"><i class="fa fa-check"></i><b>37.3</b> <span class="math inline">\(P\)</span>-hacking</a></li>
<li class="chapter" data-level="37.4" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#critiche-al-valore-p"><i class="fa fa-check"></i><b>37.4</b> Critiche al valore-<span class="math inline">\(p\)</span></a></li>
<li class="chapter" data-level="37.5" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#leffetto-sperimentale-è-esattamente-nullo"><i class="fa fa-check"></i><b>37.5</b> L’effetto sperimentale è esattamente nullo?</a></li>
<li class="chapter" data-level="37.6" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#simulazione"><i class="fa fa-check"></i><b>37.6</b> Simulazione</a>
<ul>
<li class="chapter" data-level="37.6.1" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#la-dimensione-delleffetto-1"><i class="fa fa-check"></i><b>37.6.1</b> La dimensione dell’effetto</a></li>
<li class="chapter" data-level="37.6.2" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#una-piccola-dimensione-delleffetto-nella-popolazione"><i class="fa fa-check"></i><b>37.6.2</b> Una piccola dimensione dell’effetto nella popolazione</a></li>
<li class="chapter" data-level="37.6.3" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#una-soluzione-sbagliata"><i class="fa fa-check"></i><b>37.6.3</b> Una soluzione (sbagliata)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#commenti-e-considerazioni-finali-32"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i><b>38</b> Bibliografia</a></li>
<li class="appendix"><span><b>Appendici</b></span></li>
<li class="chapter" data-level="A" data-path="simbologia-di-base.html"><a href="simbologia-di-base.html"><i class="fa fa-check"></i><b>A</b> Simbologia di base</a></li>
<li class="chapter" data-level="B" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html"><i class="fa fa-check"></i><b>B</b> Numeri binari, interi, razionali, irrazionali e reali</a>
<ul>
<li class="chapter" data-level="B.1" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-binari"><i class="fa fa-check"></i><b>B.1</b> Numeri binari</a></li>
<li class="chapter" data-level="B.2" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-interi"><i class="fa fa-check"></i><b>B.2</b> Numeri interi</a></li>
<li class="chapter" data-level="B.3" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-razionali"><i class="fa fa-check"></i><b>B.3</b> Numeri razionali</a></li>
<li class="chapter" data-level="B.4" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-irrazionali"><i class="fa fa-check"></i><b>B.4</b> Numeri irrazionali</a></li>
<li class="chapter" data-level="B.5" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-reali"><i class="fa fa-check"></i><b>B.5</b> Numeri reali</a></li>
<li class="chapter" data-level="B.6" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#intervalli"><i class="fa fa-check"></i><b>B.6</b> Intervalli</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="insiemistica.html"><a href="insiemistica.html"><i class="fa fa-check"></i><b>C</b> Insiemi</a>
<ul>
<li class="chapter" data-level="C.1" data-path="insiemistica.html"><a href="insiemistica.html#operazioni-tra-insiemi"><i class="fa fa-check"></i><b>C.1</b> Operazioni tra insiemi</a></li>
<li class="chapter" data-level="C.2" data-path="insiemistica.html"><a href="insiemistica.html#diagrammi-di-eulero-venn"><i class="fa fa-check"></i><b>C.2</b> Diagrammi di Eulero-Venn</a></li>
<li class="chapter" data-level="C.3" data-path="insiemistica.html"><a href="insiemistica.html#coppie-ordinate-e-prodotto-cartesiano"><i class="fa fa-check"></i><b>C.3</b> Coppie ordinate e prodotto cartesiano</a></li>
<li class="chapter" data-level="C.4" data-path="insiemistica.html"><a href="insiemistica.html#cardinalità"><i class="fa fa-check"></i><b>C.4</b> Cardinalità</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="sommatorie.html"><a href="sommatorie.html"><i class="fa fa-check"></i><b>D</b> Simbolo di somma (sommatorie)</a>
<ul>
<li class="chapter" data-level="D.1" data-path="sommatorie.html"><a href="sommatorie.html#manipolazione-di-somme"><i class="fa fa-check"></i><b>D.1</b> Manipolazione di somme</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-1-1"><i class="fa fa-check"></i><b>D.1.1</b> Proprietà 1</a></li>
<li class="chapter" data-level="D.1.2" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-2-proprietà-distributiva"><i class="fa fa-check"></i><b>D.1.2</b> Proprietà 2 (proprietà distributiva)</a></li>
<li class="chapter" data-level="D.1.3" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-3-proprietà-associativa"><i class="fa fa-check"></i><b>D.1.3</b> Proprietà 3 (proprietà associativa)</a></li>
<li class="chapter" data-level="D.1.4" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-4"><i class="fa fa-check"></i><b>D.1.4</b> Proprietà 4</a></li>
<li class="chapter" data-level="D.1.5" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-5"><i class="fa fa-check"></i><b>D.1.5</b> Proprietà 5</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="sommatorie.html"><a href="sommatorie.html#doppia-sommatoria"><i class="fa fa-check"></i><b>D.2</b> Doppia sommatoria</a></li>
<li class="chapter" data-level="D.3" data-path="sommatorie.html"><a href="sommatorie.html#sommatorie-e-produttorie-e-operazioni-vettoriali-in-r"><i class="fa fa-check"></i><b>D.3</b> Sommatorie (e produttorie) e operazioni vettoriali in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="appendix:future-exp.html"><a href="appendix:future-exp.html"><i class="fa fa-check"></i><b>E</b> Le aspettative future dei pazienti depressi</a>
<ul>
<li class="chapter" data-level="E.1" data-path="appendix:future-exp.html"><a href="appendix:future-exp.html#app:zet"><i class="fa fa-check"></i><b>E.1</b> La ricerca di <span class="citation">Zetsche, Bürkner, and Renneberg (<span>2019</span>)</span></a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="appendix:beta-binom.html"><a href="appendix:beta-binom.html"><i class="fa fa-check"></i><b>F</b> Modello Beta-binomiale</a>
<ul>
<li class="chapter" data-level="F.1" data-path="appendix:beta-binom.html"><a href="appendix:beta-binom.html#funzione-per-il-modello-beta-binomiale"><i class="fa fa-check"></i><b>F.1</b> Funzione per il modello Beta-binomiale</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="appendix:const-norm-bino23.html"><a href="appendix:const-norm-bino23.html"><i class="fa fa-check"></i><b>G</b> Verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="G.1" data-path="appendix:const-norm-bino23.html"><a href="appendix:const-norm-bino23.html#derivazione-analitica-della-costante-di-normalizzazione"><i class="fa fa-check"></i><b>G.1</b> Derivazione analitica della costante di normalizzazione</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>H</b> Le catene di Markov</a>
<ul>
<li class="chapter" data-level="H.1" data-path="markov-chains.html"><a href="markov-chains.html#simulare-una-catena-di-markov"><i class="fa fa-check"></i><b>H.1</b> Simulare una catena di Markov</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="regr-ml.html"><a href="regr-ml.html"><i class="fa fa-check"></i><b>I</b> Adattare il modello lineare ai dati</a>
<ul>
<li class="chapter" data-level="I.1" data-path="regr-ml.html"><a href="regr-ml.html#minimi-quadrati"><i class="fa fa-check"></i><b>I.1</b> Minimi quadrati</a>
<ul>
<li class="chapter" data-level="I.1.1" data-path="regr-ml.html"><a href="regr-ml.html#stima-della-deviazione-standard-dei-residui-sigma"><i class="fa fa-check"></i><b>I.1.1</b> Stima della deviazione standard dei residui <span class="math inline">\(\sigma\)</span></a></li>
</ul></li>
<li class="chapter" data-level="I.2" data-path="regr-ml.html"><a href="regr-ml.html#calcolare-la-somma-dei-quadrati"><i class="fa fa-check"></i><b>I.2</b> Calcolare la somma dei quadrati</a></li>
<li class="chapter" data-level="" data-path="regr-ml.html"><a href="regr-ml.html#commenti-e-considerazioni-finali-33"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="J" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html"><i class="fa fa-check"></i><b>J</b> Introduzione al linguaggio R</a>
<ul>
<li class="chapter" data-level="J.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#prerequisiti"><i class="fa fa-check"></i><b>J.1</b> Prerequisiti</a>
<ul>
<li class="chapter" data-level="J.1.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#installare-r-e-rstudio"><i class="fa fa-check"></i><b>J.1.1</b> Installare R e RStudio</a></li>
<li class="chapter" data-level="J.1.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#utilizzare-rstudio-per-semplificare-il-lavoro"><i class="fa fa-check"></i><b>J.1.2</b> Utilizzare RStudio per semplificare il lavoro</a></li>
<li class="chapter" data-level="J.1.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#eseguire-il-codice"><i class="fa fa-check"></i><b>J.1.3</b> Eseguire il codice</a></li>
</ul></li>
<li class="chapter" data-level="J.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#installare-cmdstan"><i class="fa fa-check"></i><b>J.2</b> Installare <code>cmdstan</code></a></li>
<li class="chapter" data-level="J.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-sintassi"><i class="fa fa-check"></i><b>J.3</b> Sintassi di base</a>
<ul>
<li class="chapter" data-level="J.3.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#utilizzare-la-console-mathsfr-come-calcolatrice"><i class="fa fa-check"></i><b>J.3.1</b> Utilizzare la console <span class="math inline">\(\mathsf{R}\)</span> come calcolatrice</a></li>
<li class="chapter" data-level="J.3.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#espressioni"><i class="fa fa-check"></i><b>J.3.2</b> Espressioni</a></li>
<li class="chapter" data-level="J.3.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#oggetti"><i class="fa fa-check"></i><b>J.3.3</b> Oggetti</a></li>
<li class="chapter" data-level="J.3.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#variabili"><i class="fa fa-check"></i><b>J.3.4</b> Variabili</a></li>
<li class="chapter" data-level="J.3.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#r-console"><i class="fa fa-check"></i><b>J.3.5</b> R console</a></li>
<li class="chapter" data-level="J.3.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#parentesi"><i class="fa fa-check"></i><b>J.3.6</b> Parentesi</a></li>
<li class="chapter" data-level="J.3.7" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#i-nomi-degli-oggetti"><i class="fa fa-check"></i><b>J.3.7</b> I nomi degli oggetti</a></li>
<li class="chapter" data-level="J.3.8" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#permanenza-dei-dati-e-rimozione-di-oggetti"><i class="fa fa-check"></i><b>J.3.8</b> Permanenza dei dati e rimozione di oggetti</a></li>
<li class="chapter" data-level="J.3.9" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chiudere-r"><i class="fa fa-check"></i><b>J.3.9</b> Chiudere R</a></li>
<li class="chapter" data-level="J.3.10" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#creare-ed-eseguire-uno-script-r-con-un-editore"><i class="fa fa-check"></i><b>J.3.10</b> Creare ed eseguire uno script R con un editore</a></li>
<li class="chapter" data-level="J.3.11" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#commentare-il-codice"><i class="fa fa-check"></i><b>J.3.11</b> Commentare il codice</a></li>
<li class="chapter" data-level="J.3.12" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#cambiare-la-cartella-di-lavoro"><i class="fa fa-check"></i><b>J.3.12</b> Cambiare la cartella di lavoro</a></li>
<li class="chapter" data-level="J.3.13" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#loggetto-base-di-r-il-vettore"><i class="fa fa-check"></i><b>J.3.13</b> L’oggetto base di R: il vettore</a></li>
<li class="chapter" data-level="J.3.14" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#operazioni-vettorializzate"><i class="fa fa-check"></i><b>J.3.14</b> Operazioni vettorializzate</a></li>
<li class="chapter" data-level="J.3.15" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori-aritmetici"><i class="fa fa-check"></i><b>J.3.15</b> Vettori aritmetici</a></li>
<li class="chapter" data-level="J.3.16" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#generazione-di-sequenze-regolari"><i class="fa fa-check"></i><b>J.3.16</b> Generazione di sequenze regolari</a></li>
<li class="chapter" data-level="J.3.17" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#generazione-di-numeri-casuali"><i class="fa fa-check"></i><b>J.3.17</b> Generazione di numeri casuali</a></li>
<li class="chapter" data-level="J.3.18" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori-logici"><i class="fa fa-check"></i><b>J.3.18</b> Vettori logici</a></li>
<li class="chapter" data-level="J.3.19" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dati-mancanti"><i class="fa fa-check"></i><b>J.3.19</b> Dati mancanti</a></li>
<li class="chapter" data-level="J.3.20" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori-di-caratteri-e-fattori"><i class="fa fa-check"></i><b>J.3.20</b> Vettori di caratteri e fattori</a></li>
<li class="chapter" data-level="J.3.21" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#funzioni-1"><i class="fa fa-check"></i><b>J.3.21</b> Funzioni</a></li>
<li class="chapter" data-level="J.3.22" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#scrivere-proprie-funzioni"><i class="fa fa-check"></i><b>J.3.22</b> Scrivere proprie funzioni</a></li>
<li class="chapter" data-level="J.3.23" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#pacchetti"><i class="fa fa-check"></i><b>J.3.23</b> Pacchetti</a></li>
<li class="chapter" data-level="J.3.24" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#istallazione-e-upgrade-dei-pacchetti"><i class="fa fa-check"></i><b>J.3.24</b> Istallazione e upgrade dei pacchetti</a></li>
<li class="chapter" data-level="J.3.25" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#caricare-un-pacchetto-in-r"><i class="fa fa-check"></i><b>J.3.25</b> Caricare un pacchetto in R</a></li>
</ul></li>
<li class="chapter" data-level="J.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-strutture-dati"><i class="fa fa-check"></i><b>J.4</b> Strutture di dati</a>
<ul>
<li class="chapter" data-level="J.4.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#classi-e-modi-degli-oggetti"><i class="fa fa-check"></i><b>J.4.1</b> Classi e modi degli oggetti</a></li>
<li class="chapter" data-level="J.4.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori"><i class="fa fa-check"></i><b>J.4.2</b> Vettori</a></li>
<li class="chapter" data-level="J.4.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#matrici"><i class="fa fa-check"></i><b>J.4.3</b> Matrici</a></li>
<li class="chapter" data-level="J.4.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#array"><i class="fa fa-check"></i><b>J.4.4</b> Array</a></li>
<li class="chapter" data-level="J.4.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#operazioni-aritmetiche-su-vettori-matrici-e-array"><i class="fa fa-check"></i><b>J.4.5</b> Operazioni aritmetiche su vettori, matrici e array</a></li>
<li class="chapter" data-level="J.4.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#liste"><i class="fa fa-check"></i><b>J.4.6</b> Liste</a></li>
<li class="chapter" data-level="J.4.7" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#data-frame"><i class="fa fa-check"></i><b>J.4.7</b> Data frame</a></li>
<li class="chapter" data-level="J.4.8" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#giochi-di-carte"><i class="fa fa-check"></i><b>J.4.8</b> Giochi di carte</a></li>
<li class="chapter" data-level="J.4.9" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#variabili-locali"><i class="fa fa-check"></i><b>J.4.9</b> Variabili locali</a></li>
</ul></li>
<li class="chapter" data-level="J.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-strut-contr"><i class="fa fa-check"></i><b>J.5</b> Strutture di controllo</a>
<ul>
<li class="chapter" data-level="J.5.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#il-ciclo-for"><i class="fa fa-check"></i><b>J.5.1</b> Il ciclo <code>for</code></a></li>
</ul></li>
<li class="chapter" data-level="J.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-input-output"><i class="fa fa-check"></i><b>J.6</b> Input/Output</a>
<ul>
<li class="chapter" data-level="J.6.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#la-funzione-read.table"><i class="fa fa-check"></i><b>J.6.1</b> La funzione <code>read.table()</code></a></li>
<li class="chapter" data-level="J.6.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#file-di-dati-forniti-da-r"><i class="fa fa-check"></i><b>J.6.2</b> File di dati forniti da R</a></li>
<li class="chapter" data-level="J.6.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#esportazione-di-un-file"><i class="fa fa-check"></i><b>J.6.3</b> Esportazione di un file</a></li>
<li class="chapter" data-level="J.6.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#pacchetto-rio"><i class="fa fa-check"></i><b>J.6.4</b> Pacchetto <code>rio</code></a></li>
<li class="chapter" data-level="J.6.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dove-sono-i-miei-file"><i class="fa fa-check"></i><b>J.6.5</b> Dove sono i miei file?</a></li>
</ul></li>
<li class="chapter" data-level="J.7" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#manipolazione-dei-dati"><i class="fa fa-check"></i><b>J.7</b> Manipolazione dei dati</a>
<ul>
<li class="chapter" data-level="J.7.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#motivazione"><i class="fa fa-check"></i><b>J.7.1</b> Motivazione</a></li>
<li class="chapter" data-level="J.7.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#trattamento-dei-dati-con-dplyr"><i class="fa fa-check"></i><b>J.7.2</b> Trattamento dei dati con <code>dplyr</code></a></li>
<li class="chapter" data-level="J.7.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dati-categoriali-in-r"><i class="fa fa-check"></i><b>J.7.3</b> Dati categoriali in <code>R</code></a></li>
<li class="chapter" data-level="J.7.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#creare-grafici-con-ggplot2"><i class="fa fa-check"></i><b>J.7.4</b> Creare grafici con <code>ggplot2()</code></a></li>
<li class="chapter" data-level="J.7.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#diagramma-a-dispersione-1"><i class="fa fa-check"></i><b>J.7.5</b> Diagramma a dispersione</a></li>
<li class="chapter" data-level="J.7.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#scrivere-il-codice-r-con-stile"><i class="fa fa-check"></i><b>J.7.6</b> Scrivere il codice <code>R</code> con stile</a></li>
</ul></li>
<li class="chapter" data-level="J.8" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#flusso-di-lavoro-riproducibile"><i class="fa fa-check"></i><b>J.8</b> Flusso di lavoro riproducibile</a>
<ul>
<li class="chapter" data-level="J.8.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#la-crisi-della-riproducibilità"><i class="fa fa-check"></i><b>J.8.1</b> La crisi della riproducibilità</a></li>
<li class="chapter" data-level="J.8.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#r-markdown"><i class="fa fa-check"></i><b>J.8.2</b> R-markdown</a></li>
<li class="chapter" data-level="J.8.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#compilare-la-presentazione-r-markdown"><i class="fa fa-check"></i><b>J.8.3</b> Compilare la presentazione R-markdown</a></li>
</ul></li>
<li class="chapter" data-level="J.9" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dati-mancanti-1"><i class="fa fa-check"></i><b>J.9</b> Dati mancanti</a>
<ul>
<li class="chapter" data-level="J.9.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#motivazione-1"><i class="fa fa-check"></i><b>J.9.1</b> Motivazione</a></li>
<li class="chapter" data-level="J.9.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#trattamento-dei-dati-mancanti"><i class="fa fa-check"></i><b>J.9.2</b> Trattamento dei dati mancanti</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-mod-hier-stan" class="section level1 hasAnchor" number="31">
<h1><span class="header-section-number">Capitolo 31</span> Modello gerarchico<a href="ch-mod-hier-stan.html#ch-mod-hier-stan" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="la-struttura-dei-dati" class="section level2 hasAnchor" number="31.1">
<h2><span class="header-section-number">31.1</span> La struttura dei dati<a href="ch-mod-hier-stan.html#la-struttura-dei-dati" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ricordiamo che una delle finalità più comuni di un modello è la specificazione delle relazioni di tipo causa-effetto, allo scopo di interpretare e prevedere i fenomeni reali. Per fare questo, è importante mettere in evidenza, da una molteplicità di informazioni ottenute su numerose unità statistiche, gli aspetti essenziali presenti nei dati. La scelta modello statistico da usare per l’analisi dipende dalle caratteristiche e dalla struttura dei dati.</p>
<p>La struttura dei dati può essere semplice o complessa, e ciò condiziona la scelta del modello statistico da usare per l’analisi.</p>
<ul>
<li>I dati a struttura semplice sono quelli per i quali non si rilevano particolari tipi di dipendenze o l’esistenza di particolari raggruppamenti delle osservazioni.</li>
<li>I dati a struttura complessa sono quelli per i quali le unità statistiche si trovano suddivise in sottoinsiemi all’interno dei quali possono essere specificate ipotesi diverse sulle componenti di errore del modello statistico. Tali raggruppamenti si possono presentare a uno o più livelli.</li>
</ul>
<p>Le strutture complesse dei dati possono essere suddivise tra le cosiddette strutture nested e quelle non-nested.</p>
</div>
<div id="struttura-nested" class="section level2 hasAnchor" number="31.2">
<h2><span class="header-section-number">31.2</span> Struttura Nested<a href="ch-mod-hier-stan.html#struttura-nested" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una struttura nested è quella in cui la gerarchia comporta l’esistenza di sottoinsiemi nidificati di osservazioni. In termini matematici una struttura nested è una partizione in gruppi di un insieme di unità. Ad esempio, gli studenti della scuola elementare (livello-1) di una città, sono nested nelle classi (livello-2) in cui studiano, a loro volta nested nelle scuole di appartenenza (livello-3), nested nel distretto di riferimento (livello-4). Nel caso di dati che hanno una struttura nested, le osservazioni individuali non risultano generalmente indipendenti: gli studenti di una stessa classe tendono ad avere un livello di formazione simile, a causa dei processi di selezione o a causa della comune storia che condividono. Una caratteristica fondamentale dei dati con struttura nested è dunque che gli individui che fanno parte del medesimo gruppo sono più somiglianti fra loro rispetto a quelli appartenenti a gruppi diversi.</p>
<p>Un caso particolare di struttura nested è quello delle cosiddette <em>misure ripetute</em>.
Le misure ripetute sono un esempio di struttura gerarchica che corrisponde alla situazione nella quale la stessa variabile è misurata in più di una occasione per ogni soggetto. Nell’analisi di dati a misure ripetute gli individui possono essere pensati come unità di secondo livello e le osservazioni ripetute come unità di primo livello.</p>
</div>
<div id="struttura-non-nested" class="section level2 hasAnchor" number="31.3">
<h2><span class="header-section-number">31.3</span> Struttura Non-Nested<a href="ch-mod-hier-stan.html#struttura-non-nested" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I dati hanno struttura non-nested quando non è definibile una partizione. Un esempio potrebbe derivare dai dati sullo studio di una qualche forma di disagio psicologico di un insieme di persone caratterizzate dal tipo di occupazione, il luogo di residenza e il luogo di lavoro. Questo è un caso non-nested in quanto la classificazione delle unità statistiche in base alle diverse variabili sopra considerate non produce la stessa suddivisione. Nell’esempio precedente di struttura non-nested i deti vengono detti <em>cross-classified</em>. I dati hanno struttura cosiddetta cross-classified quando ogni unità è classificata in base a due o più criteri tra loro non ordinati gerarchicamente.</p>
</div>
<div id="ragioni-di-utilizzo-della-struttura-gerarchica" class="section level2 hasAnchor" number="31.4">
<h2><span class="header-section-number">31.4</span> Ragioni di utilizzo della struttura gerarchica<a href="ch-mod-hier-stan.html#ragioni-di-utilizzo-della-struttura-gerarchica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>È importante includere nella formulazione del modello i vincoli che derivano dalla struttura dei dati perché ignorare la struttura di raggruppamento sottostante porta ad una violazione del presupposto di indipendenza che alla base dei modelli che abbiamo discusso fino a questo punto: le osservazioni all’interno di un gruppo sono infatti fra loro più simili rispetto a quelle di altri gruppi. I dati che hanno una struttura gerarchica, se vengono analizzati con modelli statistici che ignorano la dipendenza tra le osservazioni può produrre conclusioni fuorvianti. La metodologia multilivello fornisce un insieme di strumenti adatti ad analizzare simultaneamente variabili classificate a livelli differenti di gerarchia, con riferimento a modelli statistici che specificano le varie possibili forme di dipendenza. I modelli multilivello sono in grado di rendere conto dei vari livelli di osservazione: quello relativo all’individuo e quello cosiddetto contestuale che deriva da aggregazioni di individui.</p>
<p>Storicamente, le analisi di dati gerarchicamente organizzati sono state inizialmente realizzate mediante le tecniche standard (come l’analisi della varianza o l’analisi di regressione) spostando tutte le variabili su un solo livello di interesse. Ciò avveniva mediante due distinte procedure: aggregazione e disaggregazione. L’aggregazione è lo spostamento di variabili originariamente osservate su un livello basso della gerarchia verso un livello superiore. Al contrario, la disaggregazione è lo spostamento di variabili verso un livello più basso della gerarchia.</p>
<p>Mediante l’aggregazione dei dati (detta pooling) si ignora la struttura gerarchica dei dati. Si ipotizza che le differenze tra i gruppi siano spiegate solo dalle variabili esplicative <span class="math inline">\(X\)</span> (covariate), ignorando i possibili effetti della struttura gerarchica nei dati. Analizzare variabili che appartengono a differenti livelli della gerarchia su un singolo e comune livello può risultare inadeguato e presentare degli inconvenienti, che diventano tanto più gravi quanto più la gerarchia è rilevante nella spiegazione del fenomeno analizzato. In particolare, l’aggregazione comporta una sostanziale perdita di informazioni e, di conseguenza, l’analisi statistica perde precisione.</p>
<p>Dall’altro, quando i dati vengono disaggregati (no pooling), i test statistici ordinari considerano che i valori disaggregati siano, in genere, informazioni indipendenti provenienti dall’insieme della unità di basso livello: i dati appartenenti a cluster diversi vengono analizzati separatamente. Invece, nelle situazioni in cui i dati sono gerarchicamente organizzati, i diversi cluster di dati non sono in genere indipendenti.
<!-- Il comportamento degli individui è influenzato dal contesto nel quale sono inseriti e le caratteristiche di un gruppo sono influenzate dagli individui che formano il gruppo stesso: gli individui e il contesto possono essere visti come un sistema gerarchico di individui e gruppi, nel quale gli individui e i gruppi stanno a livelli diversi.  -->
I test statistici tradizionali sono basati sull’assunto di indipendenza tra tutte le osservazioni, e se questa ipotesi risulta violata, le stime degli errori standard, calcolate attraverso le procedure statistiche convenzionali, risultano distorte.</p>
<p>I modelli statistici che consentono di ottenere questo risultato si chiamano lineari misti, o modelli lineari gerarchici/multilivello, e sono diventati uno strumento fondamentale della ricerca sperimentale in psicologia, in linguistica e nelle scienze cognitive, dove i progetti di ricerca a misure ripetute sono la norma. In questo Capitolo esploreremo alcune tecniche che consentono di rendere conto della struttura gerarchica presente nei dati e discuteremo due esempi: il famoso problema delle otto scuole e il modello <em>Random Intercept Model</em>.</p>
</div>
<div id="il-problema-delle-8-scuole" class="section level2 hasAnchor" number="31.5">
<h2><span class="header-section-number">31.5</span> Il problema delle 8 scuole<a href="ch-mod-hier-stan.html#il-problema-delle-8-scuole" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il classico problema delle otto scuole <span class="citation">(<a href="#ref-rubin1981estimation" role="doc-biblioref">Rubin 1981</a>; questo esempio è anche discusso nel Capitolo 5 di <a href="#ref-gelman1995bayesian" role="doc-biblioref">Gelman et al. 1995</a>)</span> fornisce uno degli esempi più semplici di dati organizzati in maniera gerarchica e viene spesso usato per illustrare l’utilità di modellazione gerarchica. Il problema considera l’efficacia dei programmi di coaching SAT condotti in parallelo in otto scuole.</p>
<blockquote>
<p>Per conto del Servizio Prove Educative è stato condotto uno studio per analizzare gli effetti di speciali programmi di coaching per SAT-V (Scholastic Attitude Test-Verbal) in ciascuna delle otto scuole superiori. La variabile di esito in ogni studio era il punteggio su un’amministrazione speciale del SAT-V, un test a scelta multipla standardizzato somministrato dall’Educational Testing Service e utilizzato per aiutare i college a prendere decisioni di ammissione; i punteggi possono variare tra 200 e 800, con media circa 500 e deviazione standard circa 100. Gli esami SAT sono progettati per resistere a sforzi a breve termine diretti specificamente al miglioramento delle prestazioni del test; invece sono progettati per riflettere le conoscenze acquisite e le abilità sviluppate in molti anni di istruzione. Tuttavia, ciascuna delle otto scuole in questo studio ha considerato il suo programma di coaching a breve termine molto efficace nell’aumentare i punteggi SAT. Inoltre, non vi era alcuna ragione preliminare per ritenere che uno degli otto programmi fosse più efficace di un altro o che alcuni fossero più simili negli effetti l’uno all’altro che a qualsiasi altro.</p>
</blockquote>
<p>Per ciascuna delle otto scuole (<span class="math inline">\(J\)</span> = 8) abbiamo un effetto del trattamento stimato
e un errore standard di stima dell’effetto <span class="math inline">\(\sigma_j\)</span>. I dati sono i seguenti.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="ch-mod-hier-stan.html#cb468-1" aria-hidden="true" tabindex="-1"></a>schools <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb468-2"><a href="ch-mod-hier-stan.html#cb468-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;G&quot;</span>,<span class="st">&quot;H&quot;</span>),</span>
<span id="cb468-3"><a href="ch-mod-hier-stan.html#cb468-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect =</span> <span class="fu">c</span>(<span class="fl">28.39</span>,<span class="fl">7.94</span>,<span class="sc">-</span><span class="fl">2.75</span>,<span class="fl">6.82</span>,<span class="sc">-</span>.<span class="dv">64</span>,.<span class="dv">63</span>,<span class="fl">18.01</span>,<span class="fl">12.16</span>),</span>
<span id="cb468-4"><a href="ch-mod-hier-stan.html#cb468-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">14.9</span>, <span class="fl">10.2</span>, <span class="fl">16.3</span>, <span class="fl">11.0</span>, <span class="fl">9.4</span>, <span class="fl">11.4</span>, <span class="fl">10.4</span>, <span class="fl">17.6</span>)</span>
<span id="cb468-5"><a href="ch-mod-hier-stan.html#cb468-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb468-6"><a href="ch-mod-hier-stan.html#cb468-6" aria-hidden="true" tabindex="-1"></a>schools</span>
<span id="cb468-7"><a href="ch-mod-hier-stan.html#cb468-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span id="cb468-8"><a href="ch-mod-hier-stan.html#cb468-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   row.names effect sigma</span></span>
<span id="cb468-9"><a href="ch-mod-hier-stan.html#cb468-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb468-10"><a href="ch-mod-hier-stan.html#cb468-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 A          28.4   14.9</span></span>
<span id="cb468-11"><a href="ch-mod-hier-stan.html#cb468-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 B           7.94  10.2</span></span>
<span id="cb468-12"><a href="ch-mod-hier-stan.html#cb468-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 C          -2.75  16.3</span></span>
<span id="cb468-13"><a href="ch-mod-hier-stan.html#cb468-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 D           6.82  11  </span></span>
<span id="cb468-14"><a href="ch-mod-hier-stan.html#cb468-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 E          -0.64   9.4</span></span>
<span id="cb468-15"><a href="ch-mod-hier-stan.html#cb468-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 F           0.63  11.4</span></span>
<span id="cb468-16"><a href="ch-mod-hier-stan.html#cb468-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 G          18.0   10.4</span></span>
<span id="cb468-17"><a href="ch-mod-hier-stan.html#cb468-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 H          12.2   17.6</span></span></code></pre></div>
<p>Iniziamo calcolando una misura dell’effetto medio ponderato in cui il punteggio di ogni scuola viene ponderato in base alla precisione della misura (uno sul quadrato dell’errore standard).</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="ch-mod-hier-stan.html#cb469-1" aria-hidden="true" tabindex="-1"></a>schools<span class="sc">$</span>w <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> schools<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb469-2"><a href="ch-mod-hier-stan.html#cb469-2" aria-hidden="true" tabindex="-1"></a>schools_mean <span class="ot">&lt;-</span> <span class="fu">sum</span>(schools<span class="sc">$</span>w <span class="sc">*</span> schools<span class="sc">$</span>effect) <span class="sc">/</span> <span class="fu">sum</span>(schools<span class="sc">$</span>w)</span>
<span id="cb469-3"><a href="ch-mod-hier-stan.html#cb469-3" aria-hidden="true" tabindex="-1"></a>schools_mean</span>
<span id="cb469-4"><a href="ch-mod-hier-stan.html#cb469-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 7.870546</span></span></code></pre></div>
<p>Un grafico con i dati (media <span class="math inline">\(\pm\)</span> 1 SE) è fornito di seguito.</p>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-472-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Prima di adattare il modello gerarchico bayesiano, consideriamo due metodi non gerarchici più semplici, i quali stimando gli effetti degli otto esperimenti eseguendo un pooling completo dei dati oppure considerando le scuole come indipendenti (no pooling). Vedremo perché nessuno di questi approcci è adeguato per i dati di questo esempio.</p>
<div id="modello-di-complete-pooling" class="section level3 hasAnchor" number="31.5.1">
<h3><span class="header-section-number">31.5.1</span> Modello di <em>complete pooling</em><a href="ch-mod-hier-stan.html#modello-di-complete-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un esame superficiale dei dati potrebbe suggerire che alcuni programmi di coaching hanno effetti moderati (nell’intervallo 18–28 punti), la maggior parte ha piccoli effetti (0–12 punti) e due hanno piccoli effetti negativi; tuttavia, quando prendiamo atto degli errori standard di questi effetti stimati, vediamo che è difficile distinguere statisticamente tra i risultati di questi esperimenti. Potremmo dunque considerare i risultati degli otto esperimenti come esiti (condizionalmente) indipendenti dello stesso processo generativo. Di conseguenza potremmo decidere di procedere con un’<em>analisi aggregata</em> nella quale le otto scuole sono considerate come un unico campione.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="ch-mod-hier-stan.html#cb470-1" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb470-2"><a href="ch-mod-hier-stan.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb470-3"><a href="ch-mod-hier-stan.html#cb470-3" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=0&gt; J; // # schools</span></span>
<span id="cb470-4"><a href="ch-mod-hier-stan.html#cb470-4" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real y; // estimated treatment</span></span>
<span id="cb470-5"><a href="ch-mod-hier-stan.html#cb470-5" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real&lt;lower=0&gt; sigma; // std err of effect</span></span>
<span id="cb470-6"><a href="ch-mod-hier-stan.html#cb470-6" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb470-7"><a href="ch-mod-hier-stan.html#cb470-7" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb470-8"><a href="ch-mod-hier-stan.html#cb470-8" aria-hidden="true" tabindex="-1"></a><span class="st">    real theta; // pooled school effect</span></span>
<span id="cb470-9"><a href="ch-mod-hier-stan.html#cb470-9" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb470-10"><a href="ch-mod-hier-stan.html#cb470-10" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb470-11"><a href="ch-mod-hier-stan.html#cb470-11" aria-hidden="true" tabindex="-1"></a><span class="st">    y ~ normal(theta, sigma);</span></span>
<span id="cb470-12"><a href="ch-mod-hier-stan.html#cb470-12" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb470-13"><a href="ch-mod-hier-stan.html#cb470-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>I dati in un formato appropriato per Stan sono i seguenti.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="ch-mod-hier-stan.html#cb471-1" aria-hidden="true" tabindex="-1"></a>school8_dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb471-2"><a href="ch-mod-hier-stan.html#cb471-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">J =</span> <span class="fu">nrow</span>(schools),</span>
<span id="cb471-3"><a href="ch-mod-hier-stan.html#cb471-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> schools<span class="sc">$</span>effect,</span>
<span id="cb471-4"><a href="ch-mod-hier-stan.html#cb471-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> schools<span class="sc">$</span>sigma</span>
<span id="cb471-5"><a href="ch-mod-hier-stan.html#cb471-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Compiliamo il modello descritto in precedenza e eseguiamo il campionamento MCMC.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="ch-mod-hier-stan.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model_string, <span class="at">con =</span> <span class="st">&quot;code/hmod_2.stan&quot;</span>)</span>
<span id="cb472-2"><a href="ch-mod-hier-stan.html#cb472-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;hmod_2.stan&quot;</span>)</span>
<span id="cb472-3"><a href="ch-mod-hier-stan.html#cb472-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-4"><a href="ch-mod-hier-stan.html#cb472-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb472-5"><a href="ch-mod-hier-stan.html#cb472-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-6"><a href="ch-mod-hier-stan.html#cb472-6" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb472-7"><a href="ch-mod-hier-stan.html#cb472-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> school8_dat,</span>
<span id="cb472-8"><a href="ch-mod-hier-stan.html#cb472-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 20000L,</span>
<span id="cb472-9"><a href="ch-mod-hier-stan.html#cb472-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 10000L,</span>
<span id="cb472-10"><a href="ch-mod-hier-stan.html#cb472-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">84735</span>,</span>
<span id="cb472-11"><a href="ch-mod-hier-stan.html#cb472-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb472-12"><a href="ch-mod-hier-stan.html#cb472-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb472-13"><a href="ch-mod-hier-stan.html#cb472-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb472-14"><a href="ch-mod-hier-stan.html#cb472-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running MCMC with 4 sequential chains...</span></span>
<span id="cb472-15"><a href="ch-mod-hier-stan.html#cb472-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb472-16"><a href="ch-mod-hier-stan.html#cb472-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1 finished in 0.3 seconds.</span></span>
<span id="cb472-17"><a href="ch-mod-hier-stan.html#cb472-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2 finished in 0.3 seconds.</span></span>
<span id="cb472-18"><a href="ch-mod-hier-stan.html#cb472-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3 finished in 0.2 seconds.</span></span>
<span id="cb472-19"><a href="ch-mod-hier-stan.html#cb472-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4 finished in 0.2 seconds.</span></span>
<span id="cb472-20"><a href="ch-mod-hier-stan.html#cb472-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb472-21"><a href="ch-mod-hier-stan.html#cb472-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span id="cb472-22"><a href="ch-mod-hier-stan.html#cb472-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean chain execution time: 0.3 seconds.</span></span>
<span id="cb472-23"><a href="ch-mod-hier-stan.html#cb472-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total execution time: 1.4 seconds.</span></span></code></pre></div>
<p>Nel caso di un’analisi per dati aggregati, la nostra incertezza sulla misura dell’effetto comune è di circa 20 punti, se utilizziamo un livello di certezza soggettiva del 95%. Visualizziamo la stima a posteriori con l’istruzione seguente, dove</p>
<ul>
<li>ci_level: 0.8 (80% intervals)</li>
<li>outer_level: 0.95 (95% intervals)</li>
</ul>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="ch-mod-hier-stan.html#cb473-1" aria-hidden="true" tabindex="-1"></a>output2_stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit2<span class="sc">$</span><span class="fu">output_files</span>()) </span>
<span id="cb473-2"><a href="ch-mod-hier-stan.html#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(output2_stanfit) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">50</span>, <span class="dv">60</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-476-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In base ad un’analisi aggregata (complete pooling) concludiamo che i dati sono realizzazioni indipendenti di una v.c. <span class="math inline">\(\sim \mathcal{N}(\mu = 7.87, \sigma = 4.20)\)</span>.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="ch-mod-hier-stan.html#cb474-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="sc">$</span><span class="fu">summary</span>()</span>
<span id="cb474-2"><a href="ch-mod-hier-stan.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span id="cb474-3"><a href="ch-mod-hier-stan.html#cb474-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable  mean median    sd   mad     q5   q95  rhat ess_bulk ess_tail</span></span>
<span id="cb474-4"><a href="ch-mod-hier-stan.html#cb474-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb474-5"><a href="ch-mod-hier-stan.html#cb474-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 lp__     -2.79  -2.52 0.713 0.320 -4.23  -2.28  1.00   37470.   51279.</span></span>
<span id="cb474-6"><a href="ch-mod-hier-stan.html#cb474-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 theta     7.87   7.88 4.20  4.23   0.962 14.7   1.00   28992.   44067.</span></span></code></pre></div>
<p>Ma è ragionevole concludere quanto detto sopra? Un primo problema dell’analisi aggregata è che è impossibile fare inferenza sui gruppi, ovvero, nel caso presente, sugli effetti dei diversi metodi di coaching (e questa era la motivazione stessa dell’analisi).</p>
<p>Un secondo problema è più strettamente statistico. Se assumiamo che il processo generativo sia <span class="math inline">\(\mathcal{N}(\mu = 7.87, \sigma = 4.20)\)</span>, allora possiamo chiederci quale sia la probabilità di osservare i dati del campione (o valori ancora più estremi). Il valore più estremo del nostro campione è 28.4. Se il modello generativo fosse <span class="math inline">\(\mathcal{N}(\mu = 7.87, \sigma = 4.20)\)</span>, la probabilità di osservare i dati della scuola 1 sarebbe estremamente piccola.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="ch-mod-hier-stan.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">28.4</span>, <span class="fl">7.87</span>, <span class="fl">4.20</span>)</span>
<span id="cb475-2"><a href="ch-mod-hier-stan.html#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5.090814e-07</span></span></code></pre></div>
<p>Un’analisi aggregata (modello di complete pooling), dunque, non è neppure in grado di rendere conto dei dati del campione osservato (ci dice che un certo dato non dovrebbe verificarsi; ma l’abbiamo osservato). Il modello di complete pooling, dunque, non sembra adeguato per i dati considerati.</p>
<!-- L'intervallo così trovato corrisponde all'intervallo frequentista al 95%. Infatti, dato che, in questo modello, le osservazioni sono ritenute essere v.c. indipendenti, la varianza di una somma è una somma di varianze.  In questo caso $\sigma$ è il reciproco della varianza, per cui la stima della varianza comune è data da: -->
<!-- ```{r} -->
<!-- var <- 1 / (sum(1 / schools$sigma^2)) -->
<!-- var -->
<!-- ``` -->
<!-- L'intervallo frequentista del 95% sarà dunque -->
<!-- ```{r} -->
<!-- n <- 1 -->
<!-- schools_mean + c(-1, 1) * qnorm(0.975) * sqrt(var / n) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- output2_stanfit -->
<!-- ``` -->
</div>
<div id="modello-no-pooling" class="section level3 hasAnchor" number="31.5.2">
<h3><span class="header-section-number">31.5.2</span> Modello <em>no pooling</em><a href="ch-mod-hier-stan.html#modello-no-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Avendo rifiutato il modello compelte pooling, consideriamo ora il modello che si trova all’estremo opposto (modello no pooling). Eseguiamo dunque un’<em>analisi disaggregata</em> nella quale ogni scuola è trattata in maniera indipendente dalle altre. In linguaggio Stan, il modello no pooling può essere formulato nel modo seguente.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="ch-mod-hier-stan.html#cb476-1" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb476-2"><a href="ch-mod-hier-stan.html#cb476-2" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb476-3"><a href="ch-mod-hier-stan.html#cb476-3" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=0&gt; J; // # schools</span></span>
<span id="cb476-4"><a href="ch-mod-hier-stan.html#cb476-4" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real y; // estimated treatment</span></span>
<span id="cb476-5"><a href="ch-mod-hier-stan.html#cb476-5" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real&lt;lower=0&gt; sigma; // std err of effect</span></span>
<span id="cb476-6"><a href="ch-mod-hier-stan.html#cb476-6" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb476-7"><a href="ch-mod-hier-stan.html#cb476-7" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb476-8"><a href="ch-mod-hier-stan.html#cb476-8" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real theta; // school effect</span></span>
<span id="cb476-9"><a href="ch-mod-hier-stan.html#cb476-9" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb476-10"><a href="ch-mod-hier-stan.html#cb476-10" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb476-11"><a href="ch-mod-hier-stan.html#cb476-11" aria-hidden="true" tabindex="-1"></a><span class="st">    y ~ normal(theta, sigma);</span></span>
<span id="cb476-12"><a href="ch-mod-hier-stan.html#cb476-12" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb476-13"><a href="ch-mod-hier-stan.html#cb476-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>Eseguiamo l’analisi.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="ch-mod-hier-stan.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model_string, <span class="at">con =</span> <span class="st">&quot;code/hmod_1.stan&quot;</span>)</span>
<span id="cb477-2"><a href="ch-mod-hier-stan.html#cb477-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;hmod_1.stan&quot;</span>)</span>
<span id="cb477-3"><a href="ch-mod-hier-stan.html#cb477-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-4"><a href="ch-mod-hier-stan.html#cb477-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb477-5"><a href="ch-mod-hier-stan.html#cb477-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-6"><a href="ch-mod-hier-stan.html#cb477-6" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb477-7"><a href="ch-mod-hier-stan.html#cb477-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> school8_dat,</span>
<span id="cb477-8"><a href="ch-mod-hier-stan.html#cb477-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 20000L,</span>
<span id="cb477-9"><a href="ch-mod-hier-stan.html#cb477-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 10000L,</span>
<span id="cb477-10"><a href="ch-mod-hier-stan.html#cb477-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">84735</span>,</span>
<span id="cb477-11"><a href="ch-mod-hier-stan.html#cb477-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb477-12"><a href="ch-mod-hier-stan.html#cb477-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb477-13"><a href="ch-mod-hier-stan.html#cb477-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb477-14"><a href="ch-mod-hier-stan.html#cb477-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running MCMC with 4 sequential chains...</span></span>
<span id="cb477-15"><a href="ch-mod-hier-stan.html#cb477-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb477-16"><a href="ch-mod-hier-stan.html#cb477-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1 finished in 0.5 seconds.</span></span>
<span id="cb477-17"><a href="ch-mod-hier-stan.html#cb477-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2 finished in 0.5 seconds.</span></span>
<span id="cb477-18"><a href="ch-mod-hier-stan.html#cb477-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3 finished in 0.5 seconds.</span></span>
<span id="cb477-19"><a href="ch-mod-hier-stan.html#cb477-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4 finished in 0.6 seconds.</span></span>
<span id="cb477-20"><a href="ch-mod-hier-stan.html#cb477-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb477-21"><a href="ch-mod-hier-stan.html#cb477-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span id="cb477-22"><a href="ch-mod-hier-stan.html#cb477-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean chain execution time: 0.5 seconds.</span></span>
<span id="cb477-23"><a href="ch-mod-hier-stan.html#cb477-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total execution time: 2.5 seconds.</span></span></code></pre></div>
<p>I risultati sono i seguenti.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="ch-mod-hier-stan.html#cb478-1" aria-hidden="true" tabindex="-1"></a>fit1<span class="sc">$</span><span class="fu">summary</span>()</span>
<span id="cb478-2"><a href="ch-mod-hier-stan.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 9 × 10</span></span>
<span id="cb478-3"><a href="ch-mod-hier-stan.html#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable   mean median    sd   mad      q5   q95  rhat ess_bulk ess_tail</span></span>
<span id="cb478-4"><a href="ch-mod-hier-stan.html#cb478-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb478-5"><a href="ch-mod-hier-stan.html#cb478-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 lp__     -3.99  -3.66   2.00  1.85  -7.78  -1.36  1.00   39035.   56040.</span></span>
<span id="cb478-6"><a href="ch-mod-hier-stan.html#cb478-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 theta[1] 28.3   28.3   14.8  14.8    4.04  52.8   1.00  117783.   64274.</span></span>
<span id="cb478-7"><a href="ch-mod-hier-stan.html#cb478-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 theta[2]  7.92   7.91  10.2  10.2   -8.84  24.7   1.00  116382.   62867.</span></span>
<span id="cb478-8"><a href="ch-mod-hier-stan.html#cb478-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 theta[3] -2.80  -2.79  16.3  16.3  -29.6   23.9   1.00  120074.   61773.</span></span>
<span id="cb478-9"><a href="ch-mod-hier-stan.html#cb478-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 theta[4]  6.83   6.85  11.0  11.0  -11.2   24.8   1.00  114806.   63734.</span></span>
<span id="cb478-10"><a href="ch-mod-hier-stan.html#cb478-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 theta[5] -0.686 -0.685  9.36  9.37 -16.0   14.7   1.00  116956.   63114.</span></span>
<span id="cb478-11"><a href="ch-mod-hier-stan.html#cb478-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 theta[6]  0.642  0.618 11.3  11.4  -18.0   19.3   1.00  113520.   62691.</span></span>
<span id="cb478-12"><a href="ch-mod-hier-stan.html#cb478-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 theta[7] 18.0   18.0   10.5  10.5    0.656 35.2   1.00  114082.   61308.</span></span>
<span id="cb478-13"><a href="ch-mod-hier-stan.html#cb478-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1 more row</span></span></code></pre></div>
<p>Visualizziamo l’incertezza delle stime a posteriori.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="ch-mod-hier-stan.html#cb479-1" aria-hidden="true" tabindex="-1"></a>output_stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit1<span class="sc">$</span><span class="fu">output_files</span>()) </span></code></pre></div>
<p>Si vede che le stime degli effetti degli otto esperimenti producono intervalli di credibilità al 95% che sono quasi completamente sovrapposti. L’ampiezza degli intervalli, ad un grado di certezza soggettiva del 95%, è di circa 50 punti.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="ch-mod-hier-stan.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(output_stanfit) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">50</span>, <span class="dv">60</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-483-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Dal momento che ciascuna stima dipende <em>unicamente</em> dai dati di una singola osservazione, l’inferenza sui parametri sconosciuti del modello no pooling è estremamente rumorosa.</p>
</div>
<div id="modello-partial-pooling" class="section level3 hasAnchor" number="31.5.3">
<h3><span class="header-section-number">31.5.3</span> Modello <em>partial pooling</em><a href="ch-mod-hier-stan.html#modello-partial-pooling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Avendo concluso che i modelli complete pooling e non-pooling sono inadeguati, consideriamo ora un modello gerarchico. In generale, i modelli gerarchici sono basati sulla seguente idea: sebbene ogni gruppo sia unico, essendo stato campionato dalla stessa popolazione, tutti i gruppi sono collegati e quindi potrebbero contenere informazioni preziose l’uno sull’altro. Questa informazione gerarchica è fornita dagli <em>iper-parametri</em> del modello.</p>
<p>La struttura ipotizzata da un modello gerarchico per i dati considerati è la seguente. Il modello gerarchico ipotizza che il risultato di ciascuna scuola sia la realizzazione di una v.c. avente media <span class="math inline">\(\theta_j\)</span>. L’oggetto dell’inferenza sono i valori <span class="math inline">\(\theta_j\)</span>, con <span class="math inline">\(i = 1, \dots, 8\)</span>. Il modello gerarchico ipotizza che i parametri <span class="math inline">\(\theta_j\)</span> siano tra loro legati in qualche modo. In maniera più precisa, il modello assume che <span class="math inline">\(\theta_j\)</span> siano realizzazioni casuali dei un unico processo generativo sottostante. Il modello assume che tale processo generativo abbia la seguente forma: <span class="math inline">\(\mathcal{N}(\mu, \tau)\)</span>. I parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\tau\)</span> sono detti <em>iper-parametri</em> e condizionano i valori possibili che i parametri <span class="math inline">\(\theta_j\)</span> possono assumere. Nella versione più semplice di questo modello gerarchico, l’iper-parametro <span class="math inline">\(\mu\)</span> viene considerato ignoto ma <span class="math inline">\(\tau\)</span> viene assunto come conosciuto. Ciò conduce alla formulazione del modello partial pooling. Nel caso presente assumiamo <span class="math inline">\(\tau = 25\)</span>.</p>
<p>Inseriamo in input a Stan l’informazione relativa a <span class="math inline">\(\tau\)</span>.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="ch-mod-hier-stan.html#cb481-1" aria-hidden="true" tabindex="-1"></a>school8_dat2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb481-2"><a href="ch-mod-hier-stan.html#cb481-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">J =</span> <span class="fu">nrow</span>(schools),</span>
<span id="cb481-3"><a href="ch-mod-hier-stan.html#cb481-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> schools<span class="sc">$</span>effect,</span>
<span id="cb481-4"><a href="ch-mod-hier-stan.html#cb481-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> schools<span class="sc">$</span>sigma,</span>
<span id="cb481-5"><a href="ch-mod-hier-stan.html#cb481-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau =</span> <span class="dv">25</span></span>
<span id="cb481-6"><a href="ch-mod-hier-stan.html#cb481-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Formuliamo il modello di partial pooling nel modo seguente.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="ch-mod-hier-stan.html#cb482-1" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb482-2"><a href="ch-mod-hier-stan.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb482-3"><a href="ch-mod-hier-stan.html#cb482-3" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=0&gt; J; // # schools</span></span>
<span id="cb482-4"><a href="ch-mod-hier-stan.html#cb482-4" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real y; // estimated treatment</span></span>
<span id="cb482-5"><a href="ch-mod-hier-stan.html#cb482-5" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real&lt;lower=0&gt; sigma; // std err of effect</span></span>
<span id="cb482-6"><a href="ch-mod-hier-stan.html#cb482-6" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; tau; // variance between schools</span></span>
<span id="cb482-7"><a href="ch-mod-hier-stan.html#cb482-7" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb482-8"><a href="ch-mod-hier-stan.html#cb482-8" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb482-9"><a href="ch-mod-hier-stan.html#cb482-9" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real theta; // school effect</span></span>
<span id="cb482-10"><a href="ch-mod-hier-stan.html#cb482-10" aria-hidden="true" tabindex="-1"></a><span class="st">    real mu; // mean for schools</span></span>
<span id="cb482-11"><a href="ch-mod-hier-stan.html#cb482-11" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb482-12"><a href="ch-mod-hier-stan.html#cb482-12" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb482-13"><a href="ch-mod-hier-stan.html#cb482-13" aria-hidden="true" tabindex="-1"></a><span class="st">    mu ~ normal(0, 15);</span></span>
<span id="cb482-14"><a href="ch-mod-hier-stan.html#cb482-14" aria-hidden="true" tabindex="-1"></a><span class="st">    theta ~ normal(mu, tau);</span></span>
<span id="cb482-15"><a href="ch-mod-hier-stan.html#cb482-15" aria-hidden="true" tabindex="-1"></a><span class="st">    y ~ normal(theta, sigma);</span></span>
<span id="cb482-16"><a href="ch-mod-hier-stan.html#cb482-16" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb482-17"><a href="ch-mod-hier-stan.html#cb482-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>Eseguiamo l’analisi.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="ch-mod-hier-stan.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model_string, <span class="at">con =</span> <span class="st">&quot;code/hmod_3.stan&quot;</span>)</span>
<span id="cb483-2"><a href="ch-mod-hier-stan.html#cb483-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;hmod_3.stan&quot;</span>)</span>
<span id="cb483-3"><a href="ch-mod-hier-stan.html#cb483-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-4"><a href="ch-mod-hier-stan.html#cb483-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb483-5"><a href="ch-mod-hier-stan.html#cb483-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb483-6"><a href="ch-mod-hier-stan.html#cb483-6" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb483-7"><a href="ch-mod-hier-stan.html#cb483-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> school8_dat2,</span>
<span id="cb483-8"><a href="ch-mod-hier-stan.html#cb483-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 20000L,</span>
<span id="cb483-9"><a href="ch-mod-hier-stan.html#cb483-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 10000L,</span>
<span id="cb483-10"><a href="ch-mod-hier-stan.html#cb483-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">84735</span>,</span>
<span id="cb483-11"><a href="ch-mod-hier-stan.html#cb483-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb483-12"><a href="ch-mod-hier-stan.html#cb483-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb483-13"><a href="ch-mod-hier-stan.html#cb483-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb483-14"><a href="ch-mod-hier-stan.html#cb483-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running MCMC with 4 sequential chains...</span></span>
<span id="cb483-15"><a href="ch-mod-hier-stan.html#cb483-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb483-16"><a href="ch-mod-hier-stan.html#cb483-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1 finished in 0.5 seconds.</span></span>
<span id="cb483-17"><a href="ch-mod-hier-stan.html#cb483-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2 finished in 0.5 seconds.</span></span>
<span id="cb483-18"><a href="ch-mod-hier-stan.html#cb483-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3 finished in 0.6 seconds.</span></span>
<span id="cb483-19"><a href="ch-mod-hier-stan.html#cb483-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4 finished in 0.6 seconds.</span></span>
<span id="cb483-20"><a href="ch-mod-hier-stan.html#cb483-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb483-21"><a href="ch-mod-hier-stan.html#cb483-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span id="cb483-22"><a href="ch-mod-hier-stan.html#cb483-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean chain execution time: 0.6 seconds.</span></span>
<span id="cb483-23"><a href="ch-mod-hier-stan.html#cb483-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total execution time: 2.6 seconds.</span></span></code></pre></div>
<p>Esaminiamo la distribuzione a posteriori delle stime dei parametri.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="ch-mod-hier-stan.html#cb484-1" aria-hidden="true" tabindex="-1"></a>output3_stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit3<span class="sc">$</span><span class="fu">output_files</span>()) </span>
<span id="cb484-2"><a href="ch-mod-hier-stan.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(output3_stanfit) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">50</span>, <span class="dv">60</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-487-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Per il modello di partial pooling, ad un livello di certezza soggettiva del 95%, le stime a posteriori dei parametri <span class="math inline">\(\theta_j\)</span> sono comprese in un intervallo pari a circa 40 punti. Si noti che, in relazione al modello no pooling, è diminuita la nostra incertezza rispetto alle stime dei parametri <span class="math inline">\(\theta_j\)</span>.</p>
</div>
<div id="modello-gerarchico" class="section level3 hasAnchor" number="31.5.4">
<h3><span class="header-section-number">31.5.4</span> Modello gerarchico<a href="ch-mod-hier-stan.html#modello-gerarchico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il modello di partial pooling assume che la dispersione dei parametri <span class="math inline">\(\theta_j\)</span> sia conosciuta. Ma ovviamente ciò non è vero. Arriviamo così alla formulazione del modello gerarchico nel quale vengono stimati entrambi gli iper-parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\tau\)</span>, dove <span class="math inline">\(\mu\)</span> rappresenta l’effetto medio del trattamento e <span class="math inline">\(\tau\)</span> descrive la varianza tra le scuole. Il modello gerarchico è dunque il seguente.</p>
<p><span class="math display">\[
\begin{align}
y_j &amp;\sim \mathcal{N}(\theta_j, \sigma_j), \quad j = 1, \dots, 8\notag\\
\theta_j &amp;\sim \mathcal{N}(\mu, \tau), \quad j = 1, \dots, 8
\end{align}
\]</span></p>
<p>dove ciascun <span class="math inline">\(\sigma_j\)</span> è considerato noto.</p>
<p>Lo scriviamo in linguaggio Stan nel modo seguente.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="ch-mod-hier-stan.html#cb485-1" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb485-2"><a href="ch-mod-hier-stan.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb485-3"><a href="ch-mod-hier-stan.html#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=0&gt; J; // # schools</span></span>
<span id="cb485-4"><a href="ch-mod-hier-stan.html#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real y; // estimated treatment</span></span>
<span id="cb485-5"><a href="ch-mod-hier-stan.html#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real&lt;lower=0&gt; sigma; // std err of effect</span></span>
<span id="cb485-6"><a href="ch-mod-hier-stan.html#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb485-7"><a href="ch-mod-hier-stan.html#cb485-7" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb485-8"><a href="ch-mod-hier-stan.html#cb485-8" aria-hidden="true" tabindex="-1"></a><span class="st">    array[J] real theta; // school effect</span></span>
<span id="cb485-9"><a href="ch-mod-hier-stan.html#cb485-9" aria-hidden="true" tabindex="-1"></a><span class="st">    real mu; // mean for schools</span></span>
<span id="cb485-10"><a href="ch-mod-hier-stan.html#cb485-10" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; tau; // variance between schools</span></span>
<span id="cb485-11"><a href="ch-mod-hier-stan.html#cb485-11" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb485-12"><a href="ch-mod-hier-stan.html#cb485-12" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb485-13"><a href="ch-mod-hier-stan.html#cb485-13" aria-hidden="true" tabindex="-1"></a><span class="st">    mu ~ normal(0, 15);</span></span>
<span id="cb485-14"><a href="ch-mod-hier-stan.html#cb485-14" aria-hidden="true" tabindex="-1"></a><span class="st">    tau ~ cauchy(0, 30);</span></span>
<span id="cb485-15"><a href="ch-mod-hier-stan.html#cb485-15" aria-hidden="true" tabindex="-1"></a><span class="st">    theta ~ normal(mu, tau);</span></span>
<span id="cb485-16"><a href="ch-mod-hier-stan.html#cb485-16" aria-hidden="true" tabindex="-1"></a><span class="st">    y ~ normal(theta, sigma);</span></span>
<span id="cb485-17"><a href="ch-mod-hier-stan.html#cb485-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb485-18"><a href="ch-mod-hier-stan.html#cb485-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>Eseguiamo l’analisi.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="ch-mod-hier-stan.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(model_string, <span class="at">con =</span> <span class="st">&quot;code/hmod_4.stan&quot;</span>)</span>
<span id="cb486-2"><a href="ch-mod-hier-stan.html#cb486-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;hmod_4.stan&quot;</span>)</span>
<span id="cb486-3"><a href="ch-mod-hier-stan.html#cb486-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-4"><a href="ch-mod-hier-stan.html#cb486-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb486-5"><a href="ch-mod-hier-stan.html#cb486-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-6"><a href="ch-mod-hier-stan.html#cb486-6" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb486-7"><a href="ch-mod-hier-stan.html#cb486-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> school8_dat,</span>
<span id="cb486-8"><a href="ch-mod-hier-stan.html#cb486-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 20000L,</span>
<span id="cb486-9"><a href="ch-mod-hier-stan.html#cb486-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 10000L,</span>
<span id="cb486-10"><a href="ch-mod-hier-stan.html#cb486-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">84735</span>,</span>
<span id="cb486-11"><a href="ch-mod-hier-stan.html#cb486-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb486-12"><a href="ch-mod-hier-stan.html#cb486-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb486-13"><a href="ch-mod-hier-stan.html#cb486-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb486-14"><a href="ch-mod-hier-stan.html#cb486-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running MCMC with 4 sequential chains...</span></span>
<span id="cb486-15"><a href="ch-mod-hier-stan.html#cb486-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb486-16"><a href="ch-mod-hier-stan.html#cb486-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1 finished in 1.0 seconds.</span></span>
<span id="cb486-17"><a href="ch-mod-hier-stan.html#cb486-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2 finished in 1.3 seconds.</span></span>
<span id="cb486-18"><a href="ch-mod-hier-stan.html#cb486-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3 finished in 1.0 seconds.</span></span>
<span id="cb486-19"><a href="ch-mod-hier-stan.html#cb486-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4 finished in 1.0 seconds.</span></span>
<span id="cb486-20"><a href="ch-mod-hier-stan.html#cb486-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb486-21"><a href="ch-mod-hier-stan.html#cb486-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span id="cb486-22"><a href="ch-mod-hier-stan.html#cb486-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean chain execution time: 1.1 seconds.</span></span>
<span id="cb486-23"><a href="ch-mod-hier-stan.html#cb486-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total execution time: 4.7 seconds.</span></span></code></pre></div>
<p>Le stime dei parametri sono le seguenti.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="ch-mod-hier-stan.html#cb487-1" aria-hidden="true" tabindex="-1"></a>output4_stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit4<span class="sc">$</span><span class="fu">output_files</span>()) </span>
<span id="cb487-2"><a href="ch-mod-hier-stan.html#cb487-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(output4_stanfit, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;tau&quot;</span>), <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>))</span>
<span id="cb487-3"><a href="ch-mod-hier-stan.html#cb487-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Inference for Stan model: hmod_4-202205032342-1-380e90.</span></span>
<span id="cb487-4"><a href="ch-mod-hier-stan.html#cb487-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter=30000; warmup=10000; thin=1; </span></span>
<span id="cb487-5"><a href="ch-mod-hier-stan.html#cb487-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; post-warmup draws per chain=20000, total post-warmup draws=80000.</span></span>
<span id="cb487-6"><a href="ch-mod-hier-stan.html#cb487-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb487-7"><a href="ch-mod-hier-stan.html#cb487-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           mean se_mean   sd   2.5%  50% 97.5% n_eff Rhat</span></span>
<span id="cb487-8"><a href="ch-mod-hier-stan.html#cb487-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[1] 10.23    0.50 7.93  -2.14 9.06 29.52   248 1.02</span></span>
<span id="cb487-9"><a href="ch-mod-hier-stan.html#cb487-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[2]  7.14    0.26 6.05  -4.70 6.98 19.59   536 1.01</span></span>
<span id="cb487-10"><a href="ch-mod-hier-stan.html#cb487-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[3]  5.61    0.12 7.34 -10.90 5.81 19.56  3766 1.00</span></span>
<span id="cb487-11"><a href="ch-mod-hier-stan.html#cb487-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[4]  6.87    0.30 6.29  -5.61 6.78 19.77   439 1.01</span></span>
<span id="cb487-12"><a href="ch-mod-hier-stan.html#cb487-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[5]  4.89    0.11 6.04  -8.37 5.05 16.10  3163 1.00</span></span>
<span id="cb487-13"><a href="ch-mod-hier-stan.html#cb487-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[6]  5.54    0.18 6.46  -8.42 5.61 17.88  1317 1.01</span></span>
<span id="cb487-14"><a href="ch-mod-hier-stan.html#cb487-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[7]  9.49    0.48 6.66  -1.65 8.86 24.66   193 1.03</span></span>
<span id="cb487-15"><a href="ch-mod-hier-stan.html#cb487-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; theta[8]  7.60    0.22 7.35  -6.79 7.24 23.62  1159 1.01</span></span>
<span id="cb487-16"><a href="ch-mod-hier-stan.html#cb487-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu        6.94    0.29 4.71  -2.09 6.92 16.43   272 1.02</span></span>
<span id="cb487-17"><a href="ch-mod-hier-stan.html#cb487-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tau       5.93    0.39 4.85   0.64 4.74 18.11   154 1.03</span></span>
<span id="cb487-18"><a href="ch-mod-hier-stan.html#cb487-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb487-19"><a href="ch-mod-hier-stan.html#cb487-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Mar Mag 03 23:42:38 2022.</span></span>
<span id="cb487-20"><a href="ch-mod-hier-stan.html#cb487-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb487-21"><a href="ch-mod-hier-stan.html#cb487-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split chains (at </span></span>
<span id="cb487-22"><a href="ch-mod-hier-stan.html#cb487-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; convergence, Rhat=1).</span></span></code></pre></div>
<p>Visualizziamo la distribuzione a posteriori delle stime dei parametri e degli iper-parametri.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="ch-mod-hier-stan.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(output4_stanfit) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">50</span>, <span class="dv">60</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-491-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Con un grado di certezza soggettiva del 95%, le stime a posteriori dei parametri <span class="math inline">\(\theta_j\)</span> risultano comprese in un intervallo pari a circa 30 punti. Il modello gerarchico, dunque, produce stime degli effetti <span class="math inline">\(\theta_j\)</span> a cui è associata l’incertezza più piccola rispetto a tutti gli altri casi esaminati in precedenza.</p>
</div>
<div id="interpretazione-3" class="section level3 hasAnchor" number="31.5.5">
<h3><span class="header-section-number">31.5.5</span> Interpretazione<a href="ch-mod-hier-stan.html#interpretazione-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In conclusione, il modello gerarchico consente di ottenere stime degli effetti <span class="math inline">\(\theta_j\)</span> degli otto esperimenti più precise di quelle ottenute dal modelo non gerarchico no-pooling e dal modello gerarchico di partial pooling. Si noti inoltre che, con <span class="math inline">\(\tau \rightarrow \infty\)</span>, le stime di un modello gerarchico diventano sempre più simili a quelle di un modello no-pooling, vale a dire, ciascuna delle stime dell’effetto del trattamento della scuola diventa via via più indipendente dalle altre stime. Con <span class="math inline">\(\tau \rightarrow 0\)</span>, le stime di un modello gerarchico diventano sempre più simili alle stime di un modello di pooling completo, vale a dire, tutti gli effetti del trattamento della scuola tendono a diventare via via più simili all’effetto medio del gruppo.</p>
</div>
</div>
<div id="modelli-lineari-ad-intercetta-casuale" class="section level2 hasAnchor" number="31.6">
<h2><span class="header-section-number">31.6</span> Modelli lineari ad intercetta casuale<a href="ch-mod-hier-stan.html#modelli-lineari-ad-intercetta-casuale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Esaminiamo ora un modello gerarchico più complesso per l’analisi di un set di dati a misure ripetute con due condizioni. I dati sono stati raccolti da <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>; si veda <a href="#ref-sorensen2015bayesian" role="doc-biblioref">Sorensen and Vasishth 2015</a>)</span>. La variabile dipendente <code>rt</code> dell’esperimento di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>)</span> è il tempo di lettura in millisecondi del soggetto di una proposizione relativa in un testo. I tempi di reazione sono stati registrati in due condizioni: in presenza di un sostantivo riferito al soggetto della proposizione, oppure in presenza di un sostantivo riferito all’oggetto della proposizione.</p>
<p>I dati di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>)</span> provengono da un esperimento con 37 soggetti e 15 item. Gli item erano presentati in un disegno a quadrato latino (ovvero, un disegno nel quale vengono considerate tutte le combinazioni possibili), il che produce 37 <span class="math inline">\(\times\)</span> 15 = 555 dati. Risultano mancanti otto dati di un soggetto (id 27), il che porta ad un totale di 555 − 8 = 547 dati. Le prime righe del data.frame sono mostrate di seguito:</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="ch-mod-hier-stan.html#cb489-1" aria-hidden="true" tabindex="-1"></a>rdat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;gibsonwu2012data.txt&quot;</span>))</span>
<span id="cb489-2"><a href="ch-mod-hier-stan.html#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rdat)</span>
<span id="cb489-3"><a href="ch-mod-hier-stan.html#cb489-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    subj item     type pos word correct   rt region            type2</span></span>
<span id="cb489-4"><a href="ch-mod-hier-stan.html#cb489-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7     1   13  obj-ext   6 抓住       - 1140    de1  object relative</span></span>
<span id="cb489-5"><a href="ch-mod-hier-stan.html#cb489-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20    1    6 subj-ext   6 男孩       - 1197    de1 subject relative</span></span>
<span id="cb489-6"><a href="ch-mod-hier-stan.html#cb489-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32    1    5  obj-ext   6   撞       -  756    de1  object relative</span></span>
<span id="cb489-7"><a href="ch-mod-hier-stan.html#cb489-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44    1    9  obj-ext   6 監視       -  643    de1  object relative</span></span>
<span id="cb489-8"><a href="ch-mod-hier-stan.html#cb489-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 60    1   14 subj-ext   6 機師       -  860    de1 subject relative</span></span>
<span id="cb489-9"><a href="ch-mod-hier-stan.html#cb489-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 73    1    4 subj-ext   6 男孩       -  868    de1 subject relative</span></span></code></pre></div>
<p>La manipolazione sperimentale viene descritta dalla variabile <code>type</code> (oppure, in maniera equivalente, dalla variabile <code>type2</code>). Nell’analisi, <code>type</code> viene ricodificata nella colonna <code>so</code> la quale assume valore -0.5 se il sostantivo era riferito al soggetto e +0.5 se il sostantivo era riferito all’oggetto della frase.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="ch-mod-hier-stan.html#cb490-1" aria-hidden="true" tabindex="-1"></a>rdat<span class="sc">$</span>so <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(rdat<span class="sc">$</span>type <span class="sc">==</span> <span class="st">&quot;subj-ext&quot;</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb490-2"><a href="ch-mod-hier-stan.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(rdat<span class="sc">$</span>so)</span>
<span id="cb490-3"><a href="ch-mod-hier-stan.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.5 -0.5</span></span></code></pre></div>
<p>Calcoliamo la media dei tempi di reazione su scala logaritmica e per poi ritrasformare il risultato sulla scala originale:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="ch-mod-hier-stan.html#cb491-1" aria-hidden="true" tabindex="-1"></a>rdat <span class="sc">%&gt;%</span> </span>
<span id="cb491-2"><a href="ch-mod-hier-stan.html#cb491-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type2) <span class="sc">%&gt;%</span> </span>
<span id="cb491-3"><a href="ch-mod-hier-stan.html#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb491-4"><a href="ch-mod-hier-stan.html#cb491-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg =</span> <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(rt), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb491-5"><a href="ch-mod-hier-stan.html#cb491-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb491-6"><a href="ch-mod-hier-stan.html#cb491-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb491-7"><a href="ch-mod-hier-stan.html#cb491-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   type2              avg</span></span>
<span id="cb491-8"><a href="ch-mod-hier-stan.html#cb491-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;</span></span>
<span id="cb491-9"><a href="ch-mod-hier-stan.html#cb491-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 object relative   551.</span></span>
<span id="cb491-10"><a href="ch-mod-hier-stan.html#cb491-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 subject relative  589.</span></span></code></pre></div>
<p>Quando il sostantivo si riferisce al soggetto, i tempi di reazione sono più lenti di circa 30 ms.</p>
<p>Questa descrizione dei dati, però non tiene conto né delle differenze tra i soggetti né delle differenze tra gli item. Per tenere in considerazioni queste diverse fonti della variabilità dei dati è necessario utilizzare un modello gerarchico.</p>
<div id="modello-ad-effetti-fissi" class="section level3 hasAnchor" number="31.6.1">
<h3><span class="header-section-number">31.6.1</span> Modello ad effetti fissi<a href="ch-mod-hier-stan.html#modello-ad-effetti-fissi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Iniziamo con un modello “ad effetti fissi” che non tiene conto della struttura gerarchica dei dati, ovvero del fatto che c’è una covariazione all’interno dei cluster definiti dalle variabili “soggetto” e “item”.</p>
<p>Ipotizziamo dunque di descrivere i dati mediante il seguente modello di regressione lineare:</p>
<p><span class="math display">\[\begin{equation}
\log rt_i = \beta_0 + \beta_1 so_i + \varepsilon_i.
\end{equation}\]</span></p>
<p>Questo è il caso nel quale usiamo il modello lineare per fare inferenza sulla differenza tra le medie di due gruppi. In precedenza abbiamo codificato i due gruppi con 0 e 1. In tali circostanze <span class="math inline">\(\alpha\)</span> fornisce una stima del valore atteso della media del gruppo codificato con <span class="math inline">\(x = 0\)</span> e il parametro <span class="math inline">\(\beta\)</span> fornisce una stima del valore atteso della differenza tra le medie dei due gruppi.</p>
<p>La codifica -0.5 e +0.5 per le due modalità della variabile <code>so</code> ha un effetto simile. Il parametro <span class="math inline">\(\alpha\)</span> del modello di regressione lineare fornisce una stima del valore atteso della media di tutti i valori <span class="math inline">\(y\)</span> (trascurando la classificazione in gruppi) mentre, come in precedenza, il parametro <span class="math inline">\(\beta\)</span> fornisce una stima del valore atteso della differenza tra le medie dei due gruppi.</p>
<p>I tempi di reazione (variabile dipendente <code>rt</code>, ovvero tempo di lettura) hanno una distribuzione caratterizzata da una forte asimmetria positiva. Se trasformiamo i dati in maniera logaritmica, i dati trasformati si distribuiscono in maniera approssimativamente Normale. In maniera equivalente, si può dire che i dati grezzi seguono la distribuzione lognormale.</p>
<p>Il modello di regressione lineare assume dunque la forma seguente:</p>
<p><span class="math display">\[\begin{equation}
rt \sim \mbox{LogNormal}(\beta_0 + \beta_1 so,\sigma).
\end{equation}\]</span></p>
<p>In tale modello <span class="math inline">\(\beta_0\)</span> corrisponde al valore atteso della media generale di <span class="math inline">\(\log\)</span> <code>rt</code> e <span class="math inline">\(\beta_1 so\)</span> codifica la differenza <span class="math inline">\(\E(\log rt_{o}) - \E(\log rt_{s})\)</span> quando si passa dalla condizione nella quale il sostantivo è riferito all’oggetto alla condizione nella quale il sostantivo è riferito al soggetto – valori negativi significano che i tempi di reazioni sono maggiori nella condizione <code>s</code> che nella condizione <code>o</code>.</p>
<p>Ricordiamo che questo non è un modello gerarchico, ma un semplice modello di regressione lineare nel quale assumiamo che la componente erratica del modello segua una distribuzione lognormale.</p>
<p>In un tale modello useremo le seguenti distribuzioni a priori:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\beta[1] &amp;\sim Normal(6, 1.5) \\
\beta[2] &amp;\sim Normal(0, 1.0) \\
\sigma &amp;\sim Cauchy(0, 1)\\
\end{aligned}
\end{equation}\]</span></p>
<!-- https://bayesball.github.io/BOOK/bayesian-hierarchical-modeling.html#hierarchical-normal-modeling -->
<!-- https://vasishth.github.io/bayescogsci/book/sec-trial.html -->
<p>In Stan, il modello precedente è specificato nel modo seguente.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="ch-mod-hier-stan.html#cb492-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb492-2"><a href="ch-mod-hier-stan.html#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb492-3"><a href="ch-mod-hier-stan.html#cb492-3" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; N; //number of data points</span></span>
<span id="cb492-4"><a href="ch-mod-hier-stan.html#cb492-4" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] real rt; //reading time</span></span>
<span id="cb492-5"><a href="ch-mod-hier-stan.html#cb492-5" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] real&lt;lower=-0.5, upper=0.5&gt; so; //predictor</span></span>
<span id="cb492-6"><a href="ch-mod-hier-stan.html#cb492-6" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb492-7"><a href="ch-mod-hier-stan.html#cb492-7" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb492-8"><a href="ch-mod-hier-stan.html#cb492-8" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[2] beta; //fixed intercept and slope</span></span>
<span id="cb492-9"><a href="ch-mod-hier-stan.html#cb492-9" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; sigma_e; //error sd</span></span>
<span id="cb492-10"><a href="ch-mod-hier-stan.html#cb492-10" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb492-11"><a href="ch-mod-hier-stan.html#cb492-11" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb492-12"><a href="ch-mod-hier-stan.html#cb492-12" aria-hidden="true" tabindex="-1"></a><span class="st">    real mu;</span></span>
<span id="cb492-13"><a href="ch-mod-hier-stan.html#cb492-13" aria-hidden="true" tabindex="-1"></a><span class="st">    // likelihood</span></span>
<span id="cb492-14"><a href="ch-mod-hier-stan.html#cb492-14" aria-hidden="true" tabindex="-1"></a><span class="st">    beta[1] ~ normal(6, 1.5);</span></span>
<span id="cb492-15"><a href="ch-mod-hier-stan.html#cb492-15" aria-hidden="true" tabindex="-1"></a><span class="st">    beta[2] ~ normal(0, 1);</span></span>
<span id="cb492-16"><a href="ch-mod-hier-stan.html#cb492-16" aria-hidden="true" tabindex="-1"></a><span class="st">    sigma_e ~ cauchy(0, 1);</span></span>
<span id="cb492-17"><a href="ch-mod-hier-stan.html#cb492-17" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1 : N) {</span></span>
<span id="cb492-18"><a href="ch-mod-hier-stan.html#cb492-18" aria-hidden="true" tabindex="-1"></a><span class="st">      mu = beta[1] + beta[2] * so[i];</span></span>
<span id="cb492-19"><a href="ch-mod-hier-stan.html#cb492-19" aria-hidden="true" tabindex="-1"></a><span class="st">      rt[i] ~ lognormal(mu, sigma_e);</span></span>
<span id="cb492-20"><a href="ch-mod-hier-stan.html#cb492-20" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb492-21"><a href="ch-mod-hier-stan.html#cb492-21" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb492-22"><a href="ch-mod-hier-stan.html#cb492-22" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb492-23"><a href="ch-mod-hier-stan.html#cb492-23" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/fixeff_model.stan&quot;</span>)</span></code></pre></div>
<p>Compiliamo il modello.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="ch-mod-hier-stan.html#cb493-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;fixeff_model.stan&quot;</span>)</span>
<span id="cb493-2"><a href="ch-mod-hier-stan.html#cb493-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>I dati sono contenuti nella lista <code>stan_dat</code>.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="ch-mod-hier-stan.html#cb494-1" aria-hidden="true" tabindex="-1"></a>stan_dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb494-2"><a href="ch-mod-hier-stan.html#cb494-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt =</span> rdat<span class="sc">$</span>rt,</span>
<span id="cb494-3"><a href="ch-mod-hier-stan.html#cb494-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">so =</span> rdat<span class="sc">$</span>so,</span>
<span id="cb494-4"><a href="ch-mod-hier-stan.html#cb494-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(rdat)</span>
<span id="cb494-5"><a href="ch-mod-hier-stan.html#cb494-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Eseguiamo il campionamento MCMC.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="ch-mod-hier-stan.html#cb495-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb495-2"><a href="ch-mod-hier-stan.html#cb495-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> stan_dat,</span>
<span id="cb495-3"><a href="ch-mod-hier-stan.html#cb495-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb495-4"><a href="ch-mod-hier-stan.html#cb495-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb495-5"><a href="ch-mod-hier-stan.html#cb495-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb495-6"><a href="ch-mod-hier-stan.html#cb495-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb495-7"><a href="ch-mod-hier-stan.html#cb495-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb495-8"><a href="ch-mod-hier-stan.html#cb495-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Otteniamo dunque le seguenti medie a posteriori.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="ch-mod-hier-stan.html#cb496-1" aria-hidden="true" tabindex="-1"></a>fit3<span class="sc">$</span><span class="fu">summary</span>()</span>
<span id="cb496-2"><a href="ch-mod-hier-stan.html#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 10</span></span>
<span id="cb496-3"><a href="ch-mod-hier-stan.html#cb496-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable       mean    median      sd     mad       q5      q95  rhat ess_bulk</span></span>
<span id="cb496-4"><a href="ch-mod-hier-stan.html#cb496-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb496-5"><a href="ch-mod-hier-stan.html#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 lp__     -2614.      -2.61e+3 1.22    0.993   -2.62e+3 -2.61e+3  1.00    8108.</span></span>
<span id="cb496-6"><a href="ch-mod-hier-stan.html#cb496-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 beta[1]      6.35     6.34e+0 0.0121  0.0121   6.33e+0  6.37e+0  1.00   16919.</span></span>
<span id="cb496-7"><a href="ch-mod-hier-stan.html#cb496-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 beta[2]     -0.0653  -6.52e-2 0.0241  0.0237  -1.05e-1 -2.52e-2  1.00   15675.</span></span>
<span id="cb496-8"><a href="ch-mod-hier-stan.html#cb496-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 sigma_e      0.629    6.29e-1 0.00850 0.00861  6.15e-1  6.43e-1  1.00   16349.</span></span>
<span id="cb496-9"><a href="ch-mod-hier-stan.html#cb496-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1 more variable: ess_tail &lt;dbl&gt;</span></span></code></pre></div>
<p>Trasformiamo <code>fit3</code> in un oggetto di classe <code>stanfit</code>.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="ch-mod-hier-stan.html#cb497-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit3<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>Calcoliamo gli intervalli di credibilità al 95%.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="ch-mod-hier-stan.html#cb498-1" aria-hidden="true" tabindex="-1"></a>ci95 <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">posterior_interval</span>(</span>
<span id="cb498-2"><a href="ch-mod-hier-stan.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(stanfit),</span>
<span id="cb498-3"><a href="ch-mod-hier-stan.html#cb498-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.95</span></span>
<span id="cb498-4"><a href="ch-mod-hier-stan.html#cb498-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb498-5"><a href="ch-mod-hier-stan.html#cb498-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ci95, <span class="dv">3</span>)</span>
<span id="cb498-6"><a href="ch-mod-hier-stan.html#cb498-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              2.5%     97.5%</span></span>
<span id="cb498-7"><a href="ch-mod-hier-stan.html#cb498-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[1]     6.321     6.369</span></span>
<span id="cb498-8"><a href="ch-mod-hier-stan.html#cb498-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[2]    -0.113    -0.017</span></span>
<span id="cb498-9"><a href="ch-mod-hier-stan.html#cb498-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_e     0.613     0.646</span></span>
<span id="cb498-10"><a href="ch-mod-hier-stan.html#cb498-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__    -2617.020 -2612.420</span></span></code></pre></div>
<p>Se esponenziamo i dati su scala lognormale ritorniamo alla scala dei dati grezzi. L’effetto medio, sulla scala in millisecondi, si trova dunque nel modo seguente.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="ch-mod-hier-stan.html#cb499-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract</span>(stanfit, <span class="at">permuted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb499-2"><a href="ch-mod-hier-stan.html#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(post<span class="sc">$</span>beta[, <span class="dv">1</span>] <span class="sc">+</span> post<span class="sc">$</span>beta[, <span class="dv">2</span>])) <span class="sc">-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(post<span class="sc">$</span>beta[, <span class="dv">1</span>]))</span>
<span id="cb499-3"><a href="ch-mod-hier-stan.html#cb499-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -35.99588</span></span></code></pre></div>
<p>Se ignoriamo la struttura gerarchica dei dati, concludiamo che l’effetto della manipolazione sperimentale corrisponde ad una differenza medie nel tempo di lettura nelle due condizioni di 36 ms, con tempi di lettura maggiore quando il sostantivo era riferito al soggetto della proposizione.</p>
</div>
<div id="modello-gerarchico-1" class="section level3 hasAnchor" number="31.6.2">
<h3><span class="header-section-number">31.6.2</span> Modello gerarchico<a href="ch-mod-hier-stan.html#modello-gerarchico-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un modello non gerarchico (detto ad effetti fissi) è inappropriato per il campione di <span class="citation">Gibson and Wu (<a href="#ref-gibson2013processing" role="doc-biblioref">2013</a>)</span> perché non tiene conto del fatto che i dati sono a misure ripetute, ovvero, con più ripetizioni per ogni soggetto e per ogni item. Il modello ad effetti usato sopra viola l’assunzione di indipendenza degli errori. Inoltre, i coefficienti di effetti fissi <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> rappresentano le medie calcolate aggregando i dati sulla dimensione dei soggetti e degli item. Così facendo, non si tiene in considerazione il fatto che alcuni soggetti sono più veloci e altri più lenti della media, e il fatto che alcuni item sono stati letti più velocemente e altri in maniera più lenta della media. Ovvero, il modello non considera informazioni che sono presenti nei dati.</p>
<p>Un modello gerarchico, invece, rende conto delle diverse fonti di variabilità che derivano da questo disegno sperimentale, ovvero la variabilità dovuta alle differenze tra i soggetti e la variabilità dovuta alle differenze tra gli item. Per rendere conto di queste fonti di variabilità nei dati, vengono aggiunti al modello di regressione lineare due nuovi termini: <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span>. Tali termini “aggiustano” <span class="math inline">\(\beta_0\)</span> in modo tale da stimare una componente specifica della variabile risposta dovuta al soggetto <span class="math inline">\(j\)</span>-esimo e all’item <span class="math inline">\(k\)</span>-esimo.</p>
<p>Questa formulazione del modello scompone parzialmente la componente d’errore <span class="math inline">\(\varepsilon_i\)</span> nella somma dei termini <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span>. Geometricamente, i termini <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> corrispondono ad aggiustamenti dell’intercetta <span class="math inline">\(\beta_0\)</span> che sono specifici per il soggetto <span class="math inline">\(j\)</span>-esimo e per l’item <span class="math inline">\(k\)</span>-esimo.</p>
<p>Se il soggetto <span class="math inline">\(j\)</span>-esimo è più lento della media di tutti i soggetti, allora il parametro <span class="math inline">\(u_j\)</span> sarà un numero positivo. Se l’item <span class="math inline">\(k\)</span>-esimo viene letto più velocemente del tempo di lettura medio di tutti gli item, allora il parametro <span class="math inline">\(w_k\)</span> sarà un numero negativo. Viene stimato un aggiustamento <span class="math inline">\(u_{0j}\)</span> per ogni soggetto <span class="math inline">\(j\)</span>-esimo e un aggiustamento <span class="math inline">\(w_{0k}\)</span> per ogni item <span class="math inline">\(k\)</span>-esimo. I parametri <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> sono chiamati <em>random intercepts</em> o <em>varying intercepts</em> <span class="citation">(<a href="#ref-gelman2020regression" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>)</span>. L’aggiustamento di <span class="math inline">\(\beta_0\)</span> mediante <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> consente dunque di tenere in considerazione la struttura gerarchica dei dati, ovvero consente di stimare la quota di variabilità dovuta ai soggetti e agli item.</p>
<p>Il random intercept model assume che gli aggiustamenti <span class="math inline">\(u_{0j}\)</span> e <span class="math inline">\(w_{0k}\)</span> siano distribuiti normalmente attorno allo zero con una deviazione standard sconosciuta:</p>
<p><span class="math display">\[
u_0 ∼ \mathcal{N}(0, \sigma_u),
\]</span></p>
<p><span class="math display">\[
w_0 ∼ \mathcal{N}(0, \sigma_w).
\]</span></p>
<p>Il modello include dunque tre fonti di varianza:</p>
<ul>
<li>la deviazione standard degli errori <span class="math inline">\(\sigma_e\)</span>,</li>
<li>la deviazione standard delle <em>random intercepts</em> per i soggetti, <span class="math inline">\(\sigma_u\)</span>,</li>
<li>la deviazione standard delle <em>random intercepts</em> per gli item, <span class="math inline">\(\sigma_w\)</span>.</li>
</ul>
<p>Queste tre fonti di variabilità sono dette <em>componenti della varianza</em>. Possiamo dunque scrivere il modello nel modo seguente:</p>
<p><span class="math display">\[\begin{equation}
\log rt_{ijk} = \beta_0 + \beta_1 so_i + u_{0j} + w_{0k} + \varepsilon_{ijk}.
\end{equation}\]</span></p>
<p>Il coefficiente <span class="math inline">\(\beta_1\)</span> è il parametro di interesse primario. Come conseguenza della codifica usata, avrà il valore <span class="math inline">\(-\beta_1\)</span> nella condizione in cui il sostantivo è riferito al soggetto e <span class="math inline">\(+\beta_1\)</span> nella condizione in cui il sostantivo è riferito all’oggetto della frase.</p>
<p>In Stan il modello viene formulato nel modo seguente.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="ch-mod-hier-stan.html#cb500-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb500-2"><a href="ch-mod-hier-stan.html#cb500-2" aria-hidden="true" tabindex="-1"></a><span class="st">  data {</span></span>
<span id="cb500-3"><a href="ch-mod-hier-stan.html#cb500-3" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; N; //number of data points</span></span>
<span id="cb500-4"><a href="ch-mod-hier-stan.html#cb500-4" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] real rt; //reading time</span></span>
<span id="cb500-5"><a href="ch-mod-hier-stan.html#cb500-5" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] real&lt;lower=-0.5, upper=0.5&gt; so; //predictor</span></span>
<span id="cb500-6"><a href="ch-mod-hier-stan.html#cb500-6" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; J; //number of subjects</span></span>
<span id="cb500-7"><a href="ch-mod-hier-stan.html#cb500-7" aria-hidden="true" tabindex="-1"></a><span class="st">    int&lt;lower=1&gt; K; //number of items</span></span>
<span id="cb500-8"><a href="ch-mod-hier-stan.html#cb500-8" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] int&lt;lower=1, upper=J&gt; subj; //subject id</span></span>
<span id="cb500-9"><a href="ch-mod-hier-stan.html#cb500-9" aria-hidden="true" tabindex="-1"></a><span class="st">    array[N] int&lt;lower=1, upper=K&gt; item; //item id</span></span>
<span id="cb500-10"><a href="ch-mod-hier-stan.html#cb500-10" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb500-11"><a href="ch-mod-hier-stan.html#cb500-11" aria-hidden="true" tabindex="-1"></a><span class="st">  parameters {</span></span>
<span id="cb500-12"><a href="ch-mod-hier-stan.html#cb500-12" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[2] beta; //fixed intercept and slope</span></span>
<span id="cb500-13"><a href="ch-mod-hier-stan.html#cb500-13" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[J] u; //subject intercepts</span></span>
<span id="cb500-14"><a href="ch-mod-hier-stan.html#cb500-14" aria-hidden="true" tabindex="-1"></a><span class="st">    vector[K] w; //item intercepts</span></span>
<span id="cb500-15"><a href="ch-mod-hier-stan.html#cb500-15" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; sigma_e; //error sd</span></span>
<span id="cb500-16"><a href="ch-mod-hier-stan.html#cb500-16" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; sigma_u; //subj sd</span></span>
<span id="cb500-17"><a href="ch-mod-hier-stan.html#cb500-17" aria-hidden="true" tabindex="-1"></a><span class="st">    real&lt;lower=0&gt; sigma_w; //item sd</span></span>
<span id="cb500-18"><a href="ch-mod-hier-stan.html#cb500-18" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb500-19"><a href="ch-mod-hier-stan.html#cb500-19" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb500-20"><a href="ch-mod-hier-stan.html#cb500-20" aria-hidden="true" tabindex="-1"></a><span class="st">    real mu;</span></span>
<span id="cb500-21"><a href="ch-mod-hier-stan.html#cb500-21" aria-hidden="true" tabindex="-1"></a><span class="st">    //priors</span></span>
<span id="cb500-22"><a href="ch-mod-hier-stan.html#cb500-22" aria-hidden="true" tabindex="-1"></a><span class="st">    u ~ normal(0, sigma_u); //subj random effects</span></span>
<span id="cb500-23"><a href="ch-mod-hier-stan.html#cb500-23" aria-hidden="true" tabindex="-1"></a><span class="st">    w ~ normal(0, sigma_w); //item random effects</span></span>
<span id="cb500-24"><a href="ch-mod-hier-stan.html#cb500-24" aria-hidden="true" tabindex="-1"></a><span class="st">    // likelihood</span></span>
<span id="cb500-25"><a href="ch-mod-hier-stan.html#cb500-25" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1 : N) {</span></span>
<span id="cb500-26"><a href="ch-mod-hier-stan.html#cb500-26" aria-hidden="true" tabindex="-1"></a><span class="st">      mu = beta[1] + u[subj[i]] + w[item[i]] + beta[2] * so[i];</span></span>
<span id="cb500-27"><a href="ch-mod-hier-stan.html#cb500-27" aria-hidden="true" tabindex="-1"></a><span class="st">      rt[i] ~ lognormal(mu, sigma_e);</span></span>
<span id="cb500-28"><a href="ch-mod-hier-stan.html#cb500-28" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb500-29"><a href="ch-mod-hier-stan.html#cb500-29" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb500-30"><a href="ch-mod-hier-stan.html#cb500-30" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb500-31"><a href="ch-mod-hier-stan.html#cb500-31" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/random_intercepts_model.stan&quot;</span>)</span></code></pre></div>
<p>Compiliamo il modello.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="ch-mod-hier-stan.html#cb501-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;random_intercepts_model.stan&quot;</span>)</span>
<span id="cb501-2"><a href="ch-mod-hier-stan.html#cb501-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>I dati nel formato appropriato per Stan sono i seguenti.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="ch-mod-hier-stan.html#cb502-1" aria-hidden="true" tabindex="-1"></a>stan_dat <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb502-2"><a href="ch-mod-hier-stan.html#cb502-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">subj =</span> <span class="fu">as.integer</span>(<span class="fu">as.factor</span>(rdat<span class="sc">$</span>subj)),</span>
<span id="cb502-3"><a href="ch-mod-hier-stan.html#cb502-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">item =</span> <span class="fu">as.integer</span>(<span class="fu">as.factor</span>(rdat<span class="sc">$</span>item)),</span>
<span id="cb502-4"><a href="ch-mod-hier-stan.html#cb502-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rt =</span> rdat<span class="sc">$</span>rt,</span>
<span id="cb502-5"><a href="ch-mod-hier-stan.html#cb502-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">so =</span> rdat<span class="sc">$</span>so,</span>
<span id="cb502-6"><a href="ch-mod-hier-stan.html#cb502-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">nrow</span>(rdat),</span>
<span id="cb502-7"><a href="ch-mod-hier-stan.html#cb502-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">J =</span> <span class="fu">length</span>(<span class="fu">unique</span>(rdat<span class="sc">$</span>subj)),</span>
<span id="cb502-8"><a href="ch-mod-hier-stan.html#cb502-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> <span class="fu">length</span>(<span class="fu">unique</span>(rdat<span class="sc">$</span>item))</span>
<span id="cb502-9"><a href="ch-mod-hier-stan.html#cb502-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Eseguiamo il campionamento MCMC.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="ch-mod-hier-stan.html#cb503-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb503-2"><a href="ch-mod-hier-stan.html#cb503-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> stan_dat,</span>
<span id="cb503-3"><a href="ch-mod-hier-stan.html#cb503-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb503-4"><a href="ch-mod-hier-stan.html#cb503-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb503-5"><a href="ch-mod-hier-stan.html#cb503-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb503-6"><a href="ch-mod-hier-stan.html#cb503-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb503-7"><a href="ch-mod-hier-stan.html#cb503-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb503-8"><a href="ch-mod-hier-stan.html#cb503-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Trasformiamo l’oggetto <code>fit4</code> in un oggetto di classe <code>stanfit</code>.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="ch-mod-hier-stan.html#cb504-1" aria-hidden="true" tabindex="-1"></a>output4_stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit4<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>Le medie a posteriori dei parametri si ottengono nel modo seguente.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="ch-mod-hier-stan.html#cb505-1" aria-hidden="true" tabindex="-1"></a>fit4<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma_e&quot;</span>, <span class="st">&quot;sigma_w&quot;</span>, <span class="st">&quot;sigma_u&quot;</span>))</span>
<span id="cb505-2"><a href="ch-mod-hier-stan.html#cb505-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 10</span></span>
<span id="cb505-3"><a href="ch-mod-hier-stan.html#cb505-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable    mean  median      sd     mad      q5     q95  rhat ess_bulk</span></span>
<span id="cb505-4"><a href="ch-mod-hier-stan.html#cb505-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb505-5"><a href="ch-mod-hier-stan.html#cb505-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 beta[1]   6.35    6.35   0.0512  0.0511   6.26    6.43    1.00    1413.</span></span>
<span id="cb505-6"><a href="ch-mod-hier-stan.html#cb505-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 beta[2]  -0.0604 -0.0604 0.0220  0.0218  -0.0974 -0.0243  1.00   17390.</span></span>
<span id="cb505-7"><a href="ch-mod-hier-stan.html#cb505-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 sigma_e   0.577   0.577  0.00792 0.00784  0.564   0.590   1.00   17746.</span></span>
<span id="cb505-8"><a href="ch-mod-hier-stan.html#cb505-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 sigma_w   0.120   0.115  0.0291  0.0263   0.0806  0.173   1.00    8584.</span></span>
<span id="cb505-9"><a href="ch-mod-hier-stan.html#cb505-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 sigma_u   0.238   0.235  0.0319  0.0304   0.191   0.293   1.00   11445.</span></span>
<span id="cb505-10"><a href="ch-mod-hier-stan.html#cb505-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1 more variable: ess_tail &lt;dbl&gt;</span></span></code></pre></div>
<p>Gli intervalli di credibilità al 95% sono i seguenti.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="ch-mod-hier-stan.html#cb506-1" aria-hidden="true" tabindex="-1"></a>ci95 <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">posterior_interval</span>(</span>
<span id="cb506-2"><a href="ch-mod-hier-stan.html#cb506-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(output4_stanfit),</span>
<span id="cb506-3"><a href="ch-mod-hier-stan.html#cb506-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.95</span></span>
<span id="cb506-4"><a href="ch-mod-hier-stan.html#cb506-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb506-5"><a href="ch-mod-hier-stan.html#cb506-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ci95, <span class="dv">3</span>)</span>
<span id="cb506-6"><a href="ch-mod-hier-stan.html#cb506-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              2.5%     97.5%</span></span>
<span id="cb506-7"><a href="ch-mod-hier-stan.html#cb506-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[1]     6.247     6.447</span></span>
<span id="cb506-8"><a href="ch-mod-hier-stan.html#cb506-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta[2]    -0.104    -0.017</span></span>
<span id="cb506-9"><a href="ch-mod-hier-stan.html#cb506-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[1]       -0.208     0.081</span></span>
<span id="cb506-10"><a href="ch-mod-hier-stan.html#cb506-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[2]       -0.304    -0.012</span></span>
<span id="cb506-11"><a href="ch-mod-hier-stan.html#cb506-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[3]       -0.127     0.163</span></span>
<span id="cb506-12"><a href="ch-mod-hier-stan.html#cb506-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[4]       -0.212     0.079</span></span>
<span id="cb506-13"><a href="ch-mod-hier-stan.html#cb506-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[5]       -0.079     0.216</span></span>
<span id="cb506-14"><a href="ch-mod-hier-stan.html#cb506-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[6]       -0.049     0.239</span></span>
<span id="cb506-15"><a href="ch-mod-hier-stan.html#cb506-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[7]       -0.162     0.131</span></span>
<span id="cb506-16"><a href="ch-mod-hier-stan.html#cb506-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[8]       -0.124     0.168</span></span>
<span id="cb506-17"><a href="ch-mod-hier-stan.html#cb506-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[9]       -0.097     0.196</span></span>
<span id="cb506-18"><a href="ch-mod-hier-stan.html#cb506-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[10]      -0.009     0.283</span></span>
<span id="cb506-19"><a href="ch-mod-hier-stan.html#cb506-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[11]       0.450     0.745</span></span>
<span id="cb506-20"><a href="ch-mod-hier-stan.html#cb506-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[12]       0.149     0.443</span></span>
<span id="cb506-21"><a href="ch-mod-hier-stan.html#cb506-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[13]      -0.169     0.123</span></span>
<span id="cb506-22"><a href="ch-mod-hier-stan.html#cb506-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[14]      -0.151     0.140</span></span>
<span id="cb506-23"><a href="ch-mod-hier-stan.html#cb506-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[15]       0.035     0.324</span></span>
<span id="cb506-24"><a href="ch-mod-hier-stan.html#cb506-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[16]      -0.199     0.089</span></span>
<span id="cb506-25"><a href="ch-mod-hier-stan.html#cb506-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[17]      -0.716    -0.418</span></span>
<span id="cb506-26"><a href="ch-mod-hier-stan.html#cb506-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[18]      -0.417    -0.127</span></span>
<span id="cb506-27"><a href="ch-mod-hier-stan.html#cb506-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[19]      -0.295     0.003</span></span>
<span id="cb506-28"><a href="ch-mod-hier-stan.html#cb506-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[20]       0.162     0.452</span></span>
<span id="cb506-29"><a href="ch-mod-hier-stan.html#cb506-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[21]       0.050     0.341</span></span>
<span id="cb506-30"><a href="ch-mod-hier-stan.html#cb506-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[22]       0.123     0.418</span></span>
<span id="cb506-31"><a href="ch-mod-hier-stan.html#cb506-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[23]      -0.197     0.096</span></span>
<span id="cb506-32"><a href="ch-mod-hier-stan.html#cb506-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[24]      -0.084     0.293</span></span>
<span id="cb506-33"><a href="ch-mod-hier-stan.html#cb506-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[25]       0.000     0.292</span></span>
<span id="cb506-34"><a href="ch-mod-hier-stan.html#cb506-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[26]      -0.494    -0.203</span></span>
<span id="cb506-35"><a href="ch-mod-hier-stan.html#cb506-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[27]      -0.233     0.059</span></span>
<span id="cb506-36"><a href="ch-mod-hier-stan.html#cb506-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[28]      -0.332    -0.038</span></span>
<span id="cb506-37"><a href="ch-mod-hier-stan.html#cb506-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[29]      -0.423    -0.127</span></span>
<span id="cb506-38"><a href="ch-mod-hier-stan.html#cb506-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[30]      -0.406    -0.113</span></span>
<span id="cb506-39"><a href="ch-mod-hier-stan.html#cb506-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[31]      -0.100     0.188</span></span>
<span id="cb506-40"><a href="ch-mod-hier-stan.html#cb506-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[32]      -0.178     0.113</span></span>
<span id="cb506-41"><a href="ch-mod-hier-stan.html#cb506-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[33]      -0.239     0.056</span></span>
<span id="cb506-42"><a href="ch-mod-hier-stan.html#cb506-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[34]       0.257     0.554</span></span>
<span id="cb506-43"><a href="ch-mod-hier-stan.html#cb506-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[35]      -0.396    -0.104</span></span>
<span id="cb506-44"><a href="ch-mod-hier-stan.html#cb506-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[36]      -0.144     0.145</span></span>
<span id="cb506-45"><a href="ch-mod-hier-stan.html#cb506-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; u[37]      -0.171     0.118</span></span>
<span id="cb506-46"><a href="ch-mod-hier-stan.html#cb506-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[1]       -0.133     0.061</span></span>
<span id="cb506-47"><a href="ch-mod-hier-stan.html#cb506-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[2]       -0.118     0.075</span></span>
<span id="cb506-48"><a href="ch-mod-hier-stan.html#cb506-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[3]       -0.101     0.093</span></span>
<span id="cb506-49"><a href="ch-mod-hier-stan.html#cb506-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[4]       -0.213    -0.015</span></span>
<span id="cb506-50"><a href="ch-mod-hier-stan.html#cb506-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[5]       -0.006     0.190</span></span>
<span id="cb506-51"><a href="ch-mod-hier-stan.html#cb506-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[6]       -0.141     0.056</span></span>
<span id="cb506-52"><a href="ch-mod-hier-stan.html#cb506-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[7]       -0.281    -0.082</span></span>
<span id="cb506-53"><a href="ch-mod-hier-stan.html#cb506-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[8]        0.115     0.315</span></span>
<span id="cb506-54"><a href="ch-mod-hier-stan.html#cb506-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[9]       -0.185     0.009</span></span>
<span id="cb506-55"><a href="ch-mod-hier-stan.html#cb506-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[10]      -0.041     0.153</span></span>
<span id="cb506-56"><a href="ch-mod-hier-stan.html#cb506-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[11]      -0.136     0.058</span></span>
<span id="cb506-57"><a href="ch-mod-hier-stan.html#cb506-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[12]      -0.030     0.165</span></span>
<span id="cb506-58"><a href="ch-mod-hier-stan.html#cb506-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[13]      -0.176     0.018</span></span>
<span id="cb506-59"><a href="ch-mod-hier-stan.html#cb506-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[14]       0.036     0.235</span></span>
<span id="cb506-60"><a href="ch-mod-hier-stan.html#cb506-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; w[15]      -0.041     0.155</span></span>
<span id="cb506-61"><a href="ch-mod-hier-stan.html#cb506-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_e     0.562     0.593</span></span>
<span id="cb506-62"><a href="ch-mod-hier-stan.html#cb506-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_u     0.183     0.309</span></span>
<span id="cb506-63"><a href="ch-mod-hier-stan.html#cb506-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_w     0.076     0.188</span></span>
<span id="cb506-64"><a href="ch-mod-hier-stan.html#cb506-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lp__    -2332.580 -2311.210</span></span></code></pre></div>
<p>Si noti il grande numero di parametri che vengono stimati dal modello gerarchico, anche nel caso del modello a intercette casuali, ovvero, nel caso del modello gerarchico più semplice. Questo esempio fa capire la necessità di utilizzare gli algoritmi MCMC: con un numero di parametri da stimare così grande è fuori considerazione l’idea di stimare i parametri mediante un metodo numerico basato su griglia. Inoltre, nel caso di un modello così complesso, una soluzione analitica della distribuzione a posteriori dei parametri non è disponibile.</p>
<p>Nel caso presente, la stima dell’effetto della manipolazione sperimentale ottenuta mediante un modello gerarchico ad intercette random è molto simile alla stima ottenuta con il modello che analizza i dati aggregati.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="ch-mod-hier-stan.html#cb507-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract</span>(output4_stanfit, <span class="at">permuted =</span> <span class="cn">TRUE</span>)</span>
<span id="cb507-2"><a href="ch-mod-hier-stan.html#cb507-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(post<span class="sc">$</span>beta[, <span class="dv">1</span>] <span class="sc">+</span> post<span class="sc">$</span>beta[, <span class="dv">2</span>])) <span class="sc">-</span> <span class="fu">exp</span>(<span class="fu">mean</span>(post<span class="sc">$</span>beta[, <span class="dv">1</span>]))</span>
<span id="cb507-3"><a href="ch-mod-hier-stan.html#cb507-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -33.43351</span></span></code></pre></div>
<p>L’intervallo di credibilità a posteriori per il modello gerarchico ad intercette random, in questo campione, è leggermente più piccolo di quello ottenuto mediante l’analisi dei dati aggregati.</p>
<p>Si noti che la varianza trovata con il modello per dati aggregati</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="ch-mod-hier-stan.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6291826</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb508-2"><a href="ch-mod-hier-stan.html#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3958707</span></span></code></pre></div>
<p>viene ora decomposta nella somma di tre componenti</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="ch-mod-hier-stan.html#cb509-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.57721890</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.11961706</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.23762983</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb509-2"><a href="ch-mod-hier-stan.html#cb509-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4039578</span></span></code></pre></div>
<p>Quindi, il modello gerarchico ci fornisce più informazioni di un’analisi basata sui dati aggregati. Per esempio, l’analisi presente ci consente di dire che la variabilità dei tempi di reazione dovuta alle differenze tra i soggetti è di entità circa doppia rispetto alla variabilità attribuibile alle differenze tra gli item.</p>
</div>
</div>
<div id="commenti-e-considerazioni-finali-26" class="section level2 unnumbered hasAnchor">
<h2>Commenti e considerazioni finali<a href="ch-mod-hier-stan.html#commenti-e-considerazioni-finali-26" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La descrizione dettagliata della soluzione del problema delle otto scuole ha messo in evidenza un aspetto importante che deriva dall’uso dei modelli gerarchici: in un modello gerarchico, le stime degli effetti (qui chiamate <span class="math inline">\(\theta_j\)</span>, ovvero l’effetto del diverso tipo di coaching per ciascuna scuola) assumono valori più simili alla media generale di quanto non lo facciano quando gli effetti <span class="math inline">\(\theta_j\)</span> vengono stimati da un modello no pooling. Questo fenomeno è detto <em>effetto shrinkage</em>.</p>
<p>È importante considerare due caratteristiche dell’effetto shrinkage.</p>
<ul>
<li>L’effetto shrinkage aumenta quando diminuisce il numero di osservazioni in ciascun gruppo <span class="math inline">\(j\)</span>-esimo. Cioè, ci affidiamo sempre di più alle tendenze globali per stimare le proprietà di un gruppo per il quale abbiamo pochi dati.</li>
<li>L’effetto shrinkage aumenta quando è è grande la variabilità all’interno dei gruppi, <span class="math inline">\(\sigma_y\)</span>, rispetto alla variabilità tra i gruppi, <span class="math inline">\(\sigma_\mu\)</span>. Cioè, ci affidiamo sempre di più alle tendenze globali per per stimare le proprietà di un gruppo quando è difficile distinguere le proprietà di un gruppo da quelle di un altro gruppo.</li>
</ul>
<p>Questo ci fa capire che, trovando un equilibrio tra pooling completo e no pooling, i modelli gerarchici consentono di:</p>
<ul>
<li>generalizzare le osservazioni sui nostri gruppi campionati alla popolazione più ampia; - prendere in prestito informazioni da tutti i gruppi campionati quando si vogliono conoscere le proprietà di un singolo gruppo campionato.</li>
</ul>
<p>Le stime prodotte dai modelli con pooling completo tendono ad avere una distorsione (bias) alta e una varianza piccola; le stime prodotte dai modelli senza pooling tendono ad avere una distorsione bassa e una varianza grande. I modelli gerarchici offrono un equilibrio tra questi due estremi:</p>
<ul>
<li>a differenza dei modelli a pooling completo, i modelli gerarchici tengono conto delle tendenze specifiche dei gruppi e quindi offrono una minore distorsione del fenomeno da descrivere;</li>
<li>a differenza dei modelli no pooling, i modelli gerarchici tengono conto delle tendenze globali e quindi offrono delle stime meno variabili da campione a campione.</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gelman1995bayesian" class="csl-entry">
Gelman, Andrew, John B Carlin, Hal S Stern, and Donald B Rubin. 1995. <em>Bayesian Data Analysis</em>. Chapman; Hall/CRC.
</div>
<div id="ref-gelman2020regression" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div id="ref-gibson2013processing" class="csl-entry">
Gibson, Edward, and H-H Iris Wu. 2013. <span>“Processing Chinese Relative Clauses in Context.”</span> <em>Language and Cognitive Processes</em> 28 (1-2): 125–55.
</div>
<div id="ref-rubin1981estimation" class="csl-entry">
Rubin, Donald B. 1981. <span>“Estimation in Parallel Randomized Experiments.”</span> <em>Journal of Educational Statistics</em> 6 (4): 377–401.
</div>
<div id="ref-sorensen2015bayesian" class="csl-entry">
Sorensen, Tanner, and Shravan Vasishth. 2015. <span>“Bayesian Linear Mixed Models Using Stan: A Tutorial for Psychologists, Linguists, and Cognitive Scientists.”</span> <em>arXiv Preprint arXiv:1506.06201</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-hier-sim.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ccaudek/datascience/edit/master/070_mod_hier.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ds4psy.pdf", "ds4psy.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
