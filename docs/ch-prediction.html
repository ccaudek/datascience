<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 22 La predizione bayesiana | Data Science per psicologi</title>
  <meta name="description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 22 La predizione bayesiana | Data Science per psicologi" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 22 La predizione bayesiana | Data Science per psicologi" />
  
  <meta name="twitter:description" content="This document contains the materials of the lessons of Psicometria B000286 (2021/2022) aimed at students of the first year of the Degree Course in Psychological Sciences and Techniques of the University of Florence, Italy." />
  

<meta name="author" content="Corrado Caudek" />


<meta name="date" content="2022-04-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-sintesi-distr-post.html"/>
<link rel="next" href="ch-normal-normal-mod-stan.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data science per psicologi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefazione</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#la-psicologia-e-la-data-science"><i class="fa fa-check"></i>La psicologia e la Data science</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#come-studiare"><i class="fa fa-check"></i>Come studiare</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sviluppare-un-metodo-di-studio-efficace"><i class="fa fa-check"></i>Sviluppare un metodo di studio efficace</a></li>
</ul></li>
<li class="part"><span><b>I Nozioni preliminari</b></span></li>
<li class="chapter" data-level="1" data-path="ch-key-notions.html"><a href="ch-key-notions.html"><i class="fa fa-check"></i><b>1</b> Concetti chiave</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-key-notions.html"><a href="ch-key-notions.html#popolazioni-e-campioni"><i class="fa fa-check"></i><b>1.1</b> Popolazioni e campioni</a></li>
<li class="chapter" data-level="1.2" data-path="ch-key-notions.html"><a href="ch-key-notions.html#variabili-e-costanti"><i class="fa fa-check"></i><b>1.2</b> Variabili e costanti</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ch-key-notions.html"><a href="ch-key-notions.html#variabili-casuali"><i class="fa fa-check"></i><b>1.2.1</b> Variabili casuali</a></li>
<li class="chapter" data-level="1.2.2" data-path="ch-key-notions.html"><a href="ch-key-notions.html#variabili-indipendenti-e-variabili-dipendenti"><i class="fa fa-check"></i><b>1.2.2</b> Variabili indipendenti e variabili dipendenti</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch-key-notions.html"><a href="ch-key-notions.html#la-matrice-dei-dati"><i class="fa fa-check"></i><b>1.2.3</b> La matrice dei dati</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch-key-notions.html"><a href="ch-key-notions.html#parametri-e-modelli"><i class="fa fa-check"></i><b>1.3</b> Parametri e modelli</a></li>
<li class="chapter" data-level="1.4" data-path="ch-key-notions.html"><a href="ch-key-notions.html#effetto"><i class="fa fa-check"></i><b>1.4</b> Effetto</a></li>
<li class="chapter" data-level="1.5" data-path="ch-key-notions.html"><a href="ch-key-notions.html#stima-e-inferenza"><i class="fa fa-check"></i><b>1.5</b> Stima e inferenza</a></li>
<li class="chapter" data-level="1.6" data-path="ch-key-notions.html"><a href="ch-key-notions.html#metodi-e-procedure-della-psicologia"><i class="fa fa-check"></i><b>1.6</b> Metodi e procedure della psicologia</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html"><i class="fa fa-check"></i><b>2</b> La misurazione in psicologia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#le-scale-di-misura"><i class="fa fa-check"></i><b>2.1</b> Le scale di misura</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-nominale"><i class="fa fa-check"></i><b>2.1.1</b> Scala nominale</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-ordinale"><i class="fa fa-check"></i><b>2.1.2</b> Scala ordinale</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-ad-intervalli"><i class="fa fa-check"></i><b>2.1.3</b> Scala ad intervalli</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#scala-di-rapporti"><i class="fa fa-check"></i><b>2.1.4</b> Scala di rapporti</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#gerarchia-dei-livelli-di-scala-di-misura"><i class="fa fa-check"></i><b>2.2</b> Gerarchia dei livelli di scala di misura</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#variabili-discrete-o-continue"><i class="fa fa-check"></i><b>2.3</b> Variabili discrete o continue</a></li>
<li class="chapter" data-level="2.4" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#alcune-misure-sono-migliori-di-altre"><i class="fa fa-check"></i><b>2.4</b> Alcune misure sono migliori di altre</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#tipologie-di-errori"><i class="fa fa-check"></i><b>2.4.1</b> Tipologie di errori</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-misurazione.html"><a href="chapter-misurazione.html#commenti-e-considerazioni-finali"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>II Analisi esplorativa dei dati</b></span></li>
<li class="chapter" data-level="3" data-path="ch-eda.html"><a href="ch-eda.html"><i class="fa fa-check"></i><b>3</b> Variabili e distribuzioni di frequenza</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-eda.html"><a href="ch-eda.html#chapter-descript"><i class="fa fa-check"></i><b>3.1</b> Introduzione all’esplorazione dei dati</a></li>
<li class="chapter" data-level="3.2" data-path="ch-eda.html"><a href="ch-eda.html#un-excursus-storico"><i class="fa fa-check"></i><b>3.2</b> Un excursus storico</a></li>
<li class="chapter" data-level="3.3" data-path="ch-eda.html"><a href="ch-eda.html#riassumere-i-dati"><i class="fa fa-check"></i><b>3.3</b> Riassumere i dati</a></li>
<li class="chapter" data-level="3.4" data-path="ch-eda.html"><a href="ch-eda.html#i-dati-grezzi"><i class="fa fa-check"></i><b>3.4</b> I dati grezzi</a></li>
<li class="chapter" data-level="3.5" data-path="ch-eda.html"><a href="ch-eda.html#distribuzioni-di-frequenze"><i class="fa fa-check"></i><b>3.5</b> Distribuzioni di frequenze</a></li>
<li class="chapter" data-level="3.6" data-path="ch-eda.html"><a href="ch-eda.html#istogramma"><i class="fa fa-check"></i><b>3.6</b> Istogramma</a></li>
<li class="chapter" data-level="3.7" data-path="ch-eda.html"><a href="ch-eda.html#kernel-density-plot"><i class="fa fa-check"></i><b>3.7</b> Kernel density plot</a></li>
<li class="chapter" data-level="3.8" data-path="ch-eda.html"><a href="ch-eda.html#forma-di-una-distribuzione"><i class="fa fa-check"></i><b>3.8</b> Forma di una distribuzione</a></li>
<li class="chapter" data-level="3.9" data-path="ch-eda.html"><a href="ch-eda.html#indici-di-posizione"><i class="fa fa-check"></i><b>3.9</b> Indici di posizione</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="ch-eda.html"><a href="ch-eda.html#quantili"><i class="fa fa-check"></i><b>3.9.1</b> Quantili</a></li>
<li class="chapter" data-level="3.9.2" data-path="ch-eda.html"><a href="ch-eda.html#diagramma-a-scatola"><i class="fa fa-check"></i><b>3.9.2</b> Diagramma a scatola</a></li>
<li class="chapter" data-level="3.9.3" data-path="ch-eda.html"><a href="ch-eda.html#sina-plot"><i class="fa fa-check"></i><b>3.9.3</b> Sina plot</a></li>
<li class="chapter" data-level="3.9.4" data-path="ch-eda.html"><a href="ch-eda.html#leccellenza-grafica"><i class="fa fa-check"></i><b>3.9.4</b> L’eccellenza grafica</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-eda.html"><a href="ch-eda.html#commenti-e-considerazioni-finali-1"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html"><i class="fa fa-check"></i><b>4</b> Indici di posizione e di scala</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-di-tendenza-centrale"><i class="fa fa-check"></i><b>4.1</b> Indici di tendenza centrale</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#media"><i class="fa fa-check"></i><b>4.1.1</b> Media</a></li>
<li class="chapter" data-level="4.1.2" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#media-spuntata"><i class="fa fa-check"></i><b>4.1.2</b> Media spuntata</a></li>
<li class="chapter" data-level="4.1.3" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#moda-e-mediana"><i class="fa fa-check"></i><b>4.1.3</b> Moda e mediana</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-di-dispersione"><i class="fa fa-check"></i><b>4.2</b> Indici di dispersione</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-basati-sullordinamento-dei-dati"><i class="fa fa-check"></i><b>4.2.1</b> Indici basati sull’ordinamento dei dati</a></li>
<li class="chapter" data-level="4.2.2" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#varianza"><i class="fa fa-check"></i><b>4.2.2</b> Varianza</a></li>
<li class="chapter" data-level="4.2.3" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#precisione"><i class="fa fa-check"></i><b>4.2.3</b> Precisione</a></li>
<li class="chapter" data-level="4.2.4" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#scarto-tipo"><i class="fa fa-check"></i><b>4.2.4</b> Scarto tipo</a></li>
<li class="chapter" data-level="4.2.5" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#deviazione-mediana-assoluta"><i class="fa fa-check"></i><b>4.2.5</b> Deviazione mediana assoluta</a></li>
<li class="chapter" data-level="4.2.6" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#indici-di-variabilità-relativi"><i class="fa fa-check"></i><b>4.2.6</b> Indici di variabilità relativi</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-loc-scale.html"><a href="ch-loc-scale.html#commenti-e-considerazioni-finali-2"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-corr.html"><a href="ch-corr.html"><i class="fa fa-check"></i><b>5</b> Le relazioni tra variabili</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-corr.html"><a href="ch-corr.html#diagramma-a-dispersione"><i class="fa fa-check"></i><b>5.1</b> Diagramma a dispersione</a></li>
<li class="chapter" data-level="5.2" data-path="ch-corr.html"><a href="ch-corr.html#covarianza"><i class="fa fa-check"></i><b>5.2</b> Covarianza</a></li>
<li class="chapter" data-level="5.3" data-path="ch-corr.html"><a href="ch-corr.html#correlazione"><i class="fa fa-check"></i><b>5.3</b> Correlazione</a></li>
<li class="chapter" data-level="5.4" data-path="ch-corr.html"><a href="ch-corr.html#correlazione-e-causazione"><i class="fa fa-check"></i><b>5.4</b> Correlazione e causazione</a></li>
<li class="chapter" data-level="5.5" data-path="ch-corr.html"><a href="ch-corr.html#usi-della-correlazione"><i class="fa fa-check"></i><b>5.5</b> Usi della correlazione</a></li>
<li class="chapter" data-level="5.6" data-path="ch-corr.html"><a href="ch-corr.html#correlazione-di-spearman"><i class="fa fa-check"></i><b>5.6</b> Correlazione di Spearman</a></li>
<li class="chapter" data-level="5.7" data-path="ch-corr.html"><a href="ch-corr.html#correlazione-nulla"><i class="fa fa-check"></i><b>5.7</b> Correlazione nulla</a></li>
<li class="chapter" data-level="" data-path="ch-corr.html"><a href="ch-corr.html#commenti-e-considerazioni-finali-3"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>III Il calcolo delle probabilità</b></span></li>
<li class="chapter" data-level="6" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html"><i class="fa fa-check"></i><b>6</b> La logica dell’incerto</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#che-cosè-la-probabilità"><i class="fa fa-check"></i><b>6.1</b> Che cos’è la probabilità?</a></li>
<li class="chapter" data-level="6.2" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#variabili-casuali-e-probabilità-di-un-evento"><i class="fa fa-check"></i><b>6.2</b> Variabili casuali e probabilità di un evento</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#eventi-e-probabilità"><i class="fa fa-check"></i><b>6.2.1</b> Eventi e probabilità</a></li>
<li class="chapter" data-level="6.2.2" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#spazio-campione-e-risultati-possibili"><i class="fa fa-check"></i><b>6.2.2</b> Spazio campione e risultati possibili</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#variabili-casuali-1"><i class="fa fa-check"></i><b>6.3</b> Variabili casuali</a></li>
<li class="chapter" data-level="6.4" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#usare-la-simulazione-per-stimare-le-probabilità"><i class="fa fa-check"></i><b>6.4</b> Usare la simulazione per stimare le probabilità</a></li>
<li class="chapter" data-level="6.5" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#la-legge-dei-grandi-numeri"><i class="fa fa-check"></i><b>6.5</b> La legge dei grandi numeri</a></li>
<li class="chapter" data-level="6.6" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#variabili-casuali-multiple"><i class="fa fa-check"></i><b>6.6</b> Variabili casuali multiple</a></li>
<li class="chapter" data-level="6.7" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#sec:fun-mass-prob"><i class="fa fa-check"></i><b>6.7</b> Funzione di massa di probabilità</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#funzione-di-ripartizione"><i class="fa fa-check"></i><b>6.7.1</b> Funzione di ripartizione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-intro-prob-1.html"><a href="ch-intro-prob-1.html#commenti-e-considerazioni-finali-4"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html"><i class="fa fa-check"></i><b>7</b> Probabilità condizionata</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#sec:bayes-cancer"><i class="fa fa-check"></i><b>7.1</b> Probabilità condizionata su altri eventi</a></li>
<li class="chapter" data-level="7.2" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#la-regola-moltiplicativa"><i class="fa fa-check"></i><b>7.2</b> La regola moltiplicativa</a></li>
<li class="chapter" data-level="7.3" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#lindipendendenza-stocastica"><i class="fa fa-check"></i><b>7.3</b> L’indipendendenza stocastica</a></li>
<li class="chapter" data-level="7.4" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#il-teorema-della-probabilità-totale"><i class="fa fa-check"></i><b>7.4</b> Il teorema della probabilità totale</a></li>
<li class="chapter" data-level="7.5" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#il-teorema-della-probabilità-assoluta"><i class="fa fa-check"></i><b>7.5</b> Il teorema della probabilità assoluta</a></li>
<li class="chapter" data-level="7.6" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#indipendenza-condizionale"><i class="fa fa-check"></i><b>7.6</b> Indipendenza condizionale</a></li>
<li class="chapter" data-level="" data-path="ch-prob-cond.html"><a href="ch-prob-cond.html#commenti-e-considerazioni-finali-5"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-theorem-bayes.html"><a href="ch-theorem-bayes.html"><i class="fa fa-check"></i><b>8</b> Il teorema di Bayes</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch-theorem-bayes.html"><a href="ch-theorem-bayes.html#il-teorema-di-bayes"><i class="fa fa-check"></i><b>8.1</b> Il teorema di Bayes</a></li>
<li class="chapter" data-level="" data-path="ch-theorem-bayes.html"><a href="ch-theorem-bayes.html#commenti-e-considerazioni-finali-6"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html"><i class="fa fa-check"></i><b>9</b> Probabilità congiunta</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#funzione-di-probabilità-congiunta"><i class="fa fa-check"></i><b>9.1</b> Funzione di probabilità congiunta</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#proprietà"><i class="fa fa-check"></i><b>9.1.1</b> Proprietà</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#eventi"><i class="fa fa-check"></i><b>9.1.2</b> Eventi</a></li>
<li class="chapter" data-level="9.1.3" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#sec:marg-distr-discr"><i class="fa fa-check"></i><b>9.1.3</b> Funzioni di probabilità marginali</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#sec:margin-vc-cont"><i class="fa fa-check"></i><b>9.2</b> Marginalizzazione di variabili casuali continue</a></li>
<li class="chapter" data-level="" data-path="ch-prob-congiunta.html"><a href="ch-prob-congiunta.html#commenti-e-considerazioni-finali-7"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html"><i class="fa fa-check"></i><b>10</b> La densità di probabilità</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#spinner-e-variabili-casuali-continue-uniformi"><i class="fa fa-check"></i><b>10.1</b> Spinner e variabili casuali continue uniformi</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#il-paradosso-delle-variabili-casuali-continue"><i class="fa fa-check"></i><b>10.1.1</b> Il paradosso delle variabili casuali continue</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#la-funzione-di-ripartizione-per-una-variabile-casuale-continua"><i class="fa fa-check"></i><b>10.2</b> La funzione di ripartizione per una variabile casuale continua</a></li>
<li class="chapter" data-level="10.3" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#la-distribuzione-uniforme"><i class="fa fa-check"></i><b>10.3</b> La distribuzione uniforme</a></li>
<li class="chapter" data-level="10.4" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#dagli-istogrammi-alle-densità"><i class="fa fa-check"></i><b>10.4</b> Dagli istogrammi alle densità</a></li>
<li class="chapter" data-level="10.5" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#funzione-di-densità-di-probabilità"><i class="fa fa-check"></i><b>10.5</b> Funzione di densità di probabilità</a></li>
<li class="chapter" data-level="10.6" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#la-funzione-di-ripartizione"><i class="fa fa-check"></i><b>10.6</b> La funzione di ripartizione</a></li>
<li class="chapter" data-level="10.7" data-path="ch-intro-density-function.html"><a href="ch-intro-density-function.html#media-e-mediana"><i class="fa fa-check"></i><b>10.7</b> Media e mediana</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html"><i class="fa fa-check"></i><b>11</b> Valore atteso e varianza</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#valore-atteso"><i class="fa fa-check"></i><b>11.1</b> Valore atteso</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#interpretazione"><i class="fa fa-check"></i><b>11.1.1</b> Interpretazione</a></li>
<li class="chapter" data-level="11.1.2" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#proprietà-del-valore-atteso"><i class="fa fa-check"></i><b>11.1.2</b> Proprietà del valore atteso</a></li>
<li class="chapter" data-level="11.1.3" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#variabili-casuali-continue"><i class="fa fa-check"></i><b>11.1.3</b> Variabili casuali continue</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#varianza-1"><i class="fa fa-check"></i><b>11.2</b> Varianza</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#formula-alternativa-per-la-varianza"><i class="fa fa-check"></i><b>11.2.1</b> Formula alternativa per la varianza</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#variabili-casuali-continue-1"><i class="fa fa-check"></i><b>11.2.2</b> Variabili casuali continue</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#deviazione-standard"><i class="fa fa-check"></i><b>11.3</b> Deviazione standard</a></li>
<li class="chapter" data-level="11.4" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#standardizzazione"><i class="fa fa-check"></i><b>11.4</b> Standardizzazione</a></li>
<li class="chapter" data-level="11.5" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#momenti-di-variabili-casuali"><i class="fa fa-check"></i><b>11.5</b> Momenti di variabili casuali</a></li>
<li class="chapter" data-level="11.6" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#covarianza-1"><i class="fa fa-check"></i><b>11.6</b> Covarianza</a></li>
<li class="chapter" data-level="11.7" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#correlazione-1"><i class="fa fa-check"></i><b>11.7</b> Correlazione</a></li>
<li class="chapter" data-level="11.8" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#proprietà-1"><i class="fa fa-check"></i><b>11.8</b> Proprietà</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#incorrelazione"><i class="fa fa-check"></i><b>11.8.1</b> Incorrelazione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-expval-var-rv.html"><a href="ch-expval-var-rv.html#conclusioni"><i class="fa fa-check"></i>Conclusioni</a></li>
</ul></li>
<li class="part"><span><b>IV Distribuzioni teoriche di probabilità</b></span></li>
<li class="chapter" data-level="12" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html"><i class="fa fa-check"></i><b>12</b> Distribuzioni di v.c. discrete</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#una-prova-bernoulliana"><i class="fa fa-check"></i><b>12.1</b> Una prova Bernoulliana</a></li>
<li class="chapter" data-level="12.2" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#una-sequenza-di-prove-bernoulliane"><i class="fa fa-check"></i><b>12.2</b> Una sequenza di prove Bernoulliane</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#valore-atteso-e-deviazione-standard"><i class="fa fa-check"></i><b>12.2.1</b> Valore atteso e deviazione standard</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#distribuzione-di-poisson"><i class="fa fa-check"></i><b>12.3</b> Distribuzione di Poisson</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#alcune-proprietà-della-variabile-di-poisson"><i class="fa fa-check"></i><b>12.3.1</b> Alcune proprietà della variabile di Poisson</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#distribuzione-discreta-uniforme"><i class="fa fa-check"></i><b>12.4</b> Distribuzione discreta uniforme</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#usiamo-textsfr"><i class="fa fa-check"></i><b>12.4.1</b> Usiamo <span class="math inline">\(\textsf{R}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#distribuzione-beta-binomiale"><i class="fa fa-check"></i><b>12.5</b> Distribuzione beta-binomiale</a></li>
<li class="chapter" data-level="" data-path="ch-distr-rv-discr.html"><a href="ch-distr-rv-discr.html#commenti-e-considerazioni-finali-8"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html"><i class="fa fa-check"></i><b>13</b> Distribuzioni di v.c. continue</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-normale"><i class="fa fa-check"></i><b>13.1</b> Distribuzione Normale</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#limite-delle-distribuzioni-binomiali"><i class="fa fa-check"></i><b>13.1.1</b> Limite delle distribuzioni binomiali</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#normal-random-walk"><i class="fa fa-check"></i><b>13.2</b> La Normale prodotta con una simulazione</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#concentrazione"><i class="fa fa-check"></i><b>13.2.1</b> Concentrazione</a></li>
<li class="chapter" data-level="13.2.2" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#funzione-di-ripartizione-1"><i class="fa fa-check"></i><b>13.2.2</b> Funzione di ripartizione</a></li>
<li class="chapter" data-level="13.2.3" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-normale-standard"><i class="fa fa-check"></i><b>13.2.3</b> Distribuzione Normale standard</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#teorema-del-limite-centrale"><i class="fa fa-check"></i><b>13.3</b> Teorema del limite centrale</a></li>
<li class="chapter" data-level="13.4" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-chi-quadrato"><i class="fa fa-check"></i><b>13.4</b> Distribuzione Chi-quadrato</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#proprietà-2"><i class="fa fa-check"></i><b>13.4.1</b> Proprietà</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-t-di-student"><i class="fa fa-check"></i><b>13.5</b> Distribuzione <span class="math inline">\(t\)</span> di Student</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#proprietà-3"><i class="fa fa-check"></i><b>13.5.1</b> Proprietà</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#funzione-beta"><i class="fa fa-check"></i><b>13.6</b> Funzione beta</a></li>
<li class="chapter" data-level="13.7" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-beta"><i class="fa fa-check"></i><b>13.7</b> Distribuzione Beta</a></li>
<li class="chapter" data-level="13.8" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-di-cauchy"><i class="fa fa-check"></i><b>13.8</b> Distribuzione di Cauchy</a></li>
<li class="chapter" data-level="13.9" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-log-normale"><i class="fa fa-check"></i><b>13.9</b> Distribuzione log-normale</a></li>
<li class="chapter" data-level="13.10" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#distribuzione-di-pareto"><i class="fa fa-check"></i><b>13.10</b> Distribuzione di Pareto</a></li>
<li class="chapter" data-level="" data-path="ch-distr-rv-cont.html"><a href="ch-distr-rv-cont.html#commenti-e-considerazioni-finali-9"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>V Inferenza bayesiana</b></span></li>
<li class="chapter" data-level="14" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html"><i class="fa fa-check"></i><b>14</b> Flusso di lavoro bayesiano</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#modellizzazione-bayesiana"><i class="fa fa-check"></i><b>14.1</b> Modellizzazione bayesiana</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#notazione"><i class="fa fa-check"></i><b>14.1.1</b> Notazione</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzioni-a-priori"><i class="fa fa-check"></i><b>14.2</b> Distribuzioni a priori</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#tipologie-di-distribuzioni-a-priori"><i class="fa fa-check"></i><b>14.2.1</b> Tipologie di distribuzioni a priori</a></li>
<li class="chapter" data-level="14.2.2" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#selezione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>14.2.2</b> Selezione della distribuzione a priori</a></li>
<li class="chapter" data-level="14.2.3" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#unapplicazione-empirica"><i class="fa fa-check"></i><b>14.2.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#la-funzione-di-verosimiglianza"><i class="fa fa-check"></i><b>14.3</b> La funzione di verosimiglianza</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#notazione-1"><i class="fa fa-check"></i><b>14.3.1</b> Notazione</a></li>
<li class="chapter" data-level="14.3.2" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#la-log-verosimiglianza"><i class="fa fa-check"></i><b>14.3.2</b> La log-verosimiglianza</a></li>
<li class="chapter" data-level="14.3.3" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#unapplicazione-empirica-1"><i class="fa fa-check"></i><b>14.3.3</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#sec:const-normaliz-bino23"><i class="fa fa-check"></i><b>14.4</b> La verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#unapplicazione-empirica-2"><i class="fa fa-check"></i><b>14.4.1</b> Un’applicazione empirica</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzione-a-posteriori"><i class="fa fa-check"></i><b>14.5</b> Distribuzione a posteriori</a></li>
<li class="chapter" data-level="14.6" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzione-predittiva-a-priori"><i class="fa fa-check"></i><b>14.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="14.7" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#distribuzione-predittiva-a-posteriori"><i class="fa fa-check"></i><b>14.7</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="" data-path="ch-bayes-workflow.html"><a href="ch-bayes-workflow.html#commenti-e-considerazioni-finali-10"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html"><i class="fa fa-check"></i><b>15</b> Pensare ad una proporzione in termini soggettivi</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#ch-prior-discr-binom"><i class="fa fa-check"></i><b>15.1</b> Inferenza bayesiana con una distribuzione a priori discreta</a></li>
<li class="chapter" data-level="15.2" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#ch-prior-cont-binom"><i class="fa fa-check"></i><b>15.2</b> Inferenza bayesiana con una distribuzione a priori continua</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#quali-parametri-per-la-distribuzione-beta"><i class="fa fa-check"></i><b>15.2.1</b> Quali parametri per la distribuzione Beta?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-subj-think-prop.html"><a href="ch-subj-think-prop.html#commenti-e-considerazioni-finali-11"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html"><i class="fa fa-check"></i><b>16</b> Distribuzioni coniugate</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#lo-schema-beta-binomiale"><i class="fa fa-check"></i><b>16.1</b> Lo schema beta-binomiale</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#la-specificazione-della-distribuzione-a-priori"><i class="fa fa-check"></i><b>16.1.1</b> La specificazione della distribuzione a priori</a></li>
<li class="chapter" data-level="16.1.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#la-specificazione-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>16.1.2</b> La specificazione della distribuzione a posteriori</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#inferenza-bayesiana-con-distribuzioni-a-priori-continue"><i class="fa fa-check"></i><b>16.2</b> Inferenza bayesiana con distribuzioni a priori continue</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#approccio-bayesiano-alla-verifica-di-ipotesi"><i class="fa fa-check"></i><b>16.2.1</b> Approccio bayesiano alla verifica di ipotesi</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#intervalli-di-credibilità"><i class="fa fa-check"></i><b>16.2.2</b> Intervalli di credibilità</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#principali-distribuzioni-coniugate"><i class="fa fa-check"></i><b>16.3</b> Principali distribuzioni coniugate</a></li>
<li class="chapter" data-level="" data-path="ch-distr-coniugate.html"><a href="ch-distr-coniugate.html#commenti-e-considerazioni-finali-12"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html"><i class="fa fa-check"></i><b>17</b> L’influenza della distribuzione a priori</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#il-test-di-benchdel"><i class="fa fa-check"></i><b>17.1</b> Il test di Benchdel</a></li>
<li class="chapter" data-level="17.2" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#stessi-dati-ma-diverse-distribuzioni-a-priori"><i class="fa fa-check"></i><b>17.2</b> Stessi dati ma diverse distribuzioni a priori</a></li>
<li class="chapter" data-level="17.3" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#dati-diversi-ma-la-stessa-distribuzione-a-priori"><i class="fa fa-check"></i><b>17.3</b> Dati diversi ma la stessa distribuzione a priori</a></li>
<li class="chapter" data-level="17.4" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#dati-diversi-e-diverse-distribuzioni-a-priori"><i class="fa fa-check"></i><b>17.4</b> Dati diversi e diverse distribuzioni a priori</a></li>
<li class="chapter" data-level="17.5" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#collegare-le-intuizioni-alla-teoria"><i class="fa fa-check"></i><b>17.5</b> Collegare le intuizioni alla teoria</a></li>
<li class="chapter" data-level="" data-path="ch-prior-influence.html"><a href="ch-prior-influence.html#commenti-e-considerazioni-finali-13"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ch-post-approx.html"><a href="ch-post-approx.html"><i class="fa fa-check"></i><b>18</b> Approssimazione della distribuzione a posteriori</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ch-post-approx.html"><a href="ch-post-approx.html#metodo-basato-su-griglia"><i class="fa fa-check"></i><b>18.1</b> Metodo basato su griglia</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="ch-post-approx.html"><a href="ch-post-approx.html#modello-beta-binomiale"><i class="fa fa-check"></i><b>18.1.1</b> Modello Beta-Binomiale</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="ch-post-approx.html"><a href="ch-post-approx.html#chapter-simulazioneMC"><i class="fa fa-check"></i><b>18.2</b> Metodo Monte Carlo</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="ch-post-approx.html"><a href="ch-post-approx.html#integration-mc"><i class="fa fa-check"></i><b>18.2.1</b> Integrazione di Monte Carlo</a></li>
<li class="chapter" data-level="18.2.2" data-path="ch-post-approx.html"><a href="ch-post-approx.html#descrizione-intuitiva"><i class="fa fa-check"></i><b>18.2.2</b> Descrizione intuitiva</a></li>
<li class="chapter" data-level="18.2.3" data-path="ch-post-approx.html"><a href="ch-post-approx.html#unapplicazione-empirica-3"><i class="fa fa-check"></i><b>18.2.3</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="18.2.4" data-path="ch-post-approx.html"><a href="ch-post-approx.html#una-passeggiata-casuale-sui-numeri-naturali"><i class="fa fa-check"></i><b>18.2.4</b> Una passeggiata casuale sui numeri naturali</a></li>
<li class="chapter" data-level="18.2.5" data-path="ch-post-approx.html"><a href="ch-post-approx.html#lalgoritmo-di-metropolis"><i class="fa fa-check"></i><b>18.2.5</b> L’algoritmo di Metropolis</a></li>
<li class="chapter" data-level="18.2.6" data-path="ch-post-approx.html"><a href="ch-post-approx.html#unapplicazione-empirica-4"><i class="fa fa-check"></i><b>18.2.6</b> Un’applicazione empirica</a></li>
<li class="chapter" data-level="18.2.7" data-path="ch-post-approx.html"><a href="ch-post-approx.html#gibbs-sampling"><i class="fa fa-check"></i><b>18.2.7</b> Gibb’s sampling</a></li>
<li class="chapter" data-level="18.2.8" data-path="ch-post-approx.html"><a href="ch-post-approx.html#input"><i class="fa fa-check"></i><b>18.2.8</b> Input</a></li>
<li class="chapter" data-level="18.2.9" data-path="ch-post-approx.html"><a href="ch-post-approx.html#stazionarietà"><i class="fa fa-check"></i><b>18.2.9</b> Stazionarietà</a></li>
<li class="chapter" data-level="18.2.10" data-path="ch-post-approx.html"><a href="ch-post-approx.html#test-di-convergenza"><i class="fa fa-check"></i><b>18.2.10</b> Test di convergenza</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-post-approx.html"><a href="ch-post-approx.html#commenti-e-considerazioni-finali-14"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html"><i class="fa fa-check"></i><b>19</b> Il modello beta-binomiale in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="19.1" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#il-presidente-trump-e-lidrossiclorochina"><i class="fa fa-check"></i><b>19.1</b> Il presidente Trump e l’idrossiclorochina</a></li>
<li class="chapter" data-level="19.2" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#una-proporzione"><i class="fa fa-check"></i><b>19.2</b> Una proporzione</a></li>
<li class="chapter" data-level="19.3" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#cmdstanr-gautret"><i class="fa fa-check"></i><b>19.3</b> Interfaccia <code>cmdstanr</code></a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#fase-1"><i class="fa fa-check"></i><b>19.3.1</b> Fase 1</a></li>
<li class="chapter" data-level="19.3.2" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#fase-2"><i class="fa fa-check"></i><b>19.3.2</b> Fase 2</a></li>
<li class="chapter" data-level="19.3.3" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#fase-3"><i class="fa fa-check"></i><b>19.3.3</b> Fase 3</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#la-critica-di-hulme_2020"><i class="fa fa-check"></i><b>19.4</b> La critica di <span class="citation">Hulme et al. (<span>2020</span>)</span></a></li>
<li class="chapter" data-level="19.5" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#due-proporzioni"><i class="fa fa-check"></i><b>19.5</b> Due proporzioni</a></li>
<li class="chapter" data-level="" data-path="ch-stan-beta-binom.html"><a href="ch-stan-beta-binom.html#commenti-e-considerazioni-finali-15"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html"><i class="fa fa-check"></i><b>20</b> Diagnostica delle catene markoviane</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#esame-dei-trace-plot"><i class="fa fa-check"></i><b>20.1</b> Esame dei <em>trace plot</em></a></li>
<li class="chapter" data-level="20.2" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#confronto-delle-catene-parallele"><i class="fa fa-check"></i><b>20.2</b> Confronto delle catene parallele</a></li>
<li class="chapter" data-level="20.3" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#numerosita-campionaria-effettiva"><i class="fa fa-check"></i><b>20.3</b> Numerosità campionaria effettiva</a></li>
<li class="chapter" data-level="20.4" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#autocorrelazione"><i class="fa fa-check"></i><b>20.4</b> Autocorrelazione</a></li>
<li class="chapter" data-level="20.5" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#statistica-hatr"><i class="fa fa-check"></i><b>20.5</b> Statistica <span class="math inline">\(\hat{R}\)</span></a></li>
<li class="chapter" data-level="20.6" data-path="ch-diagn-markov-chains.html"><a href="ch-diagn-markov-chains.html#diagnostica-di-convergenza-di-geweke"><i class="fa fa-check"></i><b>20.6</b> Diagnostica di convergenza di Geweke</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html"><i class="fa fa-check"></i><b>21</b> Sintesi a posteriori</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#stima-puntuale"><i class="fa fa-check"></i><b>21.1</b> Stima puntuale</a></li>
<li class="chapter" data-level="21.2" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità"><i class="fa fa-check"></i><b>21.2</b> Intervallo di credibilità</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità-a-code-uguali"><i class="fa fa-check"></i><b>21.2.1</b> Intervallo di credibilità a code uguali</a></li>
<li class="chapter" data-level="21.2.2" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità-a-densità-a-posteriori-più-alta"><i class="fa fa-check"></i><b>21.2.2</b> Intervallo di credibilità a densità a posteriori più alta</a></li>
<li class="chapter" data-level="21.2.3" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#interpretazione-1"><i class="fa fa-check"></i><b>21.2.3</b> Interpretazione</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#un-esempio-concreto"><i class="fa fa-check"></i><b>21.3</b> Un esempio concreto</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#stime-puntuali-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>21.3.1</b> Stime puntuali della distribuzione a posteriori</a></li>
<li class="chapter" data-level="21.3.2" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#intervallo-di-credibilità-1"><i class="fa fa-check"></i><b>21.3.2</b> Intervallo di credibilità</a></li>
<li class="chapter" data-level="21.3.3" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#probabilità-della-distribuzione-a-posteriori"><i class="fa fa-check"></i><b>21.3.3</b> Probabilità della distribuzione a posteriori</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#la-funzione-di-perdita-attesa"><i class="fa fa-check"></i><b>21.4</b> La funzione di perdita attesa</a></li>
<li class="chapter" data-level="" data-path="ch-sintesi-distr-post.html"><a href="ch-sintesi-distr-post.html#commenti-e-considerazioni-finali-16"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ch-prediction.html"><a href="ch-prediction.html"><i class="fa fa-check"></i><b>22</b> La predizione bayesiana</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori"><i class="fa fa-check"></i><b>22.1</b> La distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="22.2" data-path="ch-prediction.html"><a href="ch-prediction.html#soluzione-analitica"><i class="fa fa-check"></i><b>22.2</b> Soluzione analitica</a></li>
<li class="chapter" data-level="22.3" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-simulazione"><i class="fa fa-check"></i><b>22.3</b> La distribuzione predittiva a posteriori mediante simulazione</a></li>
<li class="chapter" data-level="22.4" data-path="ch-prediction.html"><a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-mcmc"><i class="fa fa-check"></i><b>22.4</b> La distribuzione predittiva a posteriori mediante MCMC</a></li>
<li class="chapter" data-level="22.5" data-path="ch-prediction.html"><a href="ch-prediction.html#i-metodi-per-la-valutazione-del-modello"><i class="fa fa-check"></i><b>22.5</b> I metodi per la valutazione del modello</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="ch-prediction.html"><a href="ch-prediction.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>22.5.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="ch-prediction.html"><a href="ch-prediction.html#distribuzione-predittiva-a-priori-1"><i class="fa fa-check"></i><b>22.6</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="" data-path="ch-prediction.html"><a href="ch-prediction.html#commenti-e-considerazioni-finali-17"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html"><i class="fa fa-check"></i><b>23</b> Inferenza sul parametro <span class="math inline">\(\mu\)</span> (media di una v.c. Normale)</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#caso-normale-normale-con-varianza-nota"><i class="fa fa-check"></i><b>23.1</b> Caso Normale-Normale con varianza nota</a></li>
<li class="chapter" data-level="23.2" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#derivazione-analitica-della-distribuzione-a-posteriori-pmu-mid-y"><i class="fa fa-check"></i><b>23.2</b> Derivazione analitica della distribuzione a posteriori <span class="math inline">\(p(\mu \mid y)\)</span></a></li>
<li class="chapter" data-level="23.3" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#il-modello-normale-con-stan"><i class="fa fa-check"></i><b>23.3</b> Il modello Normale con Stan</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#versione-1-sigma-nota"><i class="fa fa-check"></i><b>23.3.1</b> Versione 1 (<span class="math inline">\(\sigma\)</span> nota)</a></li>
<li class="chapter" data-level="23.3.2" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#versione-2-sigma-incognita"><i class="fa fa-check"></i><b>23.3.2</b> Versione 2 (<span class="math inline">\(\sigma\)</span> incognita)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-normal-normal-mod-stan.html"><a href="ch-normal-normal-mod-stan.html#commenti-e-considerazioni-finali-18"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>VI Il modello lineare</b></span></li>
<li class="chapter" data-level="24" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html"><i class="fa fa-check"></i><b>24</b> Introduzione</a>
<ul>
<li class="chapter" data-level="24.1" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#la-funzione-lineare"><i class="fa fa-check"></i><b>24.1</b> La funzione lineare</a></li>
<li class="chapter" data-level="24.2" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#una-media-per-ciascuna-osservazione"><i class="fa fa-check"></i><b>24.2</b> Una media per ciascuna osservazione</a></li>
<li class="chapter" data-level="24.3" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#relazione-lineare-tra-la-media-y-mid-x-e-il-predittore"><i class="fa fa-check"></i><b>24.3</b> Relazione lineare tra la media <span class="math inline">\(y \mid x\)</span> e il predittore</a></li>
<li class="chapter" data-level="24.4" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#il-modello-lineare"><i class="fa fa-check"></i><b>24.4</b> Il modello lineare</a></li>
<li class="chapter" data-level="" data-path="ch-regr-intro.html"><a href="ch-regr-intro.html#commenti-e-considerazioni-finali-19"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html"><i class="fa fa-check"></i><b>25</b> Metodo dei minimi quadrati</a>
<ul>
<li class="chapter" data-level="25.1" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#stima-dei-coefficienti-di-regressione"><i class="fa fa-check"></i><b>25.1</b> Stima dei coefficienti di regressione</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#trasformazione-dei-dati"><i class="fa fa-check"></i><b>25.1.1</b> Trasformazione dei dati</a></li>
<li class="chapter" data-level="25.1.2" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#il-metodo-dei-minimi-quadrati"><i class="fa fa-check"></i><b>25.1.2</b> Il metodo dei minimi quadrati</a></li>
<li class="chapter" data-level="25.1.3" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#lerrore-standard-della-regressione"><i class="fa fa-check"></i><b>25.1.3</b> L’errore standard della regressione</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#indice-di-determinazione"><i class="fa fa-check"></i><b>25.2</b> Indice di determinazione</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#inferenza-sul-modello-di-regressione"><i class="fa fa-check"></i><b>25.2.1</b> Inferenza sul modello di regressione</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-regr-model-lm.html"><a href="ch-regr-model-lm.html#commenti-e-considerazioni-finali-20"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html"><i class="fa fa-check"></i><b>26</b> Modello di regressione in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="26.1" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#specificazione-del-modello"><i class="fa fa-check"></i><b>26.1</b> Specificazione del modello</a></li>
<li class="chapter" data-level="26.2" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#stima-bayesiana-in-linguaggio-stan"><i class="fa fa-check"></i><b>26.2</b> Stima bayesiana in linguaggio Stan</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#standardizzare-i-dati"><i class="fa fa-check"></i><b>26.2.1</b> Standardizzare i dati</a></li>
<li class="chapter" data-level="26.2.2" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#interpretazione-dei-parametri"><i class="fa fa-check"></i><b>26.2.2</b> Interpretazione dei parametri</a></li>
<li class="chapter" data-level="26.2.3" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#centrare-i-predittori"><i class="fa fa-check"></i><b>26.2.3</b> Centrare i predittori</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-reg-lin-stan.html"><a href="ch-reg-lin-stan.html#commenti-e-considerazioni-finali-21"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html"><i class="fa fa-check"></i><b>27</b> Inferenza sul modello lineare</a>
<ul>
<li class="chapter" data-level="27.1" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#rappresentazione-grafica-dellincertezza-della-stima"><i class="fa fa-check"></i><b>27.1</b> Rappresentazione grafica dell’incertezza della stima</a></li>
<li class="chapter" data-level="27.2" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#intervalli-di-credibilità-1"><i class="fa fa-check"></i><b>27.2</b> Intervalli di credibilità</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#quale-soglia-usare"><i class="fa fa-check"></i><b>27.2.1</b> Quale soglia usare?</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#test-di-ipotesi"><i class="fa fa-check"></i><b>27.3</b> Test di ipotesi</a></li>
<li class="chapter" data-level="27.4" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#modello-lineare-robusto"><i class="fa fa-check"></i><b>27.4</b> Modello lineare robusto</a></li>
<li class="chapter" data-level="" data-path="ch-inference-reg-lin-stan.html"><a href="ch-inference-reg-lin-stan.html#commenti-e-considerazioni-finali-22"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html"><i class="fa fa-check"></i><b>28</b> Confronto tra due gruppi indipendenti</a>
<ul>
<li class="chapter" data-level="28.1" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#modello-lineare-con-una-variabile-dicotomica"><i class="fa fa-check"></i><b>28.1</b> Modello lineare con una variabile dicotomica</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#confronti-non-effetti"><i class="fa fa-check"></i><b>28.1.1</b> Confronti, non effetti</a></li>
<li class="chapter" data-level="28.1.2" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#un-esempio-concreto-1"><i class="fa fa-check"></i><b>28.1.2</b> Un esempio concreto</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#la-dimensione-delleffetto"><i class="fa fa-check"></i><b>28.2</b> La dimensione dell’effetto</a></li>
<li class="chapter" data-level="" data-path="ch-comp-two-means-stan.html"><a href="ch-comp-two-means-stan.html#commenti-e-considerazioni-finali-23"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html"><i class="fa fa-check"></i><b>29</b> Predictive checks</a>
<ul>
<li class="chapter" data-level="29.1" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#distribuzione-predittiva-a-posteriori-1"><i class="fa fa-check"></i><b>29.1</b> Distribuzione predittiva a posteriori</a></li>
<li class="chapter" data-level="29.2" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#distribuzione-predittiva-a-priori-2"><i class="fa fa-check"></i><b>29.2</b> Distribuzione predittiva a priori</a></li>
<li class="chapter" data-level="" data-path="ch-pred-checks.html"><a href="ch-pred-checks.html#commenti-e-considerazioni-finali-24"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="ch-anova.html"><a href="ch-anova.html"><i class="fa fa-check"></i><b>30</b> Confronto di <span class="math inline">\(k\)</span> gruppi</a>
<ul>
<li class="chapter" data-level="30.1" data-path="ch-anova.html"><a href="ch-anova.html#le-abilità-sociali-di-un-robot"><i class="fa fa-check"></i><b>30.1</b> Le abilità sociali di un robot</a></li>
<li class="chapter" data-level="30.2" data-path="ch-anova.html"><a href="ch-anova.html#anova-ad-una-via"><i class="fa fa-check"></i><b>30.2</b> ANOVA ad una via</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="ch-anova.html"><a href="ch-anova.html#interpretazione-2"><i class="fa fa-check"></i><b>30.2.1</b> Interpretazione</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="ch-anova.html"><a href="ch-anova.html#anova-ad-due-vie"><i class="fa fa-check"></i><b>30.3</b> ANOVA ad due vie</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="ch-anova.html"><a href="ch-anova.html#test-sullinterazione"><i class="fa fa-check"></i><b>30.3.1</b> Test sull’interazione</a></li>
<li class="chapter" data-level="30.3.2" data-path="ch-anova.html"><a href="ch-anova.html#test-sugli-effetti-principali"><i class="fa fa-check"></i><b>30.3.2</b> Test sugli effetti principali</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="ch-anova.html"><a href="ch-anova.html#codice-stan-versione-2"><i class="fa fa-check"></i><b>30.4</b> Codice Stan (versione 2)</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html"><i class="fa fa-check"></i><b>31</b> Modello gerarchico</a>
<ul>
<li class="chapter" data-level="31.1" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-gerarchico"><i class="fa fa-check"></i><b>31.1</b> Modello gerarchico</a></li>
<li class="chapter" data-level="31.2" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-ad-effetti-fissi"><i class="fa fa-check"></i><b>31.2</b> Modello ad effetti fissi</a></li>
<li class="chapter" data-level="31.3" data-path="ch-mod-hier-stan.html"><a href="ch-mod-hier-stan.html#modello-gerarchico-1"><i class="fa fa-check"></i><b>31.3</b> Modello gerarchico</a></li>
</ul></li>
<li class="part"><span><b>VII Il confronto bayesiano di modelli</b></span></li>
<li class="chapter" data-level="32" data-path="ch-entropy.html"><a href="ch-entropy.html"><i class="fa fa-check"></i><b>32</b> Entropia</a>
<ul>
<li class="chapter" data-level="32.1" data-path="ch-entropy.html"><a href="ch-entropy.html#la-generalizzabilità-dei-modelli"><i class="fa fa-check"></i><b>32.1</b> La generalizzabilità dei modelli</a></li>
<li class="chapter" data-level="32.2" data-path="ch-entropy.html"><a href="ch-entropy.html#capacità-predittiva"><i class="fa fa-check"></i><b>32.2</b> Capacità predittiva</a></li>
<li class="chapter" data-level="32.3" data-path="ch-entropy.html"><a href="ch-entropy.html#il-rasoio-di-ockham"><i class="fa fa-check"></i><b>32.3</b> Il rasoio di Ockham</a>
<ul>
<li class="chapter" data-level="32.3.1" data-path="ch-entropy.html"><a href="ch-entropy.html#sovra-adattamento-e-sotto-adattamento"><i class="fa fa-check"></i><b>32.3.1</b> Sovra-adattamento e sotto-adattamento</a></li>
<li class="chapter" data-level="32.3.2" data-path="ch-entropy.html"><a href="ch-entropy.html#stargazing"><i class="fa fa-check"></i><b>32.3.2</b> Stargazing</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="ch-entropy.html"><a href="ch-entropy.html#la-misura-del-disordine"><i class="fa fa-check"></i><b>32.4</b> La misura del disordine</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="ch-entropy.html"><a href="ch-entropy.html#entropia-di-un-singolo-evento"><i class="fa fa-check"></i><b>32.4.1</b> Entropia di un singolo evento</a></li>
<li class="chapter" data-level="32.4.2" data-path="ch-entropy.html"><a href="ch-entropy.html#entropia-di-una-variabile-casuale"><i class="fa fa-check"></i><b>32.4.2</b> Entropia di una variabile casuale</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-entropy.html"><a href="ch-entropy.html#commenti-e-considerazioni-finali-25"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="ch-kl.html"><a href="ch-kl.html"><i class="fa fa-check"></i><b>33</b> La divergenza di Kullback-Leibler</a>
<ul>
<li class="chapter" data-level="33.1" data-path="ch-kl.html"><a href="ch-kl.html#la-perdita-di-informazione"><i class="fa fa-check"></i><b>33.1</b> La perdita di informazione</a></li>
<li class="chapter" data-level="33.2" data-path="ch-kl.html"><a href="ch-kl.html#la-divergenza-dipende-dalla-direzione"><i class="fa fa-check"></i><b>33.2</b> La divergenza dipende dalla direzione</a></li>
<li class="chapter" data-level="33.3" data-path="ch-kl.html"><a href="ch-kl.html#confronto-tra-modelli"><i class="fa fa-check"></i><b>33.3</b> Confronto tra modelli</a></li>
<li class="chapter" data-level="33.4" data-path="ch-kl.html"><a href="ch-kl.html#expected-log-predictive-density"><i class="fa fa-check"></i><b>33.4</b> Expected log predictive density</a>
<ul>
<li class="chapter" data-level="33.4.1" data-path="ch-kl.html"><a href="ch-kl.html#log-pointwise-predictive-density"><i class="fa fa-check"></i><b>33.4.1</b> Log pointwise predictive density</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-kl.html"><a href="ch-kl.html#commenti-e-considerazioni-finali-26"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="ch-info-crit.html"><a href="ch-info-crit.html"><i class="fa fa-check"></i><b>34</b> Criterio di informazione e convalida incrociata</a>
<ul>
<li class="chapter" data-level="34.1" data-path="ch-info-crit.html"><a href="ch-info-crit.html#aic-dic-e-waic"><i class="fa fa-check"></i><b>34.1</b> AIC, DIC e WAIC</a>
<ul>
<li class="chapter" data-level="34.1.1" data-path="ch-info-crit.html"><a href="ch-info-crit.html#criterio-dinformazione-di-akaike"><i class="fa fa-check"></i><b>34.1.1</b> Criterio d’informazione di Akaike</a></li>
</ul></li>
<li class="chapter" data-level="34.2" data-path="ch-info-crit.html"><a href="ch-info-crit.html#convalida-incrociata-k-fold"><i class="fa fa-check"></i><b>34.2</b> Convalida incrociata K-fold</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="ch-info-crit.html"><a href="ch-info-crit.html#importance-sampling"><i class="fa fa-check"></i><b>34.2.1</b> Importance sampling</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="ch-info-crit.html"><a href="ch-info-crit.html#confronto-tra-aic-e-loo-cv"><i class="fa fa-check"></i><b>34.3</b> Confronto tra AIC e LOO-CV</a></li>
<li class="chapter" data-level="34.4" data-path="ch-info-crit.html"><a href="ch-info-crit.html#confronto-tra-modelli-mediante-loo-cv"><i class="fa fa-check"></i><b>34.4</b> Confronto tra modelli mediante LOO-CV</a></li>
<li class="chapter" data-level="34.5" data-path="ch-info-crit.html"><a href="ch-info-crit.html#outlier"><i class="fa fa-check"></i><b>34.5</b> Outlier</a></li>
<li class="chapter" data-level="34.6" data-path="ch-info-crit.html"><a href="ch-info-crit.html#regolarizzazione"><i class="fa fa-check"></i><b>34.6</b> Regolarizzazione</a></li>
<li class="chapter" data-level="" data-path="ch-info-crit.html"><a href="ch-info-crit.html#commenti-e-considerazioni-finali-27"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="part"><span><b>VIII Approccio frequentista all’inferenza statistica</b></span></li>
<li class="chapter" data-level="35" data-path="ch-ttest.html"><a href="ch-ttest.html"><i class="fa fa-check"></i><b>35</b> Inferenza sulla media</a>
<ul>
<li class="chapter" data-level="35.1" data-path="ch-ttest.html"><a href="ch-ttest.html#la-ripetizione-dellesperimento-casuale"><i class="fa fa-check"></i><b>35.1</b> La ripetizione dell’esperimento casuale</a></li>
<li class="chapter" data-level="35.2" data-path="ch-ttest.html"><a href="ch-ttest.html#la-distribuzione-campionaria-della-media"><i class="fa fa-check"></i><b>35.2</b> La distribuzione campionaria della media</a></li>
<li class="chapter" data-level="35.3" data-path="ch-ttest.html"><a href="ch-ttest.html#inferenza-frequentista"><i class="fa fa-check"></i><b>35.3</b> Inferenza frequentista</a>
<ul>
<li class="chapter" data-level="35.3.1" data-path="ch-ttest.html"><a href="ch-ttest.html#il-test-dellipotesi-nulla"><i class="fa fa-check"></i><b>35.3.1</b> Il test dell’ipotesi nulla</a></li>
<li class="chapter" data-level="35.3.2" data-path="ch-ttest.html"><a href="ch-ttest.html#lintervallo-di-fiducia"><i class="fa fa-check"></i><b>35.3.2</b> L’Intervallo di fiducia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch-ttest.html"><a href="ch-ttest.html#commenti-e-considerazioni-finali-28"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><i class="fa fa-check"></i><b>36</b> La crisi della replicabilità dei risultati della ricerca</a>
<ul>
<li class="chapter" data-level="36.1" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#che-cosè-un-valore-p"><i class="fa fa-check"></i><b>36.1</b> Che cos’è un valore-<span class="math inline">\(p\)</span>?</a></li>
<li class="chapter" data-level="36.2" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#luso-del-valore-p-nel-mondo-della-ricerca"><i class="fa fa-check"></i><b>36.2</b> L’uso del valore-<span class="math inline">\(p\)</span> nel mondo della ricerca</a></li>
<li class="chapter" data-level="36.3" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#p-hacking"><i class="fa fa-check"></i><b>36.3</b> <span class="math inline">\(P\)</span>-hacking</a></li>
<li class="chapter" data-level="36.4" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#critiche-al-valore-p"><i class="fa fa-check"></i><b>36.4</b> Critiche al valore-<span class="math inline">\(p\)</span></a></li>
<li class="chapter" data-level="36.5" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#leffetto-sperimentale-è-esattamente-nullo"><i class="fa fa-check"></i><b>36.5</b> L’effetto sperimentale è esattamente nullo?</a></li>
<li class="chapter" data-level="36.6" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#simulazione"><i class="fa fa-check"></i><b>36.6</b> Simulazione</a>
<ul>
<li class="chapter" data-level="36.6.1" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#la-dimensione-delleffetto-1"><i class="fa fa-check"></i><b>36.6.1</b> La dimensione dell’effetto</a></li>
<li class="chapter" data-level="36.6.2" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#una-piccola-dimensione-delleffetto-nella-popolazione"><i class="fa fa-check"></i><b>36.6.2</b> Una piccola dimensione dell’effetto nella popolazione</a></li>
<li class="chapter" data-level="36.6.3" data-path="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html"><a href="la-crisi-della-replicabilità-dei-risultati-della-ricerca.html#una-soluzione-sbagliata"><i class="fa fa-check"></i><b>36.6.3</b> Una soluzione (sbagliata)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i><b>37</b> Bibliografia</a></li>
<li class="appendix"><span><b>Appendici</b></span></li>
<li class="chapter" data-level="A" data-path="simbologia-di-base.html"><a href="simbologia-di-base.html"><i class="fa fa-check"></i><b>A</b> Simbologia di base</a></li>
<li class="chapter" data-level="B" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html"><i class="fa fa-check"></i><b>B</b> Numeri binari, interi, razionali, irrazionali e reali</a>
<ul>
<li class="chapter" data-level="B.1" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-binari"><i class="fa fa-check"></i><b>B.1</b> Numeri binari</a></li>
<li class="chapter" data-level="B.2" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-interi"><i class="fa fa-check"></i><b>B.2</b> Numeri interi</a></li>
<li class="chapter" data-level="B.3" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-razionali"><i class="fa fa-check"></i><b>B.3</b> Numeri razionali</a></li>
<li class="chapter" data-level="B.4" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-irrazionali"><i class="fa fa-check"></i><b>B.4</b> Numeri irrazionali</a></li>
<li class="chapter" data-level="B.5" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#numeri-reali"><i class="fa fa-check"></i><b>B.5</b> Numeri reali</a></li>
<li class="chapter" data-level="B.6" data-path="numeri-binari-interi-razionali-irrazionali-e-reali.html"><a href="numeri-binari-interi-razionali-irrazionali-e-reali.html#intervalli"><i class="fa fa-check"></i><b>B.6</b> Intervalli</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="insiemistica.html"><a href="insiemistica.html"><i class="fa fa-check"></i><b>C</b> Insiemi</a>
<ul>
<li class="chapter" data-level="C.1" data-path="insiemistica.html"><a href="insiemistica.html#operazioni-tra-insiemi"><i class="fa fa-check"></i><b>C.1</b> Operazioni tra insiemi</a></li>
<li class="chapter" data-level="C.2" data-path="insiemistica.html"><a href="insiemistica.html#diagrammi-di-eulero-venn"><i class="fa fa-check"></i><b>C.2</b> Diagrammi di Eulero-Venn</a></li>
<li class="chapter" data-level="C.3" data-path="insiemistica.html"><a href="insiemistica.html#coppie-ordinate-e-prodotto-cartesiano"><i class="fa fa-check"></i><b>C.3</b> Coppie ordinate e prodotto cartesiano</a></li>
<li class="chapter" data-level="C.4" data-path="insiemistica.html"><a href="insiemistica.html#cardinalità"><i class="fa fa-check"></i><b>C.4</b> Cardinalità</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="sommatorie.html"><a href="sommatorie.html"><i class="fa fa-check"></i><b>D</b> Simbolo di somma (sommatorie)</a>
<ul>
<li class="chapter" data-level="D.1" data-path="sommatorie.html"><a href="sommatorie.html#manipolazione-di-somme"><i class="fa fa-check"></i><b>D.1</b> Manipolazione di somme</a>
<ul>
<li class="chapter" data-level="D.1.1" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-1-1"><i class="fa fa-check"></i><b>D.1.1</b> Proprietà 1</a></li>
<li class="chapter" data-level="D.1.2" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-2-proprietà-distributiva"><i class="fa fa-check"></i><b>D.1.2</b> Proprietà 2 (proprietà distributiva)</a></li>
<li class="chapter" data-level="D.1.3" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-3-proprietà-associativa"><i class="fa fa-check"></i><b>D.1.3</b> Proprietà 3 (proprietà associativa)</a></li>
<li class="chapter" data-level="D.1.4" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-4"><i class="fa fa-check"></i><b>D.1.4</b> Proprietà 4</a></li>
<li class="chapter" data-level="D.1.5" data-path="sommatorie.html"><a href="sommatorie.html#proprietà-5"><i class="fa fa-check"></i><b>D.1.5</b> Proprietà 5</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="sommatorie.html"><a href="sommatorie.html#doppia-sommatoria"><i class="fa fa-check"></i><b>D.2</b> Doppia sommatoria</a></li>
<li class="chapter" data-level="D.3" data-path="sommatorie.html"><a href="sommatorie.html#sommatorie-e-produttorie-e-operazioni-vettoriali-in-r"><i class="fa fa-check"></i><b>D.3</b> Sommatorie (e produttorie) e operazioni vettoriali in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="appendix:future-exp.html"><a href="appendix:future-exp.html"><i class="fa fa-check"></i><b>E</b> Le aspettative future dei pazienti depressi</a>
<ul>
<li class="chapter" data-level="E.1" data-path="appendix:future-exp.html"><a href="appendix:future-exp.html#app:zet"><i class="fa fa-check"></i><b>E.1</b> La ricerca di <span class="citation">Zetsche, Bürkner, and Renneberg (<span>2019</span>)</span></a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="appendix:beta-binom.html"><a href="appendix:beta-binom.html"><i class="fa fa-check"></i><b>F</b> Modello Beta-binomiale</a>
<ul>
<li class="chapter" data-level="F.1" data-path="appendix:beta-binom.html"><a href="appendix:beta-binom.html#funzione-per-il-modello-beta-binomiale"><i class="fa fa-check"></i><b>F.1</b> Funzione per il modello Beta-binomiale</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="appendix:const-norm-bino23.html"><a href="appendix:const-norm-bino23.html"><i class="fa fa-check"></i><b>G</b> Verosimiglianza marginale</a>
<ul>
<li class="chapter" data-level="G.1" data-path="appendix:const-norm-bino23.html"><a href="appendix:const-norm-bino23.html#derivazione-analitica-della-costante-di-normalizzazione"><i class="fa fa-check"></i><b>G.1</b> Derivazione analitica della costante di normalizzazione</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>H</b> Le catene di Markov</a>
<ul>
<li class="chapter" data-level="H.1" data-path="markov-chains.html"><a href="markov-chains.html#simulare-una-catena-di-markov"><i class="fa fa-check"></i><b>H.1</b> Simulare una catena di Markov</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="regr-ml.html"><a href="regr-ml.html"><i class="fa fa-check"></i><b>I</b> Adattare il modello lineare ai dati</a>
<ul>
<li class="chapter" data-level="I.1" data-path="regr-ml.html"><a href="regr-ml.html#minimi-quadrati"><i class="fa fa-check"></i><b>I.1</b> Minimi quadrati</a>
<ul>
<li class="chapter" data-level="I.1.1" data-path="regr-ml.html"><a href="regr-ml.html#stima-della-deviazione-standard-dei-residui-sigma"><i class="fa fa-check"></i><b>I.1.1</b> Stima della deviazione standard dei residui <span class="math inline">\(\sigma\)</span></a></li>
</ul></li>
<li class="chapter" data-level="I.2" data-path="regr-ml.html"><a href="regr-ml.html#calcolare-la-somma-dei-quadrati"><i class="fa fa-check"></i><b>I.2</b> Calcolare la somma dei quadrati</a></li>
<li class="chapter" data-level="" data-path="regr-ml.html"><a href="regr-ml.html#commenti-e-considerazioni-finali-29"><i class="fa fa-check"></i>Commenti e considerazioni finali</a></li>
</ul></li>
<li class="chapter" data-level="J" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html"><i class="fa fa-check"></i><b>J</b> Introduzione al linguaggio R</a>
<ul>
<li class="chapter" data-level="J.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#prerequisiti"><i class="fa fa-check"></i><b>J.1</b> Prerequisiti</a>
<ul>
<li class="chapter" data-level="J.1.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#installare-r-e-rstudio"><i class="fa fa-check"></i><b>J.1.1</b> Installare R e RStudio</a></li>
<li class="chapter" data-level="J.1.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#utilizzare-rstudio-per-semplificare-il-lavoro"><i class="fa fa-check"></i><b>J.1.2</b> Utilizzare RStudio per semplificare il lavoro</a></li>
<li class="chapter" data-level="J.1.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#eseguire-il-codice"><i class="fa fa-check"></i><b>J.1.3</b> Eseguire il codice</a></li>
</ul></li>
<li class="chapter" data-level="J.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#installare-cmdstan"><i class="fa fa-check"></i><b>J.2</b> Installare <code>cmdstan</code></a></li>
<li class="chapter" data-level="J.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-sintassi"><i class="fa fa-check"></i><b>J.3</b> Sintassi di base</a>
<ul>
<li class="chapter" data-level="J.3.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#utilizzare-la-console-mathsfr-come-calcolatrice"><i class="fa fa-check"></i><b>J.3.1</b> Utilizzare la console <span class="math inline">\(\mathsf{R}\)</span> come calcolatrice</a></li>
<li class="chapter" data-level="J.3.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#espressioni"><i class="fa fa-check"></i><b>J.3.2</b> Espressioni</a></li>
<li class="chapter" data-level="J.3.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#oggetti"><i class="fa fa-check"></i><b>J.3.3</b> Oggetti</a></li>
<li class="chapter" data-level="J.3.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#variabili"><i class="fa fa-check"></i><b>J.3.4</b> Variabili</a></li>
<li class="chapter" data-level="J.3.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#r-console"><i class="fa fa-check"></i><b>J.3.5</b> R console</a></li>
<li class="chapter" data-level="J.3.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#parentesi"><i class="fa fa-check"></i><b>J.3.6</b> Parentesi</a></li>
<li class="chapter" data-level="J.3.7" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#i-nomi-degli-oggetti"><i class="fa fa-check"></i><b>J.3.7</b> I nomi degli oggetti</a></li>
<li class="chapter" data-level="J.3.8" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#permanenza-dei-dati-e-rimozione-di-oggetti"><i class="fa fa-check"></i><b>J.3.8</b> Permanenza dei dati e rimozione di oggetti</a></li>
<li class="chapter" data-level="J.3.9" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chiudere-r"><i class="fa fa-check"></i><b>J.3.9</b> Chiudere R</a></li>
<li class="chapter" data-level="J.3.10" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#creare-ed-eseguire-uno-script-r-con-un-editore"><i class="fa fa-check"></i><b>J.3.10</b> Creare ed eseguire uno script R con un editore</a></li>
<li class="chapter" data-level="J.3.11" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#commentare-il-codice"><i class="fa fa-check"></i><b>J.3.11</b> Commentare il codice</a></li>
<li class="chapter" data-level="J.3.12" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#cambiare-la-cartella-di-lavoro"><i class="fa fa-check"></i><b>J.3.12</b> Cambiare la cartella di lavoro</a></li>
<li class="chapter" data-level="J.3.13" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#loggetto-base-di-r-il-vettore"><i class="fa fa-check"></i><b>J.3.13</b> L’oggetto base di R: il vettore</a></li>
<li class="chapter" data-level="J.3.14" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#operazioni-vettorializzate"><i class="fa fa-check"></i><b>J.3.14</b> Operazioni vettorializzate</a></li>
<li class="chapter" data-level="J.3.15" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori-aritmetici"><i class="fa fa-check"></i><b>J.3.15</b> Vettori aritmetici</a></li>
<li class="chapter" data-level="J.3.16" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#generazione-di-sequenze-regolari"><i class="fa fa-check"></i><b>J.3.16</b> Generazione di sequenze regolari</a></li>
<li class="chapter" data-level="J.3.17" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#generazione-di-numeri-casuali"><i class="fa fa-check"></i><b>J.3.17</b> Generazione di numeri casuali</a></li>
<li class="chapter" data-level="J.3.18" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori-logici"><i class="fa fa-check"></i><b>J.3.18</b> Vettori logici</a></li>
<li class="chapter" data-level="J.3.19" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dati-mancanti"><i class="fa fa-check"></i><b>J.3.19</b> Dati mancanti</a></li>
<li class="chapter" data-level="J.3.20" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori-di-caratteri-e-fattori"><i class="fa fa-check"></i><b>J.3.20</b> Vettori di caratteri e fattori</a></li>
<li class="chapter" data-level="J.3.21" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#funzioni-1"><i class="fa fa-check"></i><b>J.3.21</b> Funzioni</a></li>
<li class="chapter" data-level="J.3.22" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#scrivere-proprie-funzioni"><i class="fa fa-check"></i><b>J.3.22</b> Scrivere proprie funzioni</a></li>
<li class="chapter" data-level="J.3.23" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#pacchetti"><i class="fa fa-check"></i><b>J.3.23</b> Pacchetti</a></li>
<li class="chapter" data-level="J.3.24" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#istallazione-e-upgrade-dei-pacchetti"><i class="fa fa-check"></i><b>J.3.24</b> Istallazione e upgrade dei pacchetti</a></li>
<li class="chapter" data-level="J.3.25" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#caricare-un-pacchetto-in-r"><i class="fa fa-check"></i><b>J.3.25</b> Caricare un pacchetto in R</a></li>
</ul></li>
<li class="chapter" data-level="J.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-strutture-dati"><i class="fa fa-check"></i><b>J.4</b> Strutture di dati</a>
<ul>
<li class="chapter" data-level="J.4.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#classi-e-modi-degli-oggetti"><i class="fa fa-check"></i><b>J.4.1</b> Classi e modi degli oggetti</a></li>
<li class="chapter" data-level="J.4.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#vettori"><i class="fa fa-check"></i><b>J.4.2</b> Vettori</a></li>
<li class="chapter" data-level="J.4.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#matrici"><i class="fa fa-check"></i><b>J.4.3</b> Matrici</a></li>
<li class="chapter" data-level="J.4.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#array"><i class="fa fa-check"></i><b>J.4.4</b> Array</a></li>
<li class="chapter" data-level="J.4.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#operazioni-aritmetiche-su-vettori-matrici-e-array"><i class="fa fa-check"></i><b>J.4.5</b> Operazioni aritmetiche su vettori, matrici e array</a></li>
<li class="chapter" data-level="J.4.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#liste"><i class="fa fa-check"></i><b>J.4.6</b> Liste</a></li>
<li class="chapter" data-level="J.4.7" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#data-frame"><i class="fa fa-check"></i><b>J.4.7</b> Data frame</a></li>
<li class="chapter" data-level="J.4.8" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#giochi-di-carte"><i class="fa fa-check"></i><b>J.4.8</b> Giochi di carte</a></li>
<li class="chapter" data-level="J.4.9" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#variabili-locali"><i class="fa fa-check"></i><b>J.4.9</b> Variabili locali</a></li>
</ul></li>
<li class="chapter" data-level="J.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-strut-contr"><i class="fa fa-check"></i><b>J.5</b> Strutture di controllo</a>
<ul>
<li class="chapter" data-level="J.5.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#il-ciclo-for"><i class="fa fa-check"></i><b>J.5.1</b> Il ciclo <code>for</code></a></li>
</ul></li>
<li class="chapter" data-level="J.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#chapter-input-output"><i class="fa fa-check"></i><b>J.6</b> Input/Output</a>
<ul>
<li class="chapter" data-level="J.6.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#la-funzione-read.table"><i class="fa fa-check"></i><b>J.6.1</b> La funzione <code>read.table()</code></a></li>
<li class="chapter" data-level="J.6.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#file-di-dati-forniti-da-r"><i class="fa fa-check"></i><b>J.6.2</b> File di dati forniti da R</a></li>
<li class="chapter" data-level="J.6.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#esportazione-di-un-file"><i class="fa fa-check"></i><b>J.6.3</b> Esportazione di un file</a></li>
<li class="chapter" data-level="J.6.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#pacchetto-rio"><i class="fa fa-check"></i><b>J.6.4</b> Pacchetto <code>rio</code></a></li>
<li class="chapter" data-level="J.6.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dove-sono-i-miei-file"><i class="fa fa-check"></i><b>J.6.5</b> Dove sono i miei file?</a></li>
</ul></li>
<li class="chapter" data-level="J.7" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#manipolazione-dei-dati"><i class="fa fa-check"></i><b>J.7</b> Manipolazione dei dati</a>
<ul>
<li class="chapter" data-level="J.7.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#motivazione"><i class="fa fa-check"></i><b>J.7.1</b> Motivazione</a></li>
<li class="chapter" data-level="J.7.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#trattamento-dei-dati-con-dplyr"><i class="fa fa-check"></i><b>J.7.2</b> Trattamento dei dati con <code>dplyr</code></a></li>
<li class="chapter" data-level="J.7.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dati-categoriali-in-r"><i class="fa fa-check"></i><b>J.7.3</b> Dati categoriali in <code>R</code></a></li>
<li class="chapter" data-level="J.7.4" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#creare-grafici-con-ggplot2"><i class="fa fa-check"></i><b>J.7.4</b> Creare grafici con <code>ggplot2()</code></a></li>
<li class="chapter" data-level="J.7.5" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#diagramma-a-dispersione-1"><i class="fa fa-check"></i><b>J.7.5</b> Diagramma a dispersione</a></li>
<li class="chapter" data-level="J.7.6" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#scrivere-il-codice-r-con-stile"><i class="fa fa-check"></i><b>J.7.6</b> Scrivere il codice <code>R</code> con stile</a></li>
</ul></li>
<li class="chapter" data-level="J.8" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#flusso-di-lavoro-riproducibile"><i class="fa fa-check"></i><b>J.8</b> Flusso di lavoro riproducibile</a>
<ul>
<li class="chapter" data-level="J.8.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#la-crisi-della-riproducibilità"><i class="fa fa-check"></i><b>J.8.1</b> La crisi della riproducibilità</a></li>
<li class="chapter" data-level="J.8.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#r-markdown"><i class="fa fa-check"></i><b>J.8.2</b> R-markdown</a></li>
<li class="chapter" data-level="J.8.3" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#compilare-la-presentazione-r-markdown"><i class="fa fa-check"></i><b>J.8.3</b> Compilare la presentazione R-markdown</a></li>
</ul></li>
<li class="chapter" data-level="J.9" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#dati-mancanti-1"><i class="fa fa-check"></i><b>J.9</b> Dati mancanti</a>
<ul>
<li class="chapter" data-level="J.9.1" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#motivazione-1"><i class="fa fa-check"></i><b>J.9.1</b> Motivazione</a></li>
<li class="chapter" data-level="J.9.2" data-path="introduzione-al-linguaggio-r.html"><a href="introduzione-al-linguaggio-r.html#trattamento-dei-dati-mancanti"><i class="fa fa-check"></i><b>J.9.2</b> Trattamento dei dati mancanti</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science per psicologi</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-prediction" class="section level1 hasAnchor" number="22">
<h1><span class="header-section-number">Capitolo 22</span> La predizione bayesiana<a href="ch-prediction.html#ch-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Oltre ad una sintesi della distribuzione a posteriori attraverso il computo di indici caratteristici e alla verifica di ipotesi, un altro compito dell’analisi bayesiana è la predizione di nuovi dati futuri. Dopo aver osservato i dati di un campione e dopo avere ricavato le distribuzioni a posteriori dei parametri, è infatti possibile ottenere delle indicazioni sulle proprietà di dati futuri. L’uso più immediato della stima della distribuzione dei possibili valori futuri della variabile di esito è la verifica del modello in esame. Infatti, il modo più diretto per testare un modello è quello di utilizzare il modello corrente per fare previsioni sui possibili dati futuri per poi confrontare i dati predetti con i dati che sono stati effettivamente osservati nel campione corrente. Questa pratica va sotto il nome di <em>controllo predittivo a posteriori</em>. In questo capitolo ci focalizzeremo sul problema della predizione bayesiana esaminando il caso più semplice, ovvero lo schema beta-binomiale. In seguito estenderemo questa discussione al caso generale.</p>
<div id="la-distribuzione-predittiva-a-posteriori" class="section level2 hasAnchor" number="22.1">
<h2><span class="header-section-number">22.1</span> La distribuzione predittiva a posteriori<a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una volta costruita la distribuzione a posteriori del parametro o dei parametri sconosciuti, potremmo essere interessati a utilizzare il modello bayesiano allo scopo di prevedere la probabilità di risultati futuri basandoci sui dati già osservati. Questo tipo di analisi inferenziale va sotto il nome di <em>analisi predittiva</em>.</p>
<p>L’esempio che considereremo qui nei dettagli riguarda il caso beta-binomiale, nel quale la distribuzione a priori per il parametro ignoto <span class="math inline">\(\theta\)</span> (ovvero, la probabilità di successo) è una distribuzione Beta, la verosimiglianza è binomiale e i dati sono costituiti dal numero <span class="math inline">\(y\)</span> di successi in <span class="math inline">\(n\)</span> prove Bernoulliane indipendenti. Nell’esempio che discuteremo useremo un’altra volta i dati del campione di pazienti clinici depressi di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>. Supponendo di volere esaminare in futuro altri <span class="math inline">\(m\)</span> pazienti clinici, ci chiediamo: quanti di essi manifesteranno una depressione grave?</p>
<p>Siamo dunque interessati a predire i risultati che si potrebbero osservare in nuovi campioni di <span class="math inline">\(m = 30\)</span> osservazioni. Denotiamo con <span class="math inline">\(\tilde{y}\)</span> la manifestazione della variabile casuale <span class="math inline">\(\tilde{Y}\)</span>. In un nuovo campione di <span class="math inline">\(m\)</span> osservazioni, <span class="math inline">\(\tilde{y}\)</span> assumerà il valore <span class="math inline">\(\tilde{y}_1\)</span> (ad es., 12), in un altro campione assumerà il valore <span class="math inline">\(\tilde{y}_2\)</span> (ad es., 23), e così via. Siamo interessati a descrivere la probabilità che <span class="math inline">\(\tilde{y}\)</span> assuma i valori <span class="math inline">\(0, 1, 2, \dots, 29, 30\)</span>. Tale distribuzione (in questo caso) di massa di probabilità si chiama <em>distribuzione predittiva a posteriori</em> <span class="math inline">\(p(\tilde{Y} = \tilde{y} \mid Y = y)\)</span> e corrisponde alla probabilità assegnata a ciascuno dei possibili valori <span class="math inline">\(\tilde{y}\)</span> (<span class="math inline">\(0, 1, 2, \dots, 29, 30\)</span>) nei possibili campioni futuri di <span class="math inline">\(m\)</span> osservazioni.</p>
<p>In questo Capitolo ci porremo il problema di trovare la distribuzione predittiva a posteriori nel caso beta-binomiale. Useremo tre metodi diversi:</p>
<ul>
<li>la soluzione analitica,</li>
<li>i risultati di una simulazione,</li>
<li>il campionamento MCMC.</li>
</ul>
<p>I tre metodi producono risultati equivalenti. In seguito useremo il metodo MCMC perché ci consente di trovare facilmente la risposta cercata, anche quando una soluzione analitica non è disponibile.</p>
</div>
<div id="soluzione-analitica" class="section level2 hasAnchor" number="22.2">
<h2><span class="header-section-number">22.2</span> Soluzione analitica<a href="ch-prediction.html#soluzione-analitica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nel caso dell’esempio in discussione, la distribuzione di <span class="math inline">\(\tilde{Y}\)</span> dipende da <span class="math inline">\(\theta\)</span> e ciò che sappiamo di <span class="math inline">\(\theta\)</span> è sintetizzato nella distribuzione a posteriori <span class="math inline">\(p(\theta \mid y)\)</span>. Usando la regola della catena, possiamo scrivere la distribuzione congiunta di <span class="math inline">\(\tilde{y}\)</span> e <span class="math inline">\(\theta\)</span> nel modo seguente</p>
<p><span class="math display">\[\begin{equation}
p(\tilde{y}, \theta \mid y) = p(\tilde{y} \mid \theta, y) p(\theta \mid y).
\end{equation}\]</span></p>
<p>Assumendo che le osservazioni future <span class="math inline">\(\tilde{y}\)</span> e passate <span class="math inline">\(y\)</span> siano condizionalmente indipendenti dato <span class="math inline">\(\theta\)</span>, l’espressione precedente può essere scritta come</p>
<p><span class="math display">\[\begin{equation}
p(\tilde{y}, \theta \mid y) = p(\tilde{y} \mid \theta) p(\theta \mid y).
\end{equation}\]</span></p>
<p>La distribuzione predittiva a posteriori viene ottenuta dalla distribuzione congiunta di <span class="math inline">\(\tilde{y}\)</span> e <span class="math inline">\(\theta\)</span> integrando rispetto a <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display" id="eq:post-pred-distr">\[\begin{equation}
p(\tilde{y} \mid y) = \int_{\theta} p(\tilde{y} \mid \theta) p(\theta \mid y) \,\operatorname {d}\!\theta.
\tag{14.6}
\end{equation}\]</span></p>
<p>Nel caso dello schema beta-binomiale, la funzione <span class="math inline">\(p(\tilde{y} \mid \theta)\)</span> è binomiale di parametri <span class="math inline">\(m\)</span> e <span class="math inline">\(\theta\)</span>, e la distribuzione a posteriori <span class="math inline">\(p(\theta \mid y)\)</span> è una <span class="math inline">\(\mbox{Beta}(\alpha + y, \beta + n - y)\)</span>. Risolvendo l’integrale otteniamo:</p>
<p><span class="math display" id="eq:post-yprime-an-sol-betabin">\[\begin{align}
p(\tilde{y} \mid y) &amp;= \int_0^1 p(\tilde{y} \mid \theta)
p(\theta \mid y)\,\operatorname {d}\!\theta \notag\\
&amp;= \int_0^1 \begin{pmatrix}m\\\tilde{y}\end{pmatrix}
\theta^{\tilde{y}}
(1-\theta)^{m-\tilde{y}} \, \mbox{Beta}(a+y,b+n-y) \, d\theta \notag\\
&amp;= \begin{pmatrix}{m}\\\tilde{y}\end{pmatrix} \int_0^1 \theta^{\tilde{y}}
(1-\theta)^{m-\tilde{y}} \frac{1}{B(a+y, b+n-y)}\theta^{a+y-1}(1-\theta)^{b+n-y-1}\notag\\
&amp;= \begin{pmatrix}{ m }\\\tilde{y}\end{pmatrix} \frac{1}{B(a+y, b+n-y)}\int_0^1 \theta^{\tilde{y}+a+y-1}(1-\theta)^{m-\tilde{y}+b+n-y-1}\notag\\
&amp;= \begin{pmatrix}{ m }\\\tilde{y}\end{pmatrix} \frac{B(\tilde{y}+a+y,b+n-y+m-\tilde{y})}{B(a+y, b+n-y)} \; .
\tag{22.1}
\end{align}\]</span></p>
<p>In conclusione, per lo schema beta-binomiale, la distribuzione predittiva a posteriori è</p>
<p><span class="math display" id="eq:beta-binomial-distr">\[\begin{equation}
f(\tilde{y} \mid y) = \binom{m}{\tilde{y}} \frac{B(a+ y + \tilde{y}, b + n - y + m - \tilde{y})}{B(a+y, b+n-y)},
\tag{22.2}
\end{equation}\]</span></p>
<p>ovvero, corrisponde ad una distribuzione di probabilità discreta chiamata <em>distribuzione beta-binomiale</em> di parametri <span class="math inline">\(m\)</span>, <span class="math inline">\(\alpha+y\)</span> e <span class="math inline">\(\beta+n-y\)</span>.</p>
<p>Nell’esempio relativo allo studio di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>, la verosimiglianza è binomiale, i dati sono costituiti da 23 successi su 30 prove e la distribuzione a priori su <span class="math inline">\(\theta\)</span> è <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>. Di conseguenza, la distribuzione a posteriori è <span class="math inline">\(\mbox{Beta}(25, 17)\)</span>. Vogliamo calcolare la distribuzione predittiva a posteriori per un nuovo campione, poniamo, di <span class="math inline">\(m = 30\)</span> osservazioni (ma, in generale, <span class="math inline">\(m\)</span> può essere diverso da <span class="math inline">\(n\)</span>).</p>
<p>In base alla <a href="ch-prediction.html#eq:beta-binomial-distr">(22.2)</a> sappiamo che la distribuzione predittiva a posteriori è una distribuzione beta-binomiale di parametri <span class="math inline">\(m\)</span>, <span class="math inline">\(\alpha+y\)</span> e <span class="math inline">\(\beta+n-y\)</span>, dove <span class="math inline">\(m\)</span> è il numero di prove nel nuovo campione, <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> sono i parametri della distribuzione a priori, e <span class="math inline">\(y\)</span> e <span class="math inline">\(n\)</span> sono le proprietà del campione corrente. Nel caso dell’esempio in discussione, <span class="math inline">\(m = 30\)</span>, <span class="math inline">\(\alpha = 2 + 23 = 25\)</span>, <span class="math inline">\(\beta = 10 + 30 - 23 = 17\)</span>. Possiamo svolgere i calcoli necessario usando le funzioni del pacchetto <code>extraDistr</code>. Per i parametri specificati sopra, un grafico della distribuzione predittiva a posteriori si ottiene nel modo seguente:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="ch-prediction.html#cb244-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> extraDistr<span class="sc">::</span><span class="fu">dbbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">25</span>, <span class="dv">17</span>)</span>
<span id="cb244-2"><a href="ch-prediction.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Y=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">Probability =</span> prob) <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="ch-prediction.html#cb244-3" aria-hidden="true" tabindex="-1"></a>  ProbBayes<span class="sc">::</span><span class="fu">prob_plot</span>(<span class="at">Color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-240-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>La distribuzione predittiva a posteriori illustrata nella figura precedente ci dice qual è la plausibilità relativa di osservare <span class="math inline">\(0, 1, \dots, 30\)</span> successi su <span class="math inline">\(m = 30\)</span> prove in un futuro campione di osservazioni, alla luce dei dati che abbiamo osservato nel campione corrente (23 successi in 30 prove) e tenuto conto delle nostre opinioni a priori sulla plausibilità dei possibili valori <span class="math inline">\(\theta\)</span> (ovvero, <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>).</p>
<p>Esaminando la distribuzione predittiva notiamo che, nei possibili campioni futuri di 30 osservazioni, il valore <span class="math inline">\(\tilde{y}\)</span> più plausibile è 18. Tuttavia, <span class="math inline">\(\tilde{y}\)</span> può assumere anche altri valori e la distribuzione predittiva ci informa sulla <em>plausibilità relativa</em> di ciascuno dei possibili valori futuri <span class="math inline">\(\tilde{y}\)</span> – nel presente esempio, <span class="math inline">\(\tilde{y}\)</span> corrisponde al numero di pazienti clinici (su 30) che manifesteranno una depressione grave.</p>
<p>È desiderabile costruire un intervallo che contiene le realizzazioni <span class="math inline">\(\tilde{y}\)</span> ad un livello specificato di probabilità. Supponiamo che il livello di probabilità richiesto sia 0.89. L’intervallo si costruisce aggiungendo valori <span class="math inline">\(\tilde{y}\)</span> all’intervallo (partendo da quello con la probabilità maggiore) fino a che il contenuto di probabilità dell’insieme eccede la soglia richiesta, nel caso present di 0.89. La procedura è implementata nella funzione <code>discint()</code> del pacchetto <code>LearnBayes</code>. Per i dati dell’esempio otteniamo</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="ch-prediction.html#cb245-1" aria-hidden="true" tabindex="-1"></a>LearnBayes<span class="sc">::</span><span class="fu">discint</span>(<span class="fu">cbind</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, prob), <span class="fl">0.89</span>)</span>
<span id="cb245-2"><a href="ch-prediction.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $prob</span></span>
<span id="cb245-3"><a href="ch-prediction.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9152885</span></span>
<span id="cb245-4"><a href="ch-prediction.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-5"><a href="ch-prediction.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $set</span></span>
<span id="cb245-6"><a href="ch-prediction.html#cb245-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 12 13 14 15 16 17 18 19 20 21 22 23</span></span></code></pre></div>
<p>Sulla base delle informazioni disponibili, possiamo dunque prevedere, con un livello di certezza soggettiva che eccede la soglia di 0.91, che in un futuro campione di 30 soggetti clinici depressi, il numero di pazienti con depressione grave sarà compreso tra 12 e 23.</p>
<p><span class="math display">\[
P(12 \leq \tilde{y} \leq 23) = 0.9145.
\]</span></p>
<p>In conclusione, per il caso beta-binomiale, possiamo dire che la predizione bayesiana di una nuova osservazione futura è la realizzazione di una distribuzione beta-binomiale di parametri <span class="math inline">\(m\)</span>, <span class="math inline">\(\alpha + y\)</span>, e <span class="math inline">\(\beta + n - y\)</span>, dove <span class="math inline">\(m\)</span> è il numero di prove nel nuovo campione, <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> sono i parametri della distribuzione a priori, e <span class="math inline">\(y\)</span> e <span class="math inline">\(n\)</span> sono le caratteristiche del campione.</p>
</div>
<div id="la-distribuzione-predittiva-a-posteriori-mediante-simulazione" class="section level2 hasAnchor" number="22.3">
<h2><span class="header-section-number">22.3</span> La distribuzione predittiva a posteriori mediante simulazione<a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-simulazione" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In situazioni dove è difficile derivare l’esatta distribuzione predittiva a posteriori è possibile ottenere un campione casuale di valori della distribuzione predittiva posteriori mediante simulazione. Facciamo un esempio riferito al caso che stiamo discutendo. È possibile svolgere la simulazione richiesta in due fasi. Supponiamo di volere ottenere un campione casuale di <span class="math inline">\(n\)</span> osservazioni dalla distribuzione predittiva a posteriori. A tal fine dobbiamo (1) estrarre <span class="math inline">\(n\)</span> valori a caso del parametro <span class="math inline">\(\theta\)</span> dalla distribuzione a posteriori <span class="math inline">\(p(\theta \mid y)\)</span>: (2) con tali valori del parametro <span class="math inline">\(\theta\)</span> generiamo <span class="math inline">\(n\)</span> valori casuali <span class="math inline">\(\tilde{y}\)</span>; a tal fine usiamo il modello binomiale di parametri <span class="math inline">\(m\)</span> e <span class="math inline">\(\theta_i\)</span> (con <span class="math inline">\(i = 1, \dots, n\)</span>). Otteniamo così <span class="math inline">\(n\)</span> realizzazioni casuali di <span class="math inline">\(n\)</span> distribuzioni binomiali aventi i parametri specificati sopra.</p>
<p>Vediamo come si fa in pratica con <span class="math inline">\(\mathsf{R}\)</span>. Per l’esempio che stiamo discutendo, la distribuzione a posteriori è una <span class="math inline">\(\mbox{Beta}(25, 17)\)</span>. Estraiamo 100,000 valori a caso da tale distribuzione:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="ch-prediction.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb246-2"><a href="ch-prediction.html#cb246-2" aria-hidden="true" tabindex="-1"></a>nrep <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb246-3"><a href="ch-prediction.html#cb246-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb246-4"><a href="ch-prediction.html#cb246-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb246-5"><a href="ch-prediction.html#cb246-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb246-6"><a href="ch-prediction.html#cb246-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">23</span></span>
<span id="cb246-7"><a href="ch-prediction.html#cb246-7" aria-hidden="true" tabindex="-1"></a>pred_p_sim <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(nrep, a <span class="sc">+</span> y, b <span class="sc">+</span> n <span class="sc">-</span> y)</span></code></pre></div>
<p>I primi 10 valori così ottenuti sono</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="ch-prediction.html#cb247-1" aria-hidden="true" tabindex="-1"></a>pred_p_sim[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb247-2"><a href="ch-prediction.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0.5435206 0.5319551 0.6045577 0.6337146 0.7552324 0.5393935 0.6187069</span></span>
<span id="cb247-3"><a href="ch-prediction.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8] 0.6193819 0.6736216 0.6051480</span></span></code></pre></div>
<p>Per ciascuno di tali valori <span class="math inline">\(\theta_i\)</span>, con <span class="math inline">\(i = 1, \dots, 100,000\)</span>, estraiamo a caso un valore dalla distribuzione binomiale di parametri <span class="math inline">\(n = 30\)</span> e <span class="math inline">\(\theta_i\)</span>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ch-prediction.html#cb248-1" aria-hidden="true" tabindex="-1"></a>pred_y_sim <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nrep)</span>
<span id="cb248-2"><a href="ch-prediction.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nrep) {</span>
<span id="cb248-3"><a href="ch-prediction.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  pred_y_sim[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">30</span>, pred_p_sim[i])</span>
<span id="cb248-4"><a href="ch-prediction.html#cb248-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="ch-prediction.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In maniera equivalente posso fare:</span></span>
<span id="cb249-2"><a href="ch-prediction.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_y_sim &lt;- rbinom(1e5, n, pred_p_sim)</span></span></code></pre></div>
<p>Calcolo la proporzione di volte in cui sono stati osservai i valori <span class="math inline">\(\tilde{y} = 0, 1, \dots, 30\)</span>.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="ch-prediction.html#cb250-1" aria-hidden="true" tabindex="-1"></a>ppd <span class="ot">&lt;-</span> <span class="fu">table</span>(pred_y_sim) <span class="sc">/</span> nrep</span>
<span id="cb250-2"><a href="ch-prediction.html#cb250-2" aria-hidden="true" tabindex="-1"></a>ppd</span>
<span id="cb250-3"><a href="ch-prediction.html#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pred_y_sim</span></span>
<span id="cb250-4"><a href="ch-prediction.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       3       4       5       6       7       8       9      10      11      12 </span></span>
<span id="cb250-5"><a href="ch-prediction.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.00002 0.00004 0.00011 0.00036 0.00096 0.00241 0.00533 0.01000 0.01753 0.02882 </span></span>
<span id="cb250-6"><a href="ch-prediction.html#cb250-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      13      14      15      16      17      18      19      20      21      22 </span></span>
<span id="cb250-7"><a href="ch-prediction.html#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04290 0.06110 0.07812 0.09476 0.10763 0.11311 0.10821 0.09765 0.07982 0.06185 </span></span>
<span id="cb250-8"><a href="ch-prediction.html#cb250-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      23      24      25      26      27      28      29      30 </span></span>
<span id="cb250-9"><a href="ch-prediction.html#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.04156 0.02536 0.01299 0.00630 0.00224 0.00064 0.00016 0.00002</span></span></code></pre></div>
<p>Calcolo l’intervallo di valori <span class="math inline">\(\tilde{y}\)</span> a cui è associata una probabilità di 0.89 (per fare un confronto con il risultato ottenuto in precedenza).</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="ch-prediction.html#cb251-1" aria-hidden="true" tabindex="-1"></a>LearnBayes<span class="sc">::</span><span class="fu">discint</span>(<span class="fu">cbind</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">30</span>, ppd), <span class="fl">0.89</span>) </span>
<span id="cb251-2"><a href="ch-prediction.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $prob</span></span>
<span id="cb251-3"><a href="ch-prediction.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      12 </span></span>
<span id="cb251-4"><a href="ch-prediction.html#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.91553 </span></span>
<span id="cb251-5"><a href="ch-prediction.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb251-6"><a href="ch-prediction.html#cb251-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $set</span></span>
<span id="cb251-7"><a href="ch-prediction.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 13 14 15 16 17 18 19 20 21 22 23 </span></span>
<span id="cb251-8"><a href="ch-prediction.html#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 13 14 15 16 17 18 19 20 21 22 23</span></span>
<span id="cb251-9"><a href="ch-prediction.html#cb251-9" aria-hidden="true" tabindex="-1"></a><span class="co"># i risultati minori di 3 non sono stati calcolati</span></span></code></pre></div>
<p>Confronto i risultati della simulazione con i valori esatti della distribuzione predittiva a posteriori. Di seguito riporto i risultati esatti.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="ch-prediction.html#cb252-1" aria-hidden="true" tabindex="-1"></a>prob30 <span class="ot">&lt;-</span> extraDistr<span class="sc">::</span><span class="fu">dbbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">25</span>, <span class="dv">17</span>)</span>
<span id="cb252-2"><a href="ch-prediction.html#cb252-2" aria-hidden="true" tabindex="-1"></a>LearnBayes<span class="sc">::</span><span class="fu">discint</span>(<span class="fu">cbind</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, prob30), <span class="fl">0.89</span>)</span>
<span id="cb252-3"><a href="ch-prediction.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $prob</span></span>
<span id="cb252-4"><a href="ch-prediction.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9152885</span></span>
<span id="cb252-5"><a href="ch-prediction.html#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb252-6"><a href="ch-prediction.html#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $set</span></span>
<span id="cb252-7"><a href="ch-prediction.html#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 12 13 14 15 16 17 18 19 20 21 22 23</span></span></code></pre></div>
<p>Un grafico con la distribuzione predittiva a posteriori esatta è fornito nella figura seguente.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="ch-prediction.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Y=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">Probability =</span> prob30) <span class="sc">%&gt;%</span> </span>
<span id="cb253-2"><a href="ch-prediction.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  ProbBayes<span class="sc">::</span><span class="fu">prob_plot</span>(<span class="at">Color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-249-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Una rappresentazione della distribuzione a posteriori ottenuta mediante simulazione è il seguente.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="ch-prediction.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Y=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">Probability =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, ppd)) <span class="sc">%&gt;%</span> </span>
<span id="cb254-2"><a href="ch-prediction.html#cb254-2" aria-hidden="true" tabindex="-1"></a>  ProbBayes<span class="sc">::</span><span class="fu">prob_plot</span>(<span class="at">Color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-250-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Si noti che i risultati della simulazione sono indistinguibili dalla soluzione esatta.</p>
</div>
<div id="la-distribuzione-predittiva-a-posteriori-mediante-mcmc" class="section level2 hasAnchor" number="22.4">
<h2><span class="header-section-number">22.4</span> La distribuzione predittiva a posteriori mediante MCMC<a href="ch-prediction.html#la-distribuzione-predittiva-a-posteriori-mediante-mcmc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il metodo basato su simulazione che abbiamo discusso sopra è proprio il metodo che viene utilizzato dai metodi MCMC per ottenere un’approssimazione della distribuzione predittiva a posteriori. Le stime delle possibili osservazioni future <span class="math inline">\(p(\tilde{y} \mid y)\)</span>, chiamate <span class="math inline">\(p(y^{rep} \mid y)\)</span>, si ottengono nel modo seguente:</p>
<ul>
<li>campionare <span class="math inline">\(\theta_i \sim p(\theta \mid y)\)</span>, ovvero campionare un valore del parametro dalla distribuzione a posteriori;</li>
<li>campionare <span class="math inline">\(y^{rep} \sim p(y^{rep} \mid \theta_i)\)</span>, ovvero campionare il valore di un’osservazione dalla funzione di verosimiglianza condizionata al valore del parametro definito nel passo precedente.</li>
</ul>
<p>Se i due passaggi descritti sopra vengono ripetuti un numero sufficiente di volte, l’istogramma risultante approssimerà la distribuzione predittiva a posteriori che, in teoria (ma in pratica non sempre) potrebbe essere ottenuta per via analitica.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-82" class="exercise"><strong>Esercizio 22.1  </strong></span>Riportiamo qui sotto il codice Stan per generare <span class="math inline">\(p(y^{rep} \mid y)\)</span> nel caso dell’inferenza su una proporzione.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="ch-prediction.html#cb255-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb255-2"><a href="ch-prediction.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb255-3"><a href="ch-prediction.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb255-4"><a href="ch-prediction.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="st">  array[N] int&lt;lower=0, upper=1&gt; y;</span></span>
<span id="cb255-5"><a href="ch-prediction.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb255-6"><a href="ch-prediction.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb255-7"><a href="ch-prediction.html#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; theta;</span></span>
<span id="cb255-8"><a href="ch-prediction.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb255-9"><a href="ch-prediction.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb255-10"><a href="ch-prediction.html#cb255-10" aria-hidden="true" tabindex="-1"></a><span class="st">  theta ~ beta(2, 10);</span></span>
<span id="cb255-11"><a href="ch-prediction.html#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ bernoulli(theta);</span></span>
<span id="cb255-12"><a href="ch-prediction.html#cb255-12" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb255-13"><a href="ch-prediction.html#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb255-14"><a href="ch-prediction.html#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="st">  array[N] int y_rep;</span></span>
<span id="cb255-15"><a href="ch-prediction.html#cb255-15" aria-hidden="true" tabindex="-1"></a><span class="st">  for (n in 1 : N) {</span></span>
<span id="cb255-16"><a href="ch-prediction.html#cb255-16" aria-hidden="true" tabindex="-1"></a><span class="st">    y_rep[n] = bernoulli_rng(theta);</span></span>
<span id="cb255-17"><a href="ch-prediction.html#cb255-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb255-18"><a href="ch-prediction.html#cb255-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb255-19"><a href="ch-prediction.html#cb255-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb255-20"><a href="ch-prediction.html#cb255-20" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/betabin23-30-2-10.stan&quot;</span>)</span></code></pre></div>
<p>
Si noti che nel nel blocco <code>generated quantities</code> sono state aggiunte le istruzioni necessarie per simulare <span class="math inline">\(y^{rep}\)</span>, ovvero, <code>y_rep[n] = bernoulli_rng(theta)</code>. Una tale istruzione ci dice di generare un valore casuale di una variabile Bernoulliana di parametro <span class="math inline">\(\theta\)</span>. Il valore <span class="math inline">\(\theta\)</span> è preso a caso dalla distribuzione a posteriori <span class="math inline">\(p(\theta \mid y)\)</span>. Il ciclo <code>for</code> specifica che tale operazione va ripetuta 30 volte. Tutto questo verrà ripetuto un numero di volte uguale al numero di iterazioni richieste.</p>
<p>I dati dell’esempio sono:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="ch-prediction.html#cb256-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb256-2"><a href="ch-prediction.html#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">30</span>,</span>
<span id="cb256-3"><a href="ch-prediction.html#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">23</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">7</span>))</span>
<span id="cb256-4"><a href="ch-prediction.html#cb256-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
Compiliamo il codice Stan</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="ch-prediction.html#cb257-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;betabin23-30-2-10.stan&quot;</span>)</span>
<span id="cb257-2"><a href="ch-prediction.html#cb257-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span></code></pre></div>
<p>
ed eseguiamo il campionamento MCMC:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="ch-prediction.html#cb258-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb258-2"><a href="ch-prediction.html#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_list,</span>
<span id="cb258-3"><a href="ch-prediction.html#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb258-4"><a href="ch-prediction.html#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb258-5"><a href="ch-prediction.html#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb258-6"><a href="ch-prediction.html#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb258-7"><a href="ch-prediction.html#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb258-8"><a href="ch-prediction.html#cb258-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>
Per comodità, trasformiamo l’oggetto <code>fit</code> in un oggetto di classe <code>stanfit</code>:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="ch-prediction.html#cb259-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>
Il contenuto dell’oggetto <code>stanfit</code> può essere esaminato nel modo seguente:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="ch-prediction.html#cb260-1" aria-hidden="true" tabindex="-1"></a>list_of_draws <span class="ot">&lt;-</span> <span class="fu">extract</span>(stanfit)</span>
<span id="cb260-2"><a href="ch-prediction.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(list_of_draws))</span>
<span id="cb260-3"><a href="ch-prediction.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;theta&quot; &quot;y_rep&quot; &quot;lp__&quot;</span></span></code></pre></div>
<p>
Dall’oggetto <code>list_of_draws</code> recuperiamo <code>y_rep</code>:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="ch-prediction.html#cb261-1" aria-hidden="true" tabindex="-1"></a>y_bern <span class="ot">&lt;-</span> list_of_draws<span class="sc">$</span>y_rep</span>
<span id="cb261-2"><a href="ch-prediction.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(y_bern)</span>
<span id="cb261-3"><a href="ch-prediction.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 16000    30</span></span>
<span id="cb261-4"><a href="ch-prediction.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y_bern)</span>
<span id="cb261-5"><a href="ch-prediction.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb261-6"><a href="ch-prediction.html#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iterations [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span></span>
<span id="cb261-7"><a href="ch-prediction.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [1,]    1    1    1    1    0    1    1    1    1     1     1     1     1</span></span>
<span id="cb261-8"><a href="ch-prediction.html#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [2,]    0    1    0    1    1    1    0    0    1     0     0     0     0</span></span>
<span id="cb261-9"><a href="ch-prediction.html#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [3,]    0    1    0    1    1    1    0    0    1     1     1     0     1</span></span>
<span id="cb261-10"><a href="ch-prediction.html#cb261-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [4,]    1    0    0    1    1    0    0    1    0     1     1     1     0</span></span>
<span id="cb261-11"><a href="ch-prediction.html#cb261-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [5,]    0    0    0    1    1    0    1    1    0     1     0     0     1</span></span>
<span id="cb261-12"><a href="ch-prediction.html#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [6,]    1    1    1    1    1    1    0    1    0     1     1     1     0</span></span>
<span id="cb261-13"><a href="ch-prediction.html#cb261-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb261-14"><a href="ch-prediction.html#cb261-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iterations [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]</span></span>
<span id="cb261-15"><a href="ch-prediction.html#cb261-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [1,]     0     1     1     1     1     1     0     0     1     0     1</span></span>
<span id="cb261-16"><a href="ch-prediction.html#cb261-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [2,]     1     0     0     1     0     1     1     1     0     0     0</span></span>
<span id="cb261-17"><a href="ch-prediction.html#cb261-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [3,]     0     0     1     0     1     1     0     1     0     0     1</span></span>
<span id="cb261-18"><a href="ch-prediction.html#cb261-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [4,]     0     1     0     1     0     1     0     0     1     0     1</span></span>
<span id="cb261-19"><a href="ch-prediction.html#cb261-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [5,]     0     0     1     1     1     1     1     0     1     0     1</span></span>
<span id="cb261-20"><a href="ch-prediction.html#cb261-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [6,]     1     1     0     1     0     1     1     0     0     1     0</span></span>
<span id="cb261-21"><a href="ch-prediction.html#cb261-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           </span></span>
<span id="cb261-22"><a href="ch-prediction.html#cb261-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; iterations [,25] [,26] [,27] [,28] [,29] [,30]</span></span>
<span id="cb261-23"><a href="ch-prediction.html#cb261-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [1,]     1     1     1     1     1     1</span></span>
<span id="cb261-24"><a href="ch-prediction.html#cb261-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [2,]     0     1     1     0     1     1</span></span>
<span id="cb261-25"><a href="ch-prediction.html#cb261-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [3,]     1     1     1     1     1     0</span></span>
<span id="cb261-26"><a href="ch-prediction.html#cb261-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [4,]     0     1     1     0     0     1</span></span>
<span id="cb261-27"><a href="ch-prediction.html#cb261-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [5,]     0     0     0     0     1     0</span></span>
<span id="cb261-28"><a href="ch-prediction.html#cb261-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       [6,]     0     0     1     0     1     1</span></span></code></pre></div>
<p>Dato che il codice Stan definisce un modello per i dati grezzi (ovvero, per ciascuna singola prova Bernoulliana del campione), ogni riga della matrice <code>y_bern</code> ha 30 colonne, ciascuna delle quali corrisponde ad un campione (<span class="math inline">\(n\)</span> = 16,000 in questa simulazione) di possibili valori futuri <span class="math inline">\(y_i \in \{0, 1\}\)</span>.</p>
<p>In altre parole, abbiamo generato 16,000 campioni casuali di 30 osservazioni possibili future</p>
<p>Per ottenere una stima <code>p(y_rep)</code> della distribuzione predittiva a posteriori <span class="math inline">\(p(\tilde{y} \mid y)\)</span>, ovvero, per ottenere una stima della probabilità associata a ciascuno dei possibili numeri di “successi” <span class="math inline">\(\tilde{y}\)</span> in <span class="math inline">\(m = 30\)</span> nuove prove future, è sufficiente calcolare la proporzione di valori 1 in ciascuna riga:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="ch-prediction.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">y_rep =</span> <span class="fu">rowSums</span>(y_bern)) <span class="sc">%&gt;%</span></span>
<span id="cb262-2"><a href="ch-prediction.html#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_rep, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb262-3"><a href="ch-prediction.html#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-258-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Si noti che questo istogramma è equivalente a quello ottenuto nella simulazione precedente.</p>
</div>
</div>
<div id="i-metodi-per-la-valutazione-del-modello" class="section level2 hasAnchor" number="22.5">
<h2><span class="header-section-number">22.5</span> I metodi per la valutazione del modello<a href="ch-prediction.html#i-metodi-per-la-valutazione-del-modello" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="posterior-predictive-checks" class="section level3 hasAnchor" number="22.5.1">
<h3><span class="header-section-number">22.5.1</span> Posterior predictive checks<a href="ch-prediction.html#posterior-predictive-checks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La distribuzione predittiva a posteriori viene utilizzata per eseguire i cosiddetti <em>controlli predittivi a posteriori</em> (<em>Posterior Predictive Checks</em>, PPC). Nella distribuzione predittiva a posteriori, viene generato un campione di dati possibili futuri utilizzando le proprietà del modello adattato. È ovvio che tali dati possibili futuri devono almento essere coerenti con i dati del campione presente. I PPC eseguono un confronto grafico tra <span class="math inline">\(p(y^{rep} \mid y)\)</span> e i dati osservati <span class="math inline">\(y\)</span>: confrontando visivamente gli aspetti chiave dei dati previsti futuri <span class="math inline">\(y^{rep}\)</span> e dei dati osservati <span class="math inline">\(y\)</span> è possibile determinare se il modello è adeguato.</p>
<p>Oltre al confronto visivo tra le distribuzioni <span class="math inline">\(p(y)\)</span> e <span class="math inline">\(p(y^{rep})\)</span> è anche possibile un confronto tra la distribuzione di varie statistiche descrittive, i cui valori sono calcolati su diversi campioni <span class="math inline">\(y^{rep}\)</span>, e le corrispondenti statistiche calcolate sui dati osservati. Vengono solitamente considerate statistiche descrittive quali la media, la varianza, la deviazione standard, il minimo o il massimo, ma sono possibili confronti di questo tipo per qualunque altra statistica.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-83" class="exercise"><strong>Esercizio 22.2  </strong></span>Esaminiamo ora un set di dati che non seguono la distribuzione normale <span class="citation">(<a href="#ref-gelman2020regression" role="doc-biblioref">Gelman, Hill, and Vehtari 2020</a>)</span>. I dati corrispondono ad una serie di misurazioni prese da Simon Newcomb nel 1882 come parte di un esperimento per stimare la velocità della luce. A questi dati verrà (inappropriatamente) adattata una distribuzione normale. L’obiettivo dell’esempio è quello di mostrare come i PPC possono rivelare la mancanza di adattamento di un modello ai dati.</p>
<p>I PPC mostrano che il modo più semplice per verificare l’adattamento del modello è quello di visualizzare <span class="math inline">\(y^{rep}\)</span> insieme ai dati effettivi. Iniziamo a caricare i dati:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="ch-prediction.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb263-2"><a href="ch-prediction.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;newcomb&quot;</span>)</span></code></pre></div>
<p>Visualizziamo la distribuzione dei dati con un istogramma:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="ch-prediction.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(newcomb) <span class="sc">%&gt;%</span></span>
<span id="cb264-2"><a href="ch-prediction.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> newcomb, <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb264-3"><a href="ch-prediction.html#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-260-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Creiamo un oggetto di tipo <code>list</code> dove inserire i dati:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="ch-prediction.html#cb265-1" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb265-2"><a href="ch-prediction.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> newcomb,</span>
<span id="cb265-3"><a href="ch-prediction.html#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(newcomb)</span>
<span id="cb265-4"><a href="ch-prediction.html#cb265-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Il codice Stan per il modello normale è il seguente:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="ch-prediction.html#cb266-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb266-2"><a href="ch-prediction.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb266-3"><a href="ch-prediction.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb266-4"><a href="ch-prediction.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y;</span></span>
<span id="cb266-5"><a href="ch-prediction.html#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb266-6"><a href="ch-prediction.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb266-7"><a href="ch-prediction.html#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb266-8"><a href="ch-prediction.html#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span id="cb266-9"><a href="ch-prediction.html#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb266-10"><a href="ch-prediction.html#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb266-11"><a href="ch-prediction.html#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="st">  mu ~ normal(25, 10);</span></span>
<span id="cb266-12"><a href="ch-prediction.html#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma ~ cauchy(0, 10);</span></span>
<span id="cb266-13"><a href="ch-prediction.html#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ normal(mu, sigma);</span></span>
<span id="cb266-14"><a href="ch-prediction.html#cb266-14" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb266-15"><a href="ch-prediction.html#cb266-15" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb266-16"><a href="ch-prediction.html#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y_rep;</span></span>
<span id="cb266-17"><a href="ch-prediction.html#cb266-17" aria-hidden="true" tabindex="-1"></a><span class="st">  for (n in 1 : N) {</span></span>
<span id="cb266-18"><a href="ch-prediction.html#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="st">    y_rep[n] = normal_rng(mu, sigma);</span></span>
<span id="cb266-19"><a href="ch-prediction.html#cb266-19" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb266-20"><a href="ch-prediction.html#cb266-20" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb266-21"><a href="ch-prediction.html#cb266-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb266-22"><a href="ch-prediction.html#cb266-22" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/newcomb.stan&quot;</span>)</span></code></pre></div>
<p>Adattando il modello ai dati</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="ch-prediction.html#cb267-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;newcomb.stan&quot;</span>)</span>
<span id="cb267-2"><a href="ch-prediction.html#cb267-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb267-3"><a href="ch-prediction.html#cb267-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb267-4"><a href="ch-prediction.html#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_list,</span>
<span id="cb267-5"><a href="ch-prediction.html#cb267-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb267-6"><a href="ch-prediction.html#cb267-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb267-7"><a href="ch-prediction.html#cb267-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb267-8"><a href="ch-prediction.html#cb267-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb267-9"><a href="ch-prediction.html#cb267-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb267-10"><a href="ch-prediction.html#cb267-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>otteniamo le seguenti stime dei parametri <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="ch-prediction.html#cb268-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>))</span>
<span id="cb268-2"><a href="ch-prediction.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span id="cb268-3"><a href="ch-prediction.html#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   variable  mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail</span></span>
<span id="cb268-4"><a href="ch-prediction.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb268-5"><a href="ch-prediction.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 mu        26.2   26.2 1.33  1.30  24.0   28.4  1.00   13305.   11189.</span></span>
<span id="cb268-6"><a href="ch-prediction.html#cb268-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 sigma     10.9   10.8 0.958 0.943  9.40  12.5  1.00   12614.   10352.</span></span></code></pre></div>
<p>Trasformiamo <code>fit</code> in un oggetto <code>stanfit</code>:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="ch-prediction.html#cb269-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span></code></pre></div>
<p>La distribuzione a posteriori di <span class="math inline">\(\mu\)</span> è</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="ch-prediction.html#cb270-1" aria-hidden="true" tabindex="-1"></a>mu_draws <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stanfit, <span class="at">pars =</span> <span class="st">&quot;mu&quot;</span>)</span>
<span id="cb270-2"><a href="ch-prediction.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(mu_draws, <span class="at">prob =</span> <span class="fl">0.95</span>) <span class="co"># color 95% interval</span></span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-266-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Confrontiamo <span class="math inline">\(\mu\)</span> con la media di <span class="math inline">\(y\)</span>:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="ch-prediction.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(newcomb)</span>
<span id="cb271-2"><a href="ch-prediction.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 26.21212</span></span></code></pre></div>
<p>Anche se trova la media giusta, il modello non è comunque adeguato a prevedere le altre proprietà della <span class="math inline">\(y\)</span>. Estraiamo <span class="math inline">\(y^{rep}\)</span> dall’oggetto <code>stanfit</code>:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="ch-prediction.html#cb272-1" aria-hidden="true" tabindex="-1"></a>y_rep <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stanfit, <span class="at">pars =</span> <span class="st">&quot;y_rep&quot;</span>)</span>
<span id="cb272-2"><a href="ch-prediction.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(y_rep)</span>
<span id="cb272-3"><a href="ch-prediction.html#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 16000    66</span></span></code></pre></div>
<p>I valori <code>y_rep</code> sono i dati della distribuzione predittiva a posteriori che sono stati simulati usando gli stessi valori <span class="math inline">\(X\)</span> dei predittori utilizzati per adattare il modello. Il confronto tra l’istogramma della <span class="math inline">\(y\)</span> e gli istogrammi di diversi campioni <span class="math inline">\(y^{rep}\)</span> mostra una scarsa corrispondenza tra i due:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="ch-prediction.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_hist</span>(data_list<span class="sc">$</span>y, y_rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, ], <span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-269-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Alla stessa conclusione si giunge tramite un confronto tra la funzione di densità empirica della <span class="math inline">\(y\)</span> e quella di diversi campioni <span class="math inline">\(y^{rep}\)</span>:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="ch-prediction.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(data_list<span class="sc">$</span>y, y_rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ])</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-270-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Generiamo ora i PPC per la media e il minimo della distribuzione:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="ch-prediction.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_stat_2d</span>(data_list<span class="sc">$</span>y, y_rep, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;min&quot;</span>))</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-271-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Mentre la media viene riprodotta accuratamente dal modello (come abbiamo visto sopra), ciò non è vero per il minimo dela distribuzione. L’origine di questa mancanza di adattamento è il fatto che la distribuzione delle misurazioni della velocità della luce è asimmetrica negativa. Dato che ci sono poche osservazioni nella coda negativa della distribuzione, solo per fare un esempio, utilizzeremo ora un secondo modello che ipotizza una distribuzione <span class="math inline">\(t\)</span> di Student:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="ch-prediction.html#cb276-1" aria-hidden="true" tabindex="-1"></a>modelString <span class="ot">=</span> <span class="st">&quot;</span></span>
<span id="cb276-2"><a href="ch-prediction.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb276-3"><a href="ch-prediction.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; N;</span></span>
<span id="cb276-4"><a href="ch-prediction.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y;</span></span>
<span id="cb276-5"><a href="ch-prediction.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb276-6"><a href="ch-prediction.html#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb276-7"><a href="ch-prediction.html#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb276-8"><a href="ch-prediction.html#cb276-8" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span id="cb276-9"><a href="ch-prediction.html#cb276-9" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0&gt; nu;</span></span>
<span id="cb276-10"><a href="ch-prediction.html#cb276-10" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb276-11"><a href="ch-prediction.html#cb276-11" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb276-12"><a href="ch-prediction.html#cb276-12" aria-hidden="true" tabindex="-1"></a><span class="st">  mu ~ normal(25, 10);</span></span>
<span id="cb276-13"><a href="ch-prediction.html#cb276-13" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma ~ cauchy(0, 10);</span></span>
<span id="cb276-14"><a href="ch-prediction.html#cb276-14" aria-hidden="true" tabindex="-1"></a><span class="st">  nu ~ cauchy(0, 10);</span></span>
<span id="cb276-15"><a href="ch-prediction.html#cb276-15" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ student_t(nu, mu, sigma);</span></span>
<span id="cb276-16"><a href="ch-prediction.html#cb276-16" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb276-17"><a href="ch-prediction.html#cb276-17" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb276-18"><a href="ch-prediction.html#cb276-18" aria-hidden="true" tabindex="-1"></a><span class="st">  vector[N] y_rep;</span></span>
<span id="cb276-19"><a href="ch-prediction.html#cb276-19" aria-hidden="true" tabindex="-1"></a><span class="st">  for (n in 1 : N) {</span></span>
<span id="cb276-20"><a href="ch-prediction.html#cb276-20" aria-hidden="true" tabindex="-1"></a><span class="st">    y_rep[n] = student_t_rng(nu, mu, sigma);</span></span>
<span id="cb276-21"><a href="ch-prediction.html#cb276-21" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb276-22"><a href="ch-prediction.html#cb276-22" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb276-23"><a href="ch-prediction.html#cb276-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb276-24"><a href="ch-prediction.html#cb276-24" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(modelString, <span class="at">con =</span> <span class="st">&quot;code/newcomb2.stan&quot;</span>)</span></code></pre></div>
<p>Adattiamo questo secondo modello ai dati.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="ch-prediction.html#cb277-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;newcomb2.stan&quot;</span>)</span>
<span id="cb277-2"><a href="ch-prediction.html#cb277-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(file)</span>
<span id="cb277-3"><a href="ch-prediction.html#cb277-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb277-4"><a href="ch-prediction.html#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_list,</span>
<span id="cb277-5"><a href="ch-prediction.html#cb277-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> 4000L,</span>
<span id="cb277-6"><a href="ch-prediction.html#cb277-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> 2000L,</span>
<span id="cb277-7"><a href="ch-prediction.html#cb277-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> SEED,</span>
<span id="cb277-8"><a href="ch-prediction.html#cb277-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> 4L,</span>
<span id="cb277-9"><a href="ch-prediction.html#cb277-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb277-10"><a href="ch-prediction.html#cb277-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb277-11"><a href="ch-prediction.html#cb277-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Running MCMC with 4 sequential chains...</span></span>
<span id="cb277-12"><a href="ch-prediction.html#cb277-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb277-13"><a href="ch-prediction.html#cb277-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 1 finished in 0.2 seconds.</span></span>
<span id="cb277-14"><a href="ch-prediction.html#cb277-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 2 finished in 0.2 seconds.</span></span>
<span id="cb277-15"><a href="ch-prediction.html#cb277-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 3 finished in 0.2 seconds.</span></span>
<span id="cb277-16"><a href="ch-prediction.html#cb277-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chain 4 finished in 0.3 seconds.</span></span>
<span id="cb277-17"><a href="ch-prediction.html#cb277-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb277-18"><a href="ch-prediction.html#cb277-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span id="cb277-19"><a href="ch-prediction.html#cb277-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean chain execution time: 0.3 seconds.</span></span>
<span id="cb277-20"><a href="ch-prediction.html#cb277-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total execution time: 1.5 seconds.</span></span></code></pre></div>
<p>Per questo secondo modello il confronto tra la funzione di densità empirica della <span class="math inline">\(y\)</span> e quella di diversi campioni <span class="math inline">\(y^{rep}\)</span> risulta adeguato:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="ch-prediction.html#cb278-1" aria-hidden="true" tabindex="-1"></a>stanfit <span class="ot">&lt;-</span> rstan<span class="sc">::</span><span class="fu">read_stan_csv</span>(fit<span class="sc">$</span><span class="fu">output_files</span>())</span>
<span id="cb278-2"><a href="ch-prediction.html#cb278-2" aria-hidden="true" tabindex="-1"></a>y_rep <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stanfit, <span class="at">pars =</span> <span class="st">&quot;y_rep&quot;</span>)</span>
<span id="cb278-3"><a href="ch-prediction.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(data_list<span class="sc">$</span>y, y_rep[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ])</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-274-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Inoltre, anche la statistica “minimo della distribuzione” viene ben predetta dal modello.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="ch-prediction.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_stat_2d</span>(data_list<span class="sc">$</span>y, y_rep, <span class="at">stat =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;min&quot;</span>))</span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-275-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In conclusione, per le misurazioni della velocità della luce di Newcomb l’accuratezza predittiva del modello basato sulla distribuzione <span class="math inline">\(t\)</span> di Student è chiaramente migliore di quella del modello normale.</p>
</div>
</div>
</div>
<div id="distribuzione-predittiva-a-priori-1" class="section level2 hasAnchor" number="22.6">
<h2><span class="header-section-number">22.6</span> Distribuzione predittiva a priori<a href="ch-prediction.html#distribuzione-predittiva-a-priori-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nella sezione precedente abbiamo visto come la distribuzione predittiva è stata usata per generare nuovi dati previsti futuri. Più precisamente, mediante la <a href="ch-bayes-workflow.html#eq:post-pred-distr">(14.6)</a></p>
<p><span class="math display">\[\begin{equation}
p(\tilde{y} \mid y) = \int_{\theta} p(\tilde{y} \mid \theta) p(\theta \mid y) \,\operatorname {d}\!\theta\notag
\end{equation}\]</span></p>
<p>abbiamo descritto la nostra incertezza sulla distribuzione di future osservazioni di dati, data la distribuzione a posteriori di <span class="math inline">\(\theta\)</span>, ovvero tenendo conto della scelta del modello e della stima dei parametri mediante i dati osservati. Si noti che, nella <a href="ch-bayes-workflow.html#eq:post-pred-distr">(14.6)</a>, <span class="math inline">\(\tilde{y}\)</span> è condizionato da <span class="math inline">\(y\)</span> ma non da ciò che è incognito, ovvero <span class="math inline">\(\theta\)</span>. La distribuzione predittiva a posteriori è ottenuta mediante marginalizzazione sopra i parametri incogniti <span class="math inline">\(\theta\)</span>.</p>
<p>In un modello bayesiano dove <span class="math inline">\(\theta\)</span> ha una distribuzione a priori <span class="math inline">\(p(\theta)\)</span> e per <span class="math inline">\(y\)</span> possiamo definire la funzione di verosimiglianza <span class="math inline">\(p(y \mid \theta)\)</span> possiamo scrivere la distribuzione congiunta <span class="math inline">\(p(y, \theta)\)</span> come il prodotto della verosimiglianza e della distribuzione a priori:</p>
<p><span class="math display">\[
p(y, \theta) = p(y \mid \theta)p(\theta).
\]</span></p>
<p>Una rappresentazione alternativa della distribuzione congiunta <span class="math inline">\(p(y, \theta)\)</span> è</p>
<p><span class="math display">\[
p(y, \theta) = p(\theta \mid y)p(y)
\]</span></p>
<p>Il primo termine in questo prodotto, la densità <span class="math inline">\(p(\theta \mid y)\)</span>, è la densità a posteriori di <span class="math inline">\(\theta\)</span> date le osservazioni <span class="math inline">\(y\)</span>. Il secondo termine in questo prodotto, <span class="math inline">\(p(y)\)</span>, è la <em>distribuzione predittiva a priori</em> che rappresenta la distribuzione dei dati futuri previsti dal modello prima di avere osservato il campione <span class="math inline">\(y\)</span>. Se risulta che i dati <span class="math inline">\(y\)</span> non sono coerenti con distribuzione predittiva a priori, questa è evidenza che il modello bayesiano non è specificato correttamente. In altre parole, questo ci dice che, in base al modello bayesiano così come è stato formulato, è improbabile che si verifichino i dati che sono stati effettivamente osservati. Ovviamente, questo vuol dire che, per i dati del campione, il modello è inadeguato.</p>
<p>In seguito vedremo come la distribuzione predittiva a priori possa essere facilmente ricavata se l’inferenza bayesiana viene svolta mediante i metodi MCMC. Qui consideriamo un esempio relativo ai dati di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span> senza approfondire i dettagli computazionali. Lo scopo è solo quello di interpretare il risultato ottenuto.</p>
<p>Nel campione di <span class="citation">Albert and Hu (<a href="#ref-albert2019probability" role="doc-biblioref">2019</a>)</span> abbiamo osservato 23 successi in 30 prove. Nella discussione precedente abbiamo svolto l’aggiornamento bayesiano imponendo su <span class="math inline">\(\theta\)</span> una distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span>. Ci poniamo il problema di costruire la distribuzione predittiva a priori per questo modello.</p>
<p>Nel caso di una verosimiglianza binomiale e di una distribuzione a priori Beta, la distribuzione predittiva a priori può essere costruita mediante la funzione <code>LearnBayes::pbetap()</code>. Con i dati dell’esempio, otteniamo</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="ch-prediction.html#cb280-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb280-2"><a href="ch-prediction.html#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb280-3"><a href="ch-prediction.html#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability =</span> LearnBayes<span class="sc">::</span><span class="fu">pbetap</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>), <span class="dv">30</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb280-4"><a href="ch-prediction.html#cb280-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-5"><a href="ch-prediction.html#cb280-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb280-6"><a href="ch-prediction.html#cb280-6" aria-hidden="true" tabindex="-1"></a>  ProbBayes<span class="sc">::</span><span class="fu">prob_plot</span>(<span class="at">Color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">Size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb280-7"><a href="ch-prediction.html#cb280-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="dv">23</span>, <span class="at">Probability =</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-276-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>La distribuzione predittiva a priori assegna livelli diversi di plausibilità a ciascuno dei possibili risultati del nostro esperimento casuale, ovvero all’osservazione di <span class="math inline">\(0, 1, \dots, 30\)</span> successi in 30 prove Bernoulliane. Nella distribuzione predittiva a priori assegna ho evidenziato il punto <span class="math inline">\(y = 23\)</span>, ovvero il numero di successi che sono stati effettivamente osservati nel campione. Il grafico mostra che la distribuzione predittiva a priori assegna una plausibilità quasi nulla all’evento <span class="math inline">\(y = 23\)</span>, ovvero ai dati che sono stati effettivamente osservati. Questo indica chiaramente che la distribuzione a priori <span class="math inline">\(\mbox{Beta}(2, 10)\)</span> non è adeguata per i dati che stiamo analizzando. Se viene invece utilizzata una distribuzione a priori debolmente informativa, come <span class="math inline">\(\mbox{Beta}(2, 2)\)</span>, la distribuzione predittiva a priori diventa:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="ch-prediction.html#cb281-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb281-2"><a href="ch-prediction.html#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb281-3"><a href="ch-prediction.html#cb281-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability =</span> LearnBayes<span class="sc">::</span><span class="fu">pbetap</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dv">30</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb281-4"><a href="ch-prediction.html#cb281-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-5"><a href="ch-prediction.html#cb281-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb281-6"><a href="ch-prediction.html#cb281-6" aria-hidden="true" tabindex="-1"></a>  ProbBayes<span class="sc">::</span><span class="fu">prob_plot</span>(<span class="at">Color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">Size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb281-7"><a href="ch-prediction.html#cb281-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="dv">23</span>, <span class="at">Probability =</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="ds4psy_files/figure-html/unnamed-chunk-277-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In questo secondo caso al valore <span class="math inline">\(y\)</span> osservato nel campione viene assegnata una plausibilità piuttosto alta. Ciò significa che una <span class="math inline">\(\mbox{Beta}(2, 2)\)</span> è adeguata quale distribuzione a priori.</p>
<p>Ricordo che, nell’analisi dei dati di <span class="citation">Zetsche, Bürkner, and Renneberg (<a href="#ref-zetschefuture2019" role="doc-biblioref">2019</a>)</span>, la <span class="math inline">\(\mbox{Beta}(2, 10)\)</span> è stata utilizzata quale distribuzione a priori solo per scopi didattici, ovvero per evidenziare le proprietà dell’aggiornamento bayesiano (la differenza tra la distribuzione a priori e la distribuzione a posteriori). La discussione presente mette però chiaramente in evidenza il fatto che la <span class="math inline">\(\mbox{Beta}(2, 10)\)</span> non è una buona scelta per la distribuzione a priori: sarebbe invece più opportuno usare una <span class="math inline">\(\mbox{Beta}(2, 2)\)</span>.</p>
</div>
<div id="commenti-e-considerazioni-finali-17" class="section level2 unnumbered hasAnchor">
<h2>Commenti e considerazioni finali<a href="ch-prediction.html#commenti-e-considerazioni-finali-17" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Questo capitolo discute la predizione bayesiana e ne mostra un’applicazione nel caso dei
controlli predittivi a posteriori. A questo proposito è necessario notare un punto importante: un buona corrispondenza tra <span class="math inline">\(y\)</span> e <span class="math inline">\(y^{rep}\)</span> costituisce una condizione necessaria ma non sufficiente per la validità del modello. Infatti, i PPC non sono in grado di garantire la generalizzabilità del modello a nuovi campioni di dati. D’altra parte, invece, se i PPC mostrano un cattivo adattamento del modello ai dati previsti futuri, questo ci dice chiaramente che il modello è specificato in manera errata.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-albert2019probability" class="csl-entry">
Albert, Jim, and Jingchen Hu. 2019. <em>Probability and Bayesian Modeling</em>. Chapman; Hall/CRC.
</div>
<div id="ref-gelman2020regression" class="csl-entry">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press.
</div>
<div id="ref-zetschefuture2019" class="csl-entry">
Zetsche, Ulrike, Paul-Christian Bürkner, and Babette Renneberg. 2019. <span>“Future Expectations in Clinical Depression: <span>Biased</span> or Realistic?”</span> <em>Journal of Abnormal Psychology</em> 128 (7): 678–88.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-sintesi-distr-post.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-normal-normal-mod-stan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ccaudek/datascience/edit/master/046_bayesian_prediction.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ds4psy.pdf", "ds4psy.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
